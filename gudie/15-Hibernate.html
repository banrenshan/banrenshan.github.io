<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.36" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://banrenshan.github.io/gudie/15-Hibernate.html"><meta property="og:site_name" content="å¿ƒä¹‹æ‰€å‘ï¼Œç´ å±¥ä»¥å¾€"><meta property="og:title" content="Hibernate æŒ‡å—"><meta property="og:description" content="æ¦‚è¿° image-20240424144856481image-20240424144856481 Hibernateä½œä¸ºä¸€ç§ORMè§£å†³æ–¹æ¡ˆï¼Œä½äºåº”ç”¨ç¨‹åºæ•°æ®è®¿é—®å±‚å’Œå…³ç³»æ•°æ®åº“ä¹‹é—´ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ Java åº”ç”¨ç¨‹åºåˆ©ç”¨ Hibernate API æ¥åŠ è½½ã€å­˜å‚¨ã€æŸ¥è¯¢ç­‰å…¶åŸŸæ•°æ®ã€‚ ä½œä¸º Jakarta Persistence æä¾›å•†ï¼ŒHibernate ..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-04-24T08:19:31.000Z"><meta property="article:author" content="banrenshan"><meta property="article:tag" content="Hibernate"><meta property="article:published_time" content="2024-04-20T00:00:00.000Z"><meta property="article:modified_time" content="2024-04-24T08:19:31.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Hibernate æŒ‡å—","image":[""],"datePublished":"2024-04-20T00:00:00.000Z","dateModified":"2024-04-24T08:19:31.000Z","author":[{"@type":"Person","name":"banrenshan","url":"https://github.com/banrenshan"}]}</script><title>Hibernate æŒ‡å— | å¿ƒä¹‹æ‰€å‘ï¼Œç´ å±¥ä»¥å¾€</title><meta name="description" content="æ¦‚è¿° image-20240424144856481image-20240424144856481 Hibernateä½œä¸ºä¸€ç§ORMè§£å†³æ–¹æ¡ˆï¼Œä½äºåº”ç”¨ç¨‹åºæ•°æ®è®¿é—®å±‚å’Œå…³ç³»æ•°æ®åº“ä¹‹é—´ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ Java åº”ç”¨ç¨‹åºåˆ©ç”¨ Hibernate API æ¥åŠ è½½ã€å­˜å‚¨ã€æŸ¥è¯¢ç­‰å…¶åŸŸæ•°æ®ã€‚ ä½œä¸º Jakarta Persistence æä¾›å•†ï¼ŒHibernate ...">
    <link rel="preload" href="/assets/style-wL6mR3b5.css" as="style"><link rel="stylesheet" href="/assets/style-wL6mR3b5.css">
    <link rel="modulepreload" href="/assets/app-Brzzz3sI.js"><link rel="modulepreload" href="/assets/15-Hibernate.html-DlmkLCrJ.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-Dinhrg_m.js" as="script"><link rel="prefetch" href="/assets/go-Context.html-B9y274l-.js" as="script"><link rel="prefetch" href="/assets/goå‘½ä»¤è¡Œ.html-CBkl9V82.js" as="script"><link rel="prefetch" href="/assets/goåŸºç¡€.html-Dhe5z5iV.js" as="script"><link rel="prefetch" href="/assets/goå¹¶å‘.html-2pdsFREW.js" as="script"><link rel="prefetch" href="/assets/goæ ‡å‡†åº“-json.html-DX9g76i_.js" as="script"><link rel="prefetch" href="/assets/goæ ‡å‡†åº“-time.html-Dnr_nGkQ.js" as="script"><link rel="prefetch" href="/assets/goæ¨¡å—.html-CqUvC54G.js" as="script"><link rel="prefetch" href="/assets/goæ³›å‹.html-CtnEqPl9.js" as="script"><link rel="prefetch" href="/assets/goç¯å¢ƒ.html-Cfhqt8Nd.js" as="script"><link rel="prefetch" href="/assets/goé¢å‘å¯¹è±¡.html-YRQxSVki.js" as="script"><link rel="prefetch" href="/assets/k8s-client-go.html-DenJcaiu.js" as="script"><link rel="prefetch" href="/assets/è™šæ‹Ÿç¯å¢ƒ.html-DdNTYG6D.js" as="script"><link rel="prefetch" href="/assets/ewsé‚®ç®±.html-CyQ_yAhL.js" as="script"><link rel="prefetch" href="/assets/gradle.html-DBxnGzfo.js" as="script"><link rel="prefetch" href="/assets/spring-resource.html-DJy3Qh1h.js" as="script"><link rel="prefetch" href="/assets/spring-å®¹å™¨åŸºç¡€.html-FdaYNYBW.js" as="script"><link rel="prefetch" href="/assets/spring-å®¹å™¨é«˜çº§.html-BIJHmz3r.js" as="script"><link rel="prefetch" href="/assets/spring-ç±»å‹è½¬æ¢.html-C8v1iAs-.js" as="script"><link rel="prefetch" href="/assets/spring-è¡¨è¾¾å¼.html-hdFlsVek.js" as="script"><link rel="prefetch" href="/assets/springäº‹åŠ¡.html-pVZA4H0g.js" as="script"><link rel="prefetch" href="/assets/æ ¡éªŒæ³¨è§£.html-DbdGZYOh.js" as="script"><link rel="prefetch" href="/assets/helm.html-B4lErKcF.js" as="script"><link rel="prefetch" href="/assets/istio.html-D160nfaa.js" as="script"><link rel="prefetch" href="/assets/minikube.html-CbGNEAsJ.js" as="script"><link rel="prefetch" href="/assets/00-é‡‘èçŸ¥è¯†.html-DeFNATDO.js" as="script"><link rel="prefetch" href="/assets/01-flyway.html-DwqpjRP4.js" as="script"><link rel="prefetch" href="/assets/02-jsonassert.html-D21e1m5E.js" as="script"><link rel="prefetch" href="/assets/03-Junit5.html-BDBFUK1y.js" as="script"><link rel="prefetch" href="/assets/04-mocktio.html-BAzCT5IH.js" as="script"><link rel="prefetch" href="/assets/05-jsonpath.html-CWASClsf.js" as="script"><link rel="prefetch" href="/assets/06-spring-cloud-common.html-DTTraJW6.js" as="script"><link rel="prefetch" href="/assets/07-oracle.html-BU2mygyY.js" as="script"><link rel="prefetch" href="/assets/08-å¿«æ·é”®.html-Cfi_FVzA.js" as="script"><link rel="prefetch" href="/assets/09-ç¼–ç¨‹è§„èŒƒ.html-Cvc67TlT.js" as="script"><link rel="prefetch" href="/assets/10-å¤šçº¿ç¨‹.html-DtxX_Z-r.js" as="script"><link rel="prefetch" href="/assets/11-åˆ†å¸ƒå¼äº‹åŠ¡.html-B7kr4vAT.js" as="script"><link rel="prefetch" href="/assets/12-autosys.html-BJ0TlSgO.js" as="script"><link rel="prefetch" href="/assets/13-spring-retryå®˜æ–¹æŒ‡å—.html-Bu0gm_nJ.js" as="script"><link rel="prefetch" href="/assets/14-spring-integration.html-Pq5Vkpri.js" as="script"><link rel="prefetch" href="/assets/16-å¼€å‘ç¯å¢ƒ.html-rpGP80tq.js" as="script"><link rel="prefetch" href="/assets/17-OpenShiftè·¯ç”±.html-zD7l51Zv.js" as="script"><link rel="prefetch" href="/assets/mysqlä¼˜åŒ–.html-BWZJck4j.js" as="script"><link rel="prefetch" href="/assets/mysqlç´¢å¼•.html-Dp2oyuPO.js" as="script"><link rel="prefetch" href="/assets/mysqlè¿ç»´å’Œç›‘æ§.html--3dxmT23.js" as="script"><link rel="prefetch" href="/assets/mysqlé«˜çº§.html-CPik6PyE.js" as="script"><link rel="prefetch" href="/assets/spring-data-jpa.html-DLUiglUg.js" as="script"><link rel="prefetch" href="/assets/spring-data-redis.html-BnXYc559.js" as="script"><link rel="prefetch" href="/assets/AirFlow.html-DFSFXqUB.js" as="script"><link rel="prefetch" href="/assets/ERå›¾.html-Dtg06qDp.js" as="script"><link rel="prefetch" href="/assets/Resilience4j.html-CPSYgC-E.js" as="script"><link rel="prefetch" href="/assets/filebeat.html-V3n59LqF.js" as="script"><link rel="prefetch" href="/assets/goè¯­è¨€.html-BLFUZhuj.js" as="script"><link rel="prefetch" href="/assets/gradle-basic.html-CWzpDfp7.js" as="script"><link rel="prefetch" href="/assets/gradle-depedency.html-PzrtMNnp.js" as="script"><link rel="prefetch" href="/assets/gradle-java.html-Bsxp6hjN.js" as="script"><link rel="prefetch" href="/assets/grafana-1.html-Bdul0kun.js" as="script"><link rel="prefetch" href="/assets/grafana.html-DWECnLLE.js" as="script"><link rel="prefetch" href="/assets/javaæ¥å£.html-BIT41e-e.js" as="script"><link rel="prefetch" href="/assets/javaæ—¥æœŸ.html-brlDnyrc.js" as="script"><link rel="prefetch" href="/assets/javaæ³¨è§£.html-C7Np5uh_.js" as="script"><link rel="prefetch" href="/assets/loki.html-BQEgNYfj.js" as="script"><link rel="prefetch" href="/assets/nginx.html-CBBV20Lv.js" as="script"><link rel="prefetch" href="/assets/remoteConnection.html-C7p4sv1o.js" as="script"><link rel="prefetch" href="/assets/zero-copy.html-CsS6PNZb.js" as="script"><link rel="prefetch" href="/assets/å¤šçº¿ç¨‹-Exchanger.html-KEWkLWwQ.js" as="script"><link rel="prefetch" href="/assets/Vscode.html-D95lJEzK.js" as="script"><link rel="prefetch" href="/assets/ä»£ç†.html-CftJCGF3.js" as="script"><link rel="prefetch" href="/assets/404.html-DJvsvHv3.js" as="script"><link rel="prefetch" href="/assets/index.html-dlFkNtQh.js" as="script"><link rel="prefetch" href="/assets/index.html-esL2x_tP.js" as="script"><link rel="prefetch" href="/assets/index.html-gP4rIQ5C.js" as="script"><link rel="prefetch" href="/assets/index.html-DJz4LLY2.js" as="script"><link rel="prefetch" href="/assets/index.html-B42KFFcF.js" as="script"><link rel="prefetch" href="/assets/index.html-DyW7deL4.js" as="script"><link rel="prefetch" href="/assets/index.html-D8a-rO9S.js" as="script"><link rel="prefetch" href="/assets/index.html-6WPFi9VW.js" as="script"><link rel="prefetch" href="/assets/index.html-Dx-xy0pN.js" as="script"><link rel="prefetch" href="/assets/index.html--JcF2rfJ.js" as="script"><link rel="prefetch" href="/assets/index.html-DtT6rAfM.js" as="script"><link rel="prefetch" href="/assets/index.html-ChmW0nSO.js" as="script"><link rel="prefetch" href="/assets/index.html-loUlgZ--.js" as="script"><link rel="prefetch" href="/assets/index.html-CmukK9da.js" as="script"><link rel="prefetch" href="/assets/index.html-Db_ZHdgv.js" as="script"><link rel="prefetch" href="/assets/index.html-CTQPr8dV.js" as="script"><link rel="prefetch" href="/assets/index.html-ChmW0nSO.js" as="script"><link rel="prefetch" href="/assets/index.html-b1DhYuwz.js" as="script"><link rel="prefetch" href="/assets/index.html-DMKyMfY-.js" as="script"><link rel="prefetch" href="/assets/index.html-CCqTcQyL.js" as="script"><link rel="prefetch" href="/assets/index.html-DRrlpmMy.js" as="script"><link rel="prefetch" href="/assets/index.html--k1J9biO.js" as="script"><link rel="prefetch" href="/assets/index.html-hgggnEPA.js" as="script"><link rel="prefetch" href="/assets/index.html-J7gntB6K.js" as="script"><link rel="prefetch" href="/assets/index.html-loUlgZ--.js" as="script"><link rel="prefetch" href="/assets/index.html-D4YuB0dI.js" as="script"><link rel="prefetch" href="/assets/index.html-DlD4BYA6.js" as="script"><link rel="prefetch" href="/assets/index.html-Dx-xy0pN.js" as="script"><link rel="prefetch" href="/assets/index.html-Dyp2Glwt.js" as="script"><link rel="prefetch" href="/assets/index.html-DVCFTVaZ.js" as="script"><link rel="prefetch" href="/assets/index.html-rYUCBV_X.js" as="script"><link rel="prefetch" href="/assets/index.html-DjVn7ypW.js" as="script"><link rel="prefetch" href="/assets/index.html-CyvG6Zt0.js" as="script"><link rel="prefetch" href="/assets/index.html-4330Sk5c.js" as="script"><link rel="prefetch" href="/assets/index.html-Bcs72AKU.js" as="script"><link rel="prefetch" href="/assets/index.html-Brx6N4M1.js" as="script"><link rel="prefetch" href="/assets/index.html-CMO2WPpa.js" as="script"><link rel="prefetch" href="/assets/index.html-BusLHqZV.js" as="script"><link rel="prefetch" href="/assets/index.html-DnNw564h.js" as="script"><link rel="prefetch" href="/assets/index.html-C0fYdOoe.js" as="script"><link rel="prefetch" href="/assets/index.html-BCgsA13P.js" as="script"><link rel="prefetch" href="/assets/index.html-DpaaCnf5.js" as="script"><link rel="prefetch" href="/assets/index.html-1GpCJWFC.js" as="script"><link rel="prefetch" href="/assets/index.html-C3xRuFlM.js" as="script"><link rel="prefetch" href="/assets/index.html-DiI2Oajp.js" as="script"><link rel="prefetch" href="/assets/index.html-Dp8I4P7_.js" as="script"><link rel="prefetch" href="/assets/index.html-C2DLrje6.js" as="script"><link rel="prefetch" href="/assets/index.html-yA4XFgZ7.js" as="script"><link rel="prefetch" href="/assets/index.html-BtftND-t.js" as="script"><link rel="prefetch" href="/assets/index.html-2bXD5u9n.js" as="script"><link rel="prefetch" href="/assets/index.html-CkLAHvCn.js" as="script"><link rel="prefetch" href="/assets/index.html-DI-Xsb6D.js" as="script"><link rel="prefetch" href="/assets/index.html-Bfx-5tpZ.js" as="script"><link rel="prefetch" href="/assets/index.html-9ogZgMJf.js" as="script"><link rel="prefetch" href="/assets/index.html-BhaDTUj9.js" as="script"><link rel="prefetch" href="/assets/index.html-DduD1OZ8.js" as="script"><link rel="prefetch" href="/assets/index.html-DKo99vaw.js" as="script"><link rel="prefetch" href="/assets/index.html-C05dsm4y.js" as="script"><link rel="prefetch" href="/assets/index.html-BPKJoHfy.js" as="script"><link rel="prefetch" href="/assets/index.html-lMdoztGy.js" as="script"><link rel="prefetch" href="/assets/index.html-DvMgqPI7.js" as="script"><link rel="prefetch" href="/assets/index.html-CxdHwVRk.js" as="script"><link rel="prefetch" href="/assets/index.html-D8MyKXNy.js" as="script"><link rel="prefetch" href="/assets/index.html-B1B8-RbD.js" as="script"><link rel="prefetch" href="/assets/index.html-CxMsPdKB.js" as="script"><link rel="prefetch" href="/assets/index.html-ByNRG9Hf.js" as="script"><link rel="prefetch" href="/assets/index.html-WEmpua9_.js" as="script"><link rel="prefetch" href="/assets/index.html-pOZrTPvD.js" as="script"><link rel="prefetch" href="/assets/index.html-ByKBak0a.js" as="script"><link rel="prefetch" href="/assets/index.html-5l395_fX.js" as="script"><link rel="prefetch" href="/assets/index.html-Brx6N4M1.js" as="script"><link rel="prefetch" href="/assets/index.html-CKimLbNe.js" as="script"><link rel="prefetch" href="/assets/index.html-_R6M7tB8.js" as="script"><link rel="prefetch" href="/assets/index.html-xz1O6DKj.js" as="script"><link rel="prefetch" href="/assets/index.html-C6-9qgjY.js" as="script"><link rel="prefetch" href="/assets/index.html-CvV3tPrA.js" as="script"><link rel="prefetch" href="/assets/index.html-BJW5qfyQ.js" as="script"><link rel="prefetch" href="/assets/index.html-DOEskld8.js" as="script"><link rel="prefetch" href="/assets/index.html-CjvMhBLW.js" as="script"><link rel="prefetch" href="/assets/index.html-O3ekEhBq.js" as="script"><link rel="prefetch" href="/assets/index.html-zttt1MoW.js" as="script"><link rel="prefetch" href="/assets/index.html-DHd_Qtlh.js" as="script"><link rel="prefetch" href="/assets/index.html-DVVMQD8G.js" as="script"><link rel="prefetch" href="/assets/index.html-B36P80aI.js" as="script"><link rel="prefetch" href="/assets/index.html-C7Un48U-.js" as="script"><link rel="prefetch" href="/assets/index.html-JI6OVoJ1.js" as="script"><link rel="prefetch" href="/assets/index.html-DF6TXU_s.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-SzV8tJDW.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">å¿ƒä¹‹æ‰€å‘ï¼Œç´ å±¥ä»¥å¾€</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/" aria-label="ä¸»é¡µ"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/post/" aria-label="åšæ–‡"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>åšæ–‡<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/timeline/" aria-label="äº‹ä»¶è½´"><span class="font-icon icon fa-fw fa-sm fas fa-timeline" style=""></span>äº‹ä»¶è½´<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/tag/" aria-label="æ ‡ç­¾"><span class="font-icon icon fa-fw fa-sm fas fa-tags" style=""></span>æ ‡ç­¾<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/category/" aria-label="åˆ†ç±»"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>åˆ†ç±»<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/banrenshan/banrenshan.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><a class="route-link nav-link active vp-sidebar-title" href="/gudie/" aria-label="æŒ‡å—"><!---->æŒ‡å—<!----></a><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/12-autosys.html" aria-label="AutoSys"><!---->AutoSys<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/01-flyway.html" aria-label="flywayæŒ‡å—"><!---->flywayæŒ‡å—<!----></a></li><li><a class="route-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/gudie/15-Hibernate.html" aria-label="Hibernate æŒ‡å—"><!---->Hibernate æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/02-jsonassert.html" aria-label="JSONassertæŒ‡å—"><!---->JSONassertæŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/05-jsonpath.html" aria-label="JsonPath æŒ‡å—"><!---->JsonPath æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/03-Junit5.html" aria-label="JUnit5æŒ‡å—"><!---->JUnit5æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/04-mocktio.html" aria-label="mocktioæŒ‡å—"><!---->mocktioæŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/17-OpenShift%E8%B7%AF%E7%94%B1.html" aria-label="OpenShift è·¯ç”±"><!---->OpenShift è·¯ç”±<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/07-oracle.html" aria-label="OracleåŸºç¡€ æŒ‡å—"><!---->OracleåŸºç¡€ æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/spring-data-redis.html" aria-label="redisæ”¯æŒ"><!---->redisæ”¯æŒ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/spring-data-jpa.html" aria-label="Spring Data Repositories"><!---->Spring Data Repositories<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/14-spring-integration.html" aria-label="Spring Integration æŒ‡å—"><!---->Spring Integration æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/13-spring-retry%E5%AE%98%E6%96%B9%E6%8C%87%E5%8D%97.html" aria-label="Spring Retry æŒ‡å—"><!---->Spring Retry æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/06-spring-cloud-common.html" aria-label="Spring-CLoud-Common"><!---->Spring-CLoud-Common<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/mysql%E4%BC%98%E5%8C%96.html" aria-label="sqlè¯­å¥ä¸Šçš„ä¼˜åŒ–"><!---->sqlè¯­å¥ä¸Šçš„ä¼˜åŒ–<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/11-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html" aria-label="åˆ†å¸ƒå¼äº‹åŠ¡"><!---->åˆ†å¸ƒå¼äº‹åŠ¡<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/10-%E5%A4%9A%E7%BA%BF%E7%A8%8B.html" aria-label="å¤šçº¿ç¨‹"><!---->å¤šçº¿ç¨‹<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/mysql%E9%AB%98%E7%BA%A7.html" aria-label="å®‰è£…"><!---->å®‰è£…<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/16-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html" aria-label="å¼€å‘ç¯å¢ƒ"><!---->å¼€å‘ç¯å¢ƒ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/08-%E5%BF%AB%E6%8D%B7%E9%94%AE.html" aria-label="å¿«æ·é”®"><!---->å¿«æ·é”®<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/mysql%E7%B4%A2%E5%BC%95.html" aria-label="æ¦‚è¿°"><!---->æ¦‚è¿°<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/mysql%E8%BF%90%E7%BB%B4%E5%92%8C%E7%9B%91%E6%8E%A7.html" aria-label="ç›‘æ§"><!---->ç›‘æ§<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/09-%E7%BC%96%E7%A8%8B%E8%A7%84%E8%8C%83.html" aria-label="ç¼–ç¨‹è§„èŒƒ"><!---->ç¼–ç¨‹è§„èŒƒ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/00-%E9%87%91%E8%9E%8D%E7%9F%A5%E8%AF%86.html" aria-label="é‡‘èçŸ¥è¯†"><!---->é‡‘èçŸ¥è¯†<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">æ–‡ç« </span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/AirFlow.html" aria-label="AirFlow"><!---->AirFlow<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/ER%E5%9B%BE.html" aria-label="ERå›¾"><!---->ERå›¾<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/filebeat.html" aria-label="filebeat"><!---->filebeat<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/go%E8%AF%AD%E8%A8%80.html" aria-label="goåŸºç¡€è¯­æ³•"><!---->goåŸºç¡€è¯­æ³•<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/gradle-depedency.html" aria-label="gradle ä¾èµ–è§£æ"><!---->gradle ä¾èµ–è§£æ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/gradle-basic.html" aria-label="gradle-basic"><!---->gradle-basic<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/gradle-java.html" aria-label="gradle-java"><!---->gradle-java<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/grafana-1.html" aria-label="grafana1"><!---->grafana1<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/grafana.html" aria-label="grafana2"><!---->grafana2<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/java%E6%8E%A5%E5%8F%A3.html" aria-label="Java æ¥å£"><!---->Java æ¥å£<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/java%E6%97%A5%E6%9C%9F.html" aria-label="Java æ—¥æœŸ API"><!---->Java æ—¥æœŸ API<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/java%E6%B3%A8%E8%A7%A3.html" aria-label="Java æ³¨è§£"><!---->Java æ³¨è§£<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/loki.html" aria-label="loki"><!---->loki<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/nginx.html" aria-label="nginx"><!---->nginx<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/Resilience4j.html" aria-label="Resilience4j"><!---->Resilience4j<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/zero-copy.html" aria-label="zero-copy"><!---->zero-copy<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/%E5%A4%9A%E7%BA%BF%E7%A8%8B-Exchanger.html" aria-label="å¤šçº¿ç¨‹-Exchanger"><!---->å¤šçº¿ç¨‹-Exchanger<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/remoteConnection.html" aria-label="è¿œç¨‹ç®¡ç†åè®®"><!---->è¿œç¨‹ç®¡ç†åè®®<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Go</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go-Context.html" aria-label="Go Context"><!---->Go Context<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E6%A0%87%E5%87%86%E5%BA%93-json.html" aria-label="Go Json"><!---->Go Json<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E6%A0%87%E5%87%86%E5%BA%93-time.html" aria-label="Go Time"><!---->Go Time<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E5%91%BD%E4%BB%A4%E8%A1%8C.html" aria-label="Go å‘½ä»¤è¡Œ"><!---->Go å‘½ä»¤è¡Œ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E5%9F%BA%E7%A1%80.html" aria-label="Go åŸºç¡€"><!---->Go åŸºç¡€<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E5%B9%B6%E5%8F%91.html" aria-label="Go å¹¶å‘"><!---->Go å¹¶å‘<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E6%A8%A1%E5%9D%97.html" aria-label="Go æ¨¡å—"><!---->Go æ¨¡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.html" aria-label="Go é¢å‘å¯¹è±¡"><!---->Go é¢å‘å¯¹è±¡<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E6%B3%9B%E5%9E%8B.html" aria-label="Goæ³›å‹"><!---->Goæ³›å‹<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E7%8E%AF%E5%A2%83.html" aria-label="Goç¯å¢ƒ"><!---->Goç¯å¢ƒ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/k8s-client-go.html" aria-label="Kubernate Go"><!---->Kubernate Go<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">äº‘æŠ€æœ¯</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/cloud/helm.html" aria-label="Helm æŒ‡å—"><!---->Helm æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/cloud/istio.html" aria-label="Istio æŒ‡å—"><!---->Istio æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/cloud/minikube.html" aria-label="minikube æŒ‡å—"><!---->minikube æŒ‡å—<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Python</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Python/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83.html" aria-label="è™šæ‹Ÿç¯å¢ƒ"><!---->è™šæ‹Ÿç¯å¢ƒ<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Tools</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tool/Vscode.html" aria-label="Vscode"><!---->Vscode<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tool/%E4%BB%A3%E7%90%86.html" aria-label="å„ç§ä»£ç†è®¾ç½®"><!---->å„ç§ä»£ç†è®¾ç½®<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Spring</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/ews%E9%82%AE%E7%AE%B1.html" aria-label="ews é‚®ç®±API"><!---->ews é‚®ç®±API<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/gradle.html" aria-label="GradleæŒ‡å—"><!---->GradleæŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/%E6%A0%A1%E9%AA%8C%E6%B3%A8%E8%A7%A3.html" aria-label="Spring Validation"><!---->Spring Validation<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/spring%E4%BA%8B%E5%8A%A1.html" aria-label="Spring äº‹åŠ¡"><!---->Spring äº‹åŠ¡<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/spring-%E5%AE%B9%E5%99%A8%E5%9F%BA%E7%A1%80.html" aria-label="Spring å®¹å™¨åŸºç¡€"><!---->Spring å®¹å™¨åŸºç¡€<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/spring-%E5%AE%B9%E5%99%A8%E9%AB%98%E7%BA%A7.html" aria-label="Spring å®¹å™¨é«˜çº§"><!---->Spring å®¹å™¨é«˜çº§<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/spring-%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2.html" aria-label="Spring ç±»å‹è½¬æ¢"><!---->Spring ç±»å‹è½¬æ¢<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/spring-%E8%A1%A8%E8%BE%BE%E5%BC%8F.html" aria-label="Spring è¡¨è¾¾å¼"><!---->Spring è¡¨è¾¾å¼<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/spring-resource.html" aria-label="Spring èµ„æºå¤„ç†"><!---->Spring èµ„æºå¤„ç†<!----></a></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Hibernate æŒ‡å—</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/banrenshan" target="_blank" rel="noopener noreferrer">banrenshan</a></span><span property="author" content="banrenshan"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-04-20T00:00:00.000Z"></span><span class="page-pageview-info" aria-label="è®¿é—®é‡ğŸ”¢" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span id="ArtalkPV" class="vp-pageview waline-pageview-count" data-path="/gudie/15-Hibernate.html" data-page-key="/gudie/15-Hibernate.html">...</span></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 48 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT48M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å€¼ç±»å‹">å€¼ç±»å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å®ä½“ç±»å‹">å®ä½“ç±»å‹</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#basic">@Basic</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#column">@Column</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#formula">@Formula</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ˜ å°„åŸºæœ¬ç±»å‹">æ˜ å°„åŸºæœ¬ç±»å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æšä¸¾">æšä¸¾</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#boolean">Boolean</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#byte">Byte</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#short">Short</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#integer">Integer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#long">Long</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#biginteger">BigInteger</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#double">Double</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#float">Float</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bigdecimal">BigDecimal</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#character">Character</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#string">String</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å­—ç¬¦æ•°ç»„">å­—ç¬¦æ•°ç»„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#clob-nclob">Clob / NClob</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#byte-array">Byte array</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#blob">Blob</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#duration">Duration</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#instant">Instant</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#localdatetime">LocalDateTime</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#localtime">LocalTime</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#offsetdatetime">OffsetDateTime</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#offsettime">OffsetTime</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timezone">TimeZone</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#zoneddatetime">ZonedDateTime</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#calendarã€dateã€timeã€timestamp">Calendarã€Dateã€Timeã€Timestamp</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#class">Class</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#currency">Currency</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#locale">Locale</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#uuid">UUID</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#inetaddress">InetAddress</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#json-mapping">JSON mapping</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#xml-mapping">XML mapping</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬æ•°ç»„æ˜ å°„">åŸºæœ¬æ•°ç»„æ˜ å°„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸºæœ¬é›†åˆç±»å‹">åŸºæœ¬é›†åˆç±»å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»„åˆåŸºæœ¬ç±»å‹çš„æ˜ å°„">ç»„åˆåŸºæœ¬ç±»å‹çš„æ˜ å°„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è‡ªå®šä¹‰ç±»å‹æ˜ å°„">è‡ªå®šä¹‰ç±»å‹æ˜ å°„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¤„ç†æ—¶é—´æ•°æ®">å¤„ç†æ—¶é—´æ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#timezonestorage">@TimeZoneStorage</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#attributeconverters">AttributeConverters</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#registries">Registries</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#typecontributor">TypeContributor</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¡ˆä¾‹ç ”ç©¶-bitset">æ¡ˆä¾‹ç ”ç©¶ï¼šBitSet</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sqlå¼•ç”¨æ ‡è¯†ç¬¦">SQLå¼•ç”¨æ ‡è¯†ç¬¦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç”Ÿæˆå±æ€§">ç”Ÿæˆå±æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åˆ—è½¬åŒ–æ¢å™¨-è¯»å–å’Œå†™å…¥è¡¨è¾¾å¼">åˆ—è½¬åŒ–æ¢å™¨ï¼šè¯»å–å’Œå†™å…¥è¡¨è¾¾å¼</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#æ¡ä»¶æŸ¥è¯¢çš„ç±»å‹">æ¡ä»¶æŸ¥è¯¢çš„ç±»å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#é€‰æ‹©å®ä½“">é€‰æ‹©å®ä½“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#é€‰æ‹©è¡¨è¾¾å¼">é€‰æ‹©è¡¨è¾¾å¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#é€‰æ‹©å¤šä¸ªå€¼">é€‰æ‹©å¤šä¸ªå€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#é€‰æ‹©-åŒ…è£…å™¨">é€‰æ‹© åŒ…è£…å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å…ƒç»„æ¡ä»¶æŸ¥è¯¢">å…ƒç»„æ¡ä»¶æŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#fromå­å¥">fromå­å¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#roots">roots</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#joins">joins</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#fetches">Fetches</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#path-expressions">Path expressions</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ä½¿ç”¨å‚æ•°">ä½¿ç”¨å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#using-group-by">Using group by</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pathå¯¼èˆª">pathå¯¼èˆª</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h1 id="æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#æ¦‚è¿°"><span>æ¦‚è¿°</span></a></h1><figure><img src="/assets/image-20240424144856481-0crb4rQp.png" alt="image-20240424144856481" tabindex="0" loading="lazy"><figcaption>image-20240424144856481</figcaption></figure><p>Hibernateä½œä¸ºä¸€ç§ORMè§£å†³æ–¹æ¡ˆï¼Œä½äºåº”ç”¨ç¨‹åºæ•°æ®è®¿é—®å±‚å’Œå…³ç³»æ•°æ®åº“ä¹‹é—´ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ Java åº”ç”¨ç¨‹åºåˆ©ç”¨ Hibernate API æ¥åŠ è½½ã€å­˜å‚¨ã€æŸ¥è¯¢ç­‰å…¶åŸŸæ•°æ®ã€‚</p><p>ä½œä¸º Jakarta Persistence æä¾›å•†ï¼ŒHibernate å®ç°äº† Java Persistence API è§„èŒƒï¼ŒJakarta Persistence æ¥å£ä¸ Hibernate ç‰¹å®šå®ç°ä¹‹é—´çš„å…³è”å¯ä»¥åœ¨ä¸‹å›¾ä¸­å¯è§†åŒ–ï¼š</p><figure><img src="/assets/image-20240424145000570-CmsFKTfE.png" alt="image-20240424145000570" tabindex="0" loading="lazy"><figcaption>image-20240424145000570</figcaption></figure><ul><li><p>SessionFactory (<code>org.hibernate.SessionFactory</code>)ï¼šçº¿ç¨‹å®‰å…¨ï¼Œè¡¨ç¤ºåŸŸæ¨¡å‹åˆ°DBçš„æ˜ å°„ã€‚å……å½“org.hibernate.Sessionå®ä¾‹çš„å·¥å‚ã€‚Jakarta Persistenceä¸­çš„EntityManagerFactoryæ˜¯ä¸SessionFactoryç­‰æ•ˆçš„ï¼Œè¿™ä¸¤ä¸ªå…ƒç´ ä½¿ç”¨ç›¸åŒçš„SessionFactoryå®ç°ã€‚</p><p>SessionFactoryçš„åˆ›å»ºéå¸¸æ˜‚è´µï¼Œå› æ­¤ï¼Œå¯¹äºä»»ä½•ç»™å®šçš„æ•°æ®åº“ï¼Œåº”ç”¨ç¨‹åºåº”è¯¥åªæœ‰ä¸€ä¸ªå…³è”çš„SessionFactoryã€‚SessionFactoryç»´æŠ¤Hibernateåœ¨æ‰€æœ‰ä¼šè¯ä¸­ä½¿ç”¨çš„æœåŠ¡ï¼Œå¦‚äºŒçº§ç¼“å­˜ã€è¿æ¥æ± ã€äº‹åŠ¡ç³»ç»Ÿé›†æˆç­‰ã€‚</p></li><li><p>Session (<code>org.hibernate.Session</code>)ï¼šå•çº¿ç¨‹ï¼Œ åœ¨Jakarta Persistenceæœ¯è¯­ä¸­ï¼Œä¼šè¯ç”±EntityManagerè¡¨ç¤ºã€‚åœ¨å¹•åï¼ŒHibernate SessionåŒ…è£…äº†ä¸€ä¸ªJDBC java.sql.Connectionï¼Œå¹¶å……å½“org.ibernate.Transactionå®ä¾‹çš„å·¥å‚ã€‚å®ƒç»´æŠ¤åº”ç”¨ç¨‹åºåŸŸæ¨¡å‹çš„ä¸€èˆ¬â€œå¯é‡å¤è¯»å–â€æŒä¹…æ€§ä¸Šä¸‹æ–‡ï¼ˆä¸€çº§ç¼“å­˜ï¼‰ã€‚</p></li><li><p>Transaction (<code>org.hibernate.Transaction</code>)ï¼š å•çº¿ç¨‹ï¼Œä¸Jakarta Persistence ä¸­çš„ EntityTransactionç­‰æ•ˆï¼Œä¸¤è€…éƒ½å……å½“æŠ½è±¡APIï¼Œå°†åº”ç”¨ç¨‹åºä¸æ­£åœ¨ä½¿ç”¨çš„åº•å±‚äº‹åŠ¡ç³»ç»Ÿï¼ˆJDBCæˆ–JTAï¼‰éš”ç¦»å¼€æ¥ã€‚</p></li></ul><h1 id="åŸŸæ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#åŸŸæ¨¡å‹"><span>åŸŸæ¨¡å‹</span></a></h1><p>HibernateåŒæ—¶ç†è§£åº”ç”¨ç¨‹åºæ•°æ®çš„Javaå’ŒJDBCè¡¨ç¤ºã€‚Hibernateç±»å‹çš„åŠŸèƒ½æ˜¯ä»æ•°æ®åº“ä¸­è¯»å–/å†™å…¥æ•°æ®ã€‚åœ¨è¿™ç§ç”¨æ³•ä¸­ï¼Œç±»å‹æ˜¯org.ibernate.type.typeæ¥å£çš„å®ç°ã€‚è¯¥Hibernateç±»å‹è¿˜æè¿°äº†Javaç±»å‹çš„å„ç§è¡Œä¸ºæ–¹é¢ï¼Œä¾‹å¦‚å¦‚ä½•æ£€æŸ¥ç›¸ç­‰æ€§ã€å¦‚ä½•å…‹éš†å€¼ç­‰ã€‚</p><p>Hibernateç±»å‹æ—¢ä¸æ˜¯Javaç±»å‹ï¼Œä¹Ÿä¸æ˜¯SQLæ•°æ®ç±»å‹ã€‚å®ƒæä¾›äº†æœ‰å…³å°†Javaç±»å‹æ˜ å°„åˆ°SQLç±»å‹çš„ä¿¡æ¯ï¼Œä»¥åŠå¦‚ä½•å°†ç»™å®šçš„Javaç±»å‹æŒä¹…åŒ–å¹¶ä»å…³ç³»æ•°æ®åº“ä¸­è·å–ã€‚ ä¸ºäº†å¸®åŠ©ç†è§£ç±»å‹åˆ†ç±»ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªè¡¨å’ŒåŸŸæ¨¡å‹çš„ç®€å•æ˜ å°„ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> Contact <span class="token punctuation">(</span>
    id <span class="token keyword">integer</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    <span class="token keyword">first</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">last</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    middle <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    notes <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    starred <span class="token keyword">boolean</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    website <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Contact&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Contact</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">Name</span> name<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> notes<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">URL</span> website<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token keyword">boolean</span> starred<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Embeddable</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Name</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> firstName<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> middleName<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>

	<span class="token comment">// getters and setters omitted</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»å¹¿ä¹‰ä¸Šè®²ï¼ŒHibernateå°†ç±»å‹åˆ†ä¸ºä¸¤ç»„ï¼š</p><ul><li>å€¼ç±»å‹</li><li>å®ä½“ç±»å‹</li></ul><h2 id="å€¼ç±»å‹" tabindex="-1"><a class="header-anchor" href="#å€¼ç±»å‹"><span>å€¼ç±»å‹</span></a></h2><p>å€¼ç±»å‹æ˜¯ä¸€æ®µä¸å®šä¹‰å…¶è‡ªèº«ç”Ÿå‘½å‘¨æœŸçš„æ•°æ®ã€‚å®é™…ä¸Šï¼Œå®ƒç”±ä¸€ä¸ªå®ä½“æ‹¥æœ‰ï¼Œè¯¥å®ä½“å®šä¹‰äº†å®ƒçš„ç”Ÿå‘½å‘¨æœŸã€‚ä»å¦ä¸€ä¸ªè§’åº¦æ¥çœ‹ï¼Œå®ä½“çš„æ‰€æœ‰çŠ¶æ€éƒ½å®Œå…¨ç”±å€¼ç±»å‹ç»„æˆã€‚è¿™äº›çŠ¶æ€å­—æ®µæˆ–JavaBean å±æ€§ç§°ä¸ºæŒä¹…å±æ€§ã€‚Contactç±»çš„æŒä¹…å±æ€§æ˜¯å€¼ç±»å‹ã€‚</p><p>å€¼ç±»å‹è¿›ä¸€æ­¥åˆ†ä¸ºä¸‰ç±»ï¼š</p><ul><li>åŸºæœ¬ç±»å‹:åœ¨æ˜ å°„Contactè¡¨æ—¶ï¼Œé™¤äº†nameä¹‹å¤–çš„æ‰€æœ‰å±æ€§éƒ½å°†æ˜¯åŸºæœ¬ç±»å‹ã€‚</li><li>åµŒå…¥ç±»å‹ï¼šnameå±æ€§å±äºåµŒå…¥ç±»å‹</li><li>é›†åˆç±»å‹ï¼šè™½ç„¶åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­æ²¡æœ‰å‡ºç°ï¼Œä½†é›†åˆç±»å‹åœ¨å€¼ç±»å‹ä¸­ä¹Ÿæ˜¯ä¸€ä¸ªç‹¬ç‰¹çš„ç±»åˆ«</li></ul><h2 id="å®ä½“ç±»å‹" tabindex="-1"><a class="header-anchor" href="#å®ä½“ç±»å‹"><span>å®ä½“ç±»å‹</span></a></h2><p>å®ä½“ç”±äºå…¶å”¯ä¸€æ ‡è¯†ç¬¦çš„æ€§è´¨ï¼Œç‹¬ç«‹äºå…¶ä»–å¯¹è±¡è€Œå­˜åœ¨ã€‚å®ä½“æ˜¯ä½¿ç”¨å”¯ä¸€æ ‡è¯†ç¬¦ä¸æ•°æ®åº“è¡¨ä¸­çš„è¡Œç›¸å…³çš„åŸŸæ¨¡å‹ç±»ã€‚ç”±äºéœ€è¦å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå®ä½“ç‹¬ç«‹å­˜åœ¨å¹¶å®šä¹‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸã€‚Contactç±»æœ¬èº«å°±æ˜¯ä¸€ä¸ªå®ä½“çš„ç¤ºä¾‹ã€‚</p><h1 id="åŸºæœ¬ç±»å‹" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç±»å‹"><span>åŸºæœ¬ç±»å‹</span></a></h1><p>åŸºæœ¬ç±»å‹æ˜¯Javaç±»å‹å’Œå•ä¸ªæ•°æ®åº“åˆ—ä¹‹é—´çš„æ˜ å°„ã€‚Hibernateå¯ä»¥å°†è®¸å¤šæ ‡å‡†Javaç±»å‹ï¼ˆIntegerã€Stringç­‰ï¼‰æ˜ å°„ä¸ºåŸºæœ¬ç±»å‹ã€‚æ­¤å¤–ï¼ŒHibernateæä¾›äº†å¤šç§çµæ´»çš„æ–¹å¼æ¥æŒ‡ç¤ºJavaç±»å‹åº”è¯¥å¦‚ä½•æ˜ å°„åˆ°æ•°æ®åº“ã€‚</p><p>Jakarta Persistenceè§„èŒƒä¸¥æ ¼é™åˆ¶é‚£äº›Javaç±»å‹å¯ä»¥æ ‡è®°ä¸ºbasic,å¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:left;">Category</th><th style="text-align:left;">Package</th><th style="text-align:left;">Types</th></tr></thead><tbody><tr><td style="text-align:left;">Java primitive types</td><td style="text-align:left;"></td><td style="text-align:left;"><code>boolean</code>, <code>int</code>, <code>double</code>, etc.</td></tr><tr><td style="text-align:left;">Primitive wrappers</td><td style="text-align:left;"><code>java.lang</code></td><td style="text-align:left;"><code>Boolean</code>, <code>Integer</code>, <code>Double</code>, etc.</td></tr><tr><td style="text-align:left;">Strings</td><td style="text-align:left;"><code>java.lang</code></td><td style="text-align:left;"><code>String</code></td></tr><tr><td style="text-align:left;">Arbitrary-precision numeric types</td><td style="text-align:left;"><code>java.math</code></td><td style="text-align:left;"><code>BigInteger</code> and <code>BigDecimal</code></td></tr><tr><td style="text-align:left;">Date/time types</td><td style="text-align:left;"><code>java.time</code></td><td style="text-align:left;"><code>LocalDate</code>, <code>LocalTime</code>, <code>LocalDateTime</code>, <code>OffsetTime</code>, <code>OffsetDateTime</code>, <code>Instant</code></td></tr><tr><td style="text-align:left;">Deprecated date/time types</td><td style="text-align:left;"><code>java.util</code></td><td style="text-align:left;"><code>Date</code> and <code>Calendar</code></td></tr><tr><td style="text-align:left;">Deprecated date/time types from</td><td style="text-align:left;"><code>java.sql</code></td><td style="text-align:left;"><code>Date</code>, <code>Time</code>, <code>Timestamp</code></td></tr><tr><td style="text-align:left;">Byte and character arrays</td><td style="text-align:left;"></td><td style="text-align:left;"><code>byte[]</code> or <code>Byte[]</code>, <code>char[]</code> or <code>Character[]</code></td></tr><tr><td style="text-align:left;">Java enumerated types</td><td style="text-align:left;"></td><td style="text-align:left;">Any <code>enum</code></td></tr><tr><td style="text-align:left;">Serializable types</td><td style="text-align:left;"></td><td style="text-align:left;">Any type that implements <code>java.io.Serializable</code></td></tr></tbody></table><blockquote><p>Java Persistence 2.1å¼•å…¥äº†jakarta.Persistence.AttributeConverterï¼Œå®ƒæ”¯æŒå¤„ç†è§„èŒƒä¸­å®šä¹‰çš„ç±»å‹ä»¥å¤–çš„ç±»å‹ã€‚æœ‰å…³æ­¤ä¸»é¢˜çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…AttributeConvertersã€‚</p></blockquote><h3 id="basic" tabindex="-1"><a class="header-anchor" href="#basic"><span>@Basic</span></a></h3><p>ä¸¥æ ¼æ¥è¯´ï¼ŒåŸºæœ¬ç±»å‹ç”±jakarta.persistence.basicæ³¨é‡Šè¡¨ç¤ºã€‚é€šå¸¸ï¼Œ@Basicæ³¨é‡Šå¯ä»¥è¢«å¿½ç•¥ã€‚ä»¥ä¸‹ä¸¤ä¸ªç¤ºä¾‹æœ€ç»ˆéƒ½æ˜¯ç›¸åŒçš„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token annotation punctuation">@Basic</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Basic</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> sku<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Basic</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Basic</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> description<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> sku<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> description<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>@Basic å®šä¹‰äº†ä¸¤ä¸ªå±æ€§ï¼š</p><ul><li><code>optional</code> - boolean (é»˜è®¤true)ï¼šå®šä¹‰æ­¤å±æ€§æ˜¯å¦å…è®¸ç©ºå€¼ã€‚å¦‚æœå±æ€§æ˜¯javaçš„åŸºç¡€ç±»å‹ï¼Œåˆ™è¯¥å±æ€§è¢«å¿½ç•¥ã€‚åªè¦ç±»å‹ä¸æ˜¯åŸºç¡€ç±»å‹ï¼ŒHibernateå°±ä¼šæ¥å—è¿™ä¸ªå€¼ã€‚</li><li><code>fetch</code> - FetchType (é»˜è®¤EAGER)ï¼šEAGERè¡¨ç¤ºå°†ä½œä¸ºæ‰€æœ‰è€…çš„ä¸€éƒ¨åˆ†è·å–è¯¥å€¼ã€‚LAZYè¡¨ç¤ºä»…å½“è®¿é—®å€¼æ—¶æ‰è·å–å€¼ã€‚Jakarta Persistenceè¦æ±‚æä¾›ç¨‹åºæ”¯æŒEAGERï¼Œè€Œå¯¹LAZYçš„æ”¯æŒæ˜¯å¯é€‰çš„ã€‚åªè¦æ‚¨ä½¿ç”¨å…¶å­—èŠ‚ç å¢å¼ºæ”¯æŒï¼ŒHibernateå°±æ”¯æŒå»¶è¿ŸåŠ è½½ã€‚</li></ul><h3 id="column" tabindex="-1"><a class="header-anchor" href="#column"><span>@Column</span></a></h3><p>Jakarta Persistenceéšå¼ç¡®å®šè¡¨å’Œåˆ—åç§°çš„è§„åˆ™ã€‚å¯¹äºåŸºæœ¬ç±»å‹å±æ€§ï¼Œéšå¼å‘½åè§„åˆ™æ˜¯ï¼š<code>åˆ—åä¸å±æ€§åç›¸åŒ</code>ã€‚å¦‚æœéšå¼å‘½åè§„åˆ™ä¸ç¬¦åˆæ‚¨çš„è¦æ±‚ï¼Œæ‚¨å¯ä»¥æ˜ç¡®å‘Šè¯‰Hibernateï¼ˆå’Œå…¶ä»–æä¾›ç¨‹åºï¼‰è¦ä½¿ç”¨çš„åˆ—åã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> sku<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;NOTES&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> description<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="formula" tabindex="-1"><a class="header-anchor" href="#formula"><span>@Formula</span></a></h3><p>@Formulaå…è®¸å°†ä»»ä½•æ•°æ®åº“è®¡ç®—å€¼æ˜ å°„ä¸ºè™šæ‹Ÿåªè¯»åˆ—ã€‚</p><blockquote><p>@Formulaæ³¨é‡Šé‡‡ç”¨å¯èƒ½å½±å“æ•°æ®åº“å¯ç§»æ¤æ€§çš„ native SQLå­å¥ã€‚@Formulaæ˜¯Hibernateç‰¹æœ‰çš„æ˜ å°„æ„é€ ï¼ŒJakarta Persistenceæ²¡æœ‰æ¶‰åŠã€‚</p></blockquote><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Account&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">Double</span> credit<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">Double</span> rate<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Formula</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;credit * rate&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">Double</span> interest<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŠ è½½Accountå®ä½“æ—¶ï¼ŒHibernateå°†ä½¿ç”¨é…ç½®çš„@Formulaè®¡ç®—interestå±æ€§ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token function">doInJPA</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">::</span><span class="token function">entityManagerFactory</span><span class="token punctuation">,</span> entityManager <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
	<span class="token class-name">Account</span> account <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	account<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	account<span class="token punctuation">.</span><span class="token function">setCredit</span><span class="token punctuation">(</span><span class="token number">5000d</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	account<span class="token punctuation">.</span><span class="token function">setRate</span><span class="token punctuation">(</span><span class="token number">1.25</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	entityManager<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span>account<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">doInJPA</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">::</span><span class="token function">entityManagerFactory</span><span class="token punctuation">,</span> entityManager <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
	<span class="token class-name">Account</span> account <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">62.5d</span><span class="token punctuation">)</span><span class="token punctuation">,</span> account<span class="token punctuation">.</span><span class="token function">getInterest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token constant">INSERT</span> <span class="token constant">INTO</span> <span class="token class-name">Account</span> <span class="token punctuation">(</span>credit<span class="token punctuation">,</span> rate<span class="token punctuation">,</span> id<span class="token punctuation">)</span>
<span class="token constant">VALUES</span> <span class="token punctuation">(</span><span class="token number">5000.0</span><span class="token punctuation">,</span> <span class="token number">0.0125</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token constant">SELECT</span>
    a<span class="token punctuation">.</span>id as id1_0_0_<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span>credit as credit2_0_0_<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span>rate as rate3_0_0_<span class="token punctuation">,</span>
    a<span class="token punctuation">.</span>credit <span class="token operator">*</span> a<span class="token punctuation">.</span>rate as formula0_0_
<span class="token constant">FROM</span>
    <span class="token class-name">Account</span> a
<span class="token constant">WHERE</span>
    a<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>@Formulaæ³¨é‡Šå®šä¹‰çš„SQLç‰‡æ®µå¯ä»¥ä»»æ„å¤æ‚ï¼Œç”šè‡³å¯ä»¥åŒ…å«å­æŸ¥è¯¢ã€‚</p><h3 id="æ˜ å°„åŸºæœ¬ç±»å‹" tabindex="-1"><a class="header-anchor" href="#æ˜ å°„åŸºæœ¬ç±»å‹"><span>æ˜ å°„åŸºæœ¬ç±»å‹</span></a></h3><p>ä¸ºäº†å¤„ç†åŸºæœ¬ç±»å‹çš„å€¼ï¼ŒHibernateéœ€è¦äº†è§£ä¸€äº›æœ‰å…³æ˜ å°„çš„ä¿¡æ¯ï¼š</p><ul><li><p>Javaç±»å‹çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p><ul><li><p>å¦‚ä½•æ¯”è¾ƒå€¼</p></li><li><p>å¦‚ä½•è®¡ç®—å“ˆå¸Œç </p></li><li><p>å¦‚ä½•å°†æ­¤ç±»å‹çš„å€¼å¼ºåˆ¶ä¸ºå¦ä¸€ç±»å‹</p></li></ul></li><li><p>ä½¿ç”¨çš„JDBCç±»å‹</p><ul><li><p>å¦‚ä½•å°†å€¼ç»‘å®šåˆ°JDBCè¯­å¥</p></li><li><p>å¦‚ä½•ä»JDBCç»“æœä¸­æå–</p></li></ul></li><li><p>å®ƒåº”è¯¥å¯¹ä¸æ•°æ®åº“ä¹‹é—´çš„å€¼æ‰§è¡Œä»»ä½•è½¬æ¢</p></li><li><p>å€¼çš„å¯å˜æ€§-å†…éƒ¨çŠ¶æ€æ˜¯å¯ä»¥åƒjava.util.Dateä¸€æ ·æ”¹å˜ï¼Œè¿˜æ˜¯åƒjava.lang.Stringä¸€æ ·ä¸å¯å˜</p></li></ul><p>æœ¬èŠ‚ä»‹ç»Hibernateå¦‚ä½•ç¡®å®šè¿™äº›ç‰‡æ®µï¼Œä»¥åŠç¡®å®šçš„è¿‡ç¨‹ã€‚</p><p>æ˜ å°„ä¸»è¦ç”±å®šä¹‰çš„åŸºæœ¬javaç±»å‹ç¡®å®šï¼Œè¿™ä¸»è¦ç”±åå°„å®ç°ã€‚å›é€€æ˜¯å°†å€¼æ˜ å°„åˆ°æ¨èçš„JDBCç±»å‹ã€‚æœ€åçš„æƒ…å†µæ˜¯ï¼Œå¦‚æœJavaç±»å‹æ˜¯å¯åºåˆ—åŒ–çš„ï¼ŒHibernateå°†å°è¯•é€šè¿‡äºŒè¿›åˆ¶åºåˆ—åŒ–æ¥å¤„ç†å®ƒã€‚</p><p>å¯¹äºJavaç±»å‹ä¸æ˜¯æ ‡å‡†ç±»å‹çš„æƒ…å†µï¼Œæˆ–è€…å¦‚æœéœ€è¦ä¸€äº›ä¸“é—¨çš„å¤„ç†ï¼ŒHibernateæä¾›äº†ä¸¤ç§ä¸»è¦æ–¹æ³•æ¥å½±å“æ˜ å°„è§£æï¼š</p><ul><li>å¤šä¸ªæ³¨è§£ç»„åˆå¤„ç†</li><li>ç”¨æˆ·è‡ªå®šä¹‰</li></ul><p>è¿™ä¸¤ç§æ–¹æ³•åº”è§†ä¸ºäº’æ–¥ã€‚è‡ªå®šä¹‰UserTypeå§‹ç»ˆä¼˜å…ˆäºç»„åˆæ³¨é‡Šã€‚</p><h3 id="æšä¸¾" tabindex="-1"><a class="header-anchor" href="#æšä¸¾"><span>æšä¸¾</span></a></h3><p>Hibernateä»¥å¤šç§ä¸åŒçš„æ–¹å¼æ”¯æŒå°†Javaæšä¸¾æ˜ å°„ä¸ºåŸºæœ¬å€¼ç±»å‹ã€‚</p><h4 id="enumerated" tabindex="-1"><a class="header-anchor" href="#enumerated"><span><code>@Enumerated</code></span></a></h4><p>æœ€åˆï¼Œä¸Jakarta Persistenceå…¼å®¹çš„æ˜ å°„æšä¸¾çš„æ–¹æ³•æ˜¯é€šè¿‡@Enumeratedæˆ–@MapKeyEnumeredæ³¨é‡Šï¼Œå…¶åŸç†æ˜¯æ ¹æ®Jakarta.Persistence.EnumTypeæŒ‡ç¤ºçš„ä¸¤ç§ç­–ç•¥ä¹‹ä¸€å­˜å‚¨æšä¸¾å€¼ï¼š</p><ul><li>ORDINALï¼šæ ¹æ®æšä¸¾å€¼åœ¨æšä¸¾ç±»ä¸­çš„åºå·ä½ç½®å­˜å‚¨ï¼Œå¦‚java.lang.enum#ordinal</li><li>STRINGï¼šæ ¹æ®æšä¸¾å€¼çš„åç§°å­˜å‚¨ï¼Œå¦‚java.lang.enum#nameæ‰€ç¤º</li></ul><p>ä¾‹å¦‚ä¸‹é¢çš„æšä¸¾ç±»å‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">PhoneType</span> <span class="token punctuation">{</span>
    <span class="token constant">LAND_LINE</span><span class="token punctuation">,</span>
    <span class="token constant">MOBILE</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ORDINALç¤ºä¾‹ä¸­ï¼Œphone_typeåˆ—è¢«å®šä¹‰ä¸ºï¼ˆå¯ä¸ºç©ºï¼‰INTEGERç±»å‹ï¼Œå…¶å€¼ä¸ºï¼š</p><ul><li>NULLï¼š ç©ºå€¼</li><li>0ï¼š LAND_LINEå€¼</li><li>1ï¼š MOBILEå€¼</li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Phone&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Phone</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;phone_number&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> number<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Enumerated</span><span class="token punctuation">(</span><span class="token class-name">EnumType</span><span class="token punctuation">.</span><span class="token constant">ORDINAL</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;phone_type&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">PhoneType</span> type<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">Phone</span> phone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
phone<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
phone<span class="token punctuation">.</span><span class="token function">setNumber</span><span class="token punctuation">(</span><span class="token string">&quot;123-456-78990&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
phone<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">PhoneType</span><span class="token punctuation">.</span><span class="token constant">MOBILE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
entityManager<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Phone <span class="token punctuation">(</span>phone_number<span class="token punctuation">,</span> phone_type<span class="token punctuation">,</span> id<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;123-456-78990&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨STRINGç¤ºä¾‹ä¸­ï¼Œphone_typeåˆ—è¢«å®šä¹‰ä¸ºï¼ˆå¯ä¸ºç©ºï¼‰VARCHARç±»å‹ï¼Œå…¶å€¼å¯èƒ½ä¸ºï¼š</p><ul><li>NULL</li><li>LAND_LINE</li><li>MOBILE</li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Phone&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Phone</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;phone_number&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> number<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Enumerated</span><span class="token punctuation">(</span><span class="token class-name">EnumType</span><span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;phone_type&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">PhoneType</span> type<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Phone <span class="token punctuation">(</span>phone_number<span class="token punctuation">,</span> phone_type<span class="token punctuation">,</span> id<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;123-456-78990&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;MOBILE&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨å±æ€§è½¬åŒ–å™¨" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨å±æ€§è½¬åŒ–å™¨"><span>ä½¿ç”¨å±æ€§è½¬åŒ–å™¨</span></a></h4><p>è®©æˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹ä½¿ç”¨â€œMâ€å’Œâ€œFâ€ä»£ç å­˜å‚¨å…¶å€¼çš„Genderæšä¸¾ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Gender</span> <span class="token punctuation">{</span>

    <span class="token function">MALE</span><span class="token punctuation">(</span><span class="token char">&#39;M&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">FEMALE</span><span class="token punctuation">(</span><span class="token char">&#39;F&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">char</span> code<span class="token punctuation">;</span>

    <span class="token class-name">Gender</span><span class="token punctuation">(</span><span class="token keyword">char</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Gender</span> <span class="token function">fromCode</span><span class="token punctuation">(</span><span class="token keyword">char</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">==</span> <span class="token char">&#39;M&#39;</span> <span class="token operator">||</span> code <span class="token operator">==</span> <span class="token char">&#39;m&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token constant">MALE</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">==</span> <span class="token char">&#39;F&#39;</span> <span class="token operator">||</span> code <span class="token operator">==</span> <span class="token char">&#39;f&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token constant">FEMALE</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span>
            <span class="token string">&quot;The code &quot;</span> <span class="token operator">+</span> code <span class="token operator">+</span> <span class="token string">&quot; is not supported!&quot;</span>
       <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">char</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> code<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨å¯ä»¥ä½¿ç”¨Jakarta Persistence AttributeConverterä»¥ç¬¦åˆJakarta Persistenceçš„æ–¹å¼æ˜ å°„æšä¸¾ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Person&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name">GenderConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">Gender</span> gender<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Converter</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">GenderConverter</span>
		<span class="token keyword">implements</span> <span class="token class-name">AttributeConverter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Gender</span><span class="token punctuation">,</span> <span class="token class-name">Character</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token class-name">Character</span> <span class="token function">convertToDatabaseColumn</span><span class="token punctuation">(</span><span class="token class-name">Gender</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token class-name">Gender</span> <span class="token function">convertToEntityAttribute</span><span class="token punctuation">(</span><span class="token class-name">Character</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> <span class="token class-name">Gender</span><span class="token punctuation">.</span><span class="token function">fromCode</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è‡ªå®šä¹‰ç±»å‹" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰ç±»å‹"><span>è‡ªå®šä¹‰ç±»å‹</span></a></h4><p>è¿˜å¯ä»¥ä½¿ç”¨Hibernateè‡ªå®šä¹‰ç±»å‹æ˜ å°„æ¥æ˜ å°„enumã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Person&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Type</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>userguide<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span>basic<span class="token punctuation">.</span></span>GenderType</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">Gender</span> gender<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GenderType</span> <span class="token keyword">extends</span> <span class="token class-name">UserTypeSupport</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Gender</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">GenderType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token class-name">Gender</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Types</span><span class="token punctuation">.</span><span class="token constant">CHAR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GenderJavaType</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractClassJavaType</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Gender</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">GenderJavaType</span> <span class="token constant">INSTANCE</span> <span class="token operator">=</span>
        <span class="token keyword">new</span> <span class="token class-name">GenderJavaType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token class-name">GenderJavaType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token class-name">Gender</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">Gender</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> value <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> value<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Gender</span> <span class="token function">fromString</span><span class="token punctuation">(</span><span class="token class-name">CharSequence</span> string<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> string <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token class-name">Gender</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">X</span> <span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token class-name">Gender</span> value<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">,</span> <span class="token class-name">WrapperOptions</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CharacterJavaType</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span>
            value <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> value<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            type<span class="token punctuation">,</span>
            options
       <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Gender</span> <span class="token function">wrap</span><span class="token punctuation">(</span><span class="token class-name">X</span> value<span class="token punctuation">,</span> <span class="token class-name">WrapperOptions</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Gender</span><span class="token punctuation">.</span><span class="token function">fromCode</span><span class="token punctuation">(</span>
				<span class="token class-name">CharacterJavaType</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span> value<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
       <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="boolean" tabindex="-1"><a class="header-anchor" href="#boolean"><span>Boolean</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒBooleanå±æ€§æ˜ å°„åˆ°Booleanåˆ—ï¼Œè‡³å°‘åœ¨æ•°æ®åº“å…·æœ‰ä¸“ç”¨Booleanç±»å‹æ—¶æ˜¯å¦‚æ­¤ã€‚åœ¨æ²¡æœ‰çš„æ•°æ®åº“ä¸Šï¼ŒHibernateä½¿ç”¨ä»»ä½•å…¶ä»–å¯ç”¨çš„ï¼šBITã€TINYINTæˆ–SMALLINTã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// this will be mapped to BIT or BOOLEAN on the database</span>
<span class="token annotation punctuation">@Basic</span>
<span class="token keyword">boolean</span> implicit<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶è€Œï¼Œæ‰¾åˆ°ç¼–ç ä¸ºå­—ç¬¦æˆ–æ•´æ•°çš„å¸ƒå°”å€¼æ˜¯å¾ˆå¸¸è§çš„ã€‚è¿™ç§æƒ…å†µæ­£æ˜¯AttributeConverterçš„æ„å›¾ã€‚ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼ŒHibernateä¸ºå¸¸è§çš„å¸ƒå°”æ˜ å°„æƒ…å†µæä¾›äº†3ä¸ªå†…ç½®è½¬æ¢å™¨ï¼š</p><ul><li>YesNoConverterå°†å¸ƒå°”å€¼ç¼–ç ä¸ºâ€œYâ€æˆ–â€œNâ€ï¼Œ</li><li>TrueFalseConverterå°†å¸ƒå°”å€¼ç¼–ç ä¸ºâ€œTâ€æˆ–â€œFâ€ï¼Œ</li><li>NumericBooleanConverterå°†å€¼ç¼–ç ä¸ºæ•´æ•°ï¼Œ1è¡¨ç¤ºçœŸï¼Œ0è¡¨ç¤ºå‡ã€‚</li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// this will get mapped to CHAR or NCHAR with a conversion</span>
<span class="token annotation punctuation">@Basic</span>
<span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>type<span class="token punctuation">.</span></span>YesNoConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">boolean</span> convertedYesNo<span class="token punctuation">;</span>

<span class="token comment">// this will get mapped to CHAR or NCHAR with a conversion</span>
<span class="token annotation punctuation">@Basic</span>
<span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>type<span class="token punctuation">.</span></span>TrueFalseConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">boolean</span> convertedTrueFalse<span class="token punctuation">;</span>

<span class="token comment">// this will get mapped to TINYINT with a conversion</span>
<span class="token annotation punctuation">@Basic</span>
<span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>type<span class="token punctuation">.</span></span>NumericBooleanConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">boolean</span> convertedNumeric<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœåœ¨æ•°æ®åº“ä¸­å°†å¸ƒå°”å€¼å®šä¹‰ä¸ºbooleanã€å­—ç¬¦æˆ–æ•´æ•°ä»¥å¤–çš„å€¼ï¼Œåˆ™ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰AttributeConverteræ˜ å°„è¯¥å€¼.</p><h3 id="byte" tabindex="-1"><a class="header-anchor" href="#byte"><span>Byte</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†Byte/byteçš„å€¼æ˜ å°„åˆ°TINYINT JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// these will both be mapped using TINYINT</span>
<span class="token class-name">Byte</span> wrapper<span class="token punctuation">;</span>
<span class="token keyword">byte</span> primitive<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="short" tabindex="-1"><a class="header-anchor" href="#short"><span>Short</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†short/Shortçš„å€¼æ˜ å°„åˆ°SMALLINT JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// these will both be mapped using SMALLINT</span>
<span class="token class-name">Short</span> wrapper<span class="token punctuation">;</span>
<span class="token keyword">short</span> primitive<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="integer" tabindex="-1"><a class="header-anchor" href="#integer"><span>Integer</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†Integer/intå€¼æ˜ å°„åˆ°Integer JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// these will both be mapped using INTEGER</span>
<span class="token class-name">Integer</span> wrapper<span class="token punctuation">;</span>
<span class="token keyword">int</span> primitive<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="long" tabindex="-1"><a class="header-anchor" href="#long"><span>Long</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†Long/Longå€¼æ˜ å°„åˆ°BIGINT JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// these will both be mapped using BIGINT</span>
<span class="token class-name">Long</span> wrapper<span class="token punctuation">;</span>
<span class="token keyword">long</span> primitive<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="biginteger" tabindex="-1"><a class="header-anchor" href="#biginteger"><span>BigInteger</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†BigIntegerçš„å€¼æ˜ å°„åˆ°NUMERIC JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// will be mapped using NUMERIC</span>
<span class="token class-name">BigInteger</span> wrapper<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="double" tabindex="-1"><a class="header-anchor" href="#double"><span>Double</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†Doubleçš„å€¼æ˜ å°„åˆ°Doubleã€FLOATã€REALæˆ–NUMERIC JDBCç±»å‹ï¼Œå…·ä½“å–å†³äºæ•°æ®åº“çš„åŠŸèƒ½</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// these will be mapped using DOUBLE, FLOAT, REAL or NUMERIC</span>
<span class="token comment">// depending on the capabilities of the database</span>
<span class="token class-name">Double</span> wrapper<span class="token punctuation">;</span>
<span class="token keyword">double</span> primitive<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥ä½¿ç”¨[åŸºæœ¬æ˜ å°„æ˜¾å¼]éƒ¨åˆ†ä¸­ä»‹ç»çš„ä»»ä½•JDBCç±»å‹å½±å“å› ç´ æ¥å½±å“ç‰¹å®šç±»å‹ã€‚ å¦‚æœä½¿ç”¨@JdbcTypeCodeï¼Œåˆ™ä»ä¼šæŸ¥è¯¢æ–¹è¨€ä»¥ç¡®ä¿æ•°æ®åº“æ”¯æŒè¯·æ±‚çš„ç±»å‹ã€‚å¦‚æœæ²¡æœ‰ï¼Œåˆ™é€‰æ‹©é€‚å½“çš„ç±»å‹</p><h3 id="float" tabindex="-1"><a class="header-anchor" href="#float"><span>Float</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateæ ¹æ®æ•°æ®åº“çš„åŠŸèƒ½å°†Floatçš„å€¼æ˜ å°„åˆ°Floatã€REALæˆ–NUMERIC JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// these will be mapped using FLOAT, REAL or NUMERIC</span>
<span class="token comment">// depending on the capabilities of the database</span>
<span class="token class-name">Float</span> wrapper<span class="token punctuation">;</span>
<span class="token keyword">float</span> primitive<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥ä½¿ç”¨[åŸºæœ¬æ˜ å°„æ˜¾å¼]éƒ¨åˆ†ä¸­ä»‹ç»çš„ä»»ä½•JDBCç±»å‹å½±å“å› ç´ æ¥å½±å“ç‰¹å®šç±»å‹ã€‚ å¦‚æœä½¿ç”¨@JdbcTypeCodeï¼Œåˆ™ä»ä¼šæŸ¥è¯¢æ–¹è¨€ä»¥ç¡®ä¿æ•°æ®åº“æ”¯æŒè¯·æ±‚çš„ç±»å‹ã€‚å¦‚æœæ²¡æœ‰ï¼Œåˆ™é€‰æ‹©é€‚å½“çš„ç±»å‹</p><h3 id="bigdecimal" tabindex="-1"><a class="header-anchor" href="#bigdecimal"><span>BigDecimal</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†BigDecimalçš„å€¼æ˜ å°„åˆ°NUMERIC JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// will be mapped using NUMERIC</span>
<span class="token class-name">BigDecimal</span> wrapper<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="character" tabindex="-1"><a class="header-anchor" href="#character"><span>Character</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†Characteræ˜ å°„åˆ°CHAR JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// these will be mapped using CHAR</span>
<span class="token class-name">Character</span> wrapper<span class="token punctuation">;</span>
<span class="token keyword">char</span> primitive<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="string" tabindex="-1"><a class="header-anchor" href="#string"><span>String</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†Stringæ˜ å°„åˆ°VARCHAR JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// will be mapped using VARCHAR</span>
<span class="token class-name">String</span> string<span class="token punctuation">;</span>

<span class="token comment">// will be mapped using CLOB</span>
<span class="token annotation punctuation">@Lob</span>
<span class="token class-name">String</span> clobString<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…ï¼Œå¯ä»¥ä½¿ç”¨@Column(length=â€¦), æˆ–è€…ä½¿ç”¨Hibernate Validatorçš„@Sizeæ³¨é‡Šã€‚å¯¹äºéå¸¸å¤§çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨org.hibernate.Lengthç±»å®šä¹‰çš„å¸¸é‡å€¼ä¹‹ä¸€ï¼Œä¾‹å¦‚ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>length<span class="token operator">=</span><span class="token class-name">Length</span><span class="token punctuation">.</span><span class="token constant">LONG</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> text<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…ï¼Œæ‚¨å¯ä»¥æ˜¾å¼æŒ‡å®šJDBCç±»å‹LONGVARCHARï¼Œå½“æœªæ˜¾å¼æŒ‡å®šé•¿åº¦æ—¶ï¼Œå®ƒè¢«è§†ä¸ºé»˜è®¤é•¿åº¦ä¸ºlength.LONGçš„VARCHARæ˜ å°„ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@JdbcTypeCode</span><span class="token punctuation">(</span><span class="token class-name">Types</span><span class="token punctuation">.</span><span class="token constant">LONGVARCHAR</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> text<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½¿ç”¨Hibernateç”Ÿæˆæ¨¡å¼ï¼ŒHibernateå°†ç”Ÿæˆå…·æœ‰è¶³å¤Ÿå¤§çš„åˆ—ç±»å‹çš„DDLï¼Œä»¥å®¹çº³æŒ‡å®šçš„æœ€å¤§é•¿åº¦ã€‚</p><blockquote><p>å¦‚æœæŒ‡å®šçš„æœ€å¤§é•¿åº¦å¤ªé•¿ï¼Œæ— æ³•å®¹çº³æ•°æ®åº“æ”¯æŒçš„æœ€å¤§VARCHARåˆ—ï¼ŒHibernateçš„æ¨¡å¼å¯¼å‡ºå™¨å°†è‡ªåŠ¨å°†åˆ—ç±»å‹å‡çº§ä¸ºTEXTã€CLOBæˆ–æ•°æ®åº“çš„ç­‰æ•ˆç±»å‹ã€‚è¯·ä¸è¦å› ä¸ºéœ€è¦TEXTåˆ—å°±ä½¿ç”¨JPAçš„@Lobæ³¨é‡Šã€‚@Lobæ³¨é‡Šçš„ç›®çš„ä¸æ˜¯æ§åˆ¶DDLç”Ÿæˆï¼</p></blockquote><p>å¯¹äºæ”¯æŒå›½é™…åŒ–å­—ç¬¦é›†çš„æ•°æ®åº“ï¼Œè¿˜å¯ä»¥å°†å­—ç¬¦ä¸²å­˜å‚¨ä¸ºå›½é™…åŒ–æ•°æ®ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// will be mapped using NVARCHAR</span>
<span class="token annotation punctuation">@Nationalized</span>
<span class="token class-name">String</span> nstring<span class="token punctuation">;</span>

<span class="token comment">// will be mapped using NCLOB</span>
<span class="token annotation punctuation">@Lob</span>
<span class="token annotation punctuation">@Nationalized</span>
<span class="token class-name">String</span> nclobString<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å­—ç¬¦æ•°ç»„" tabindex="-1"><a class="header-anchor" href="#å­—ç¬¦æ•°ç»„"><span>å­—ç¬¦æ•°ç»„</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†Character[]å’Œchar[]æ˜ å°„åˆ°VARCHAR JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as VARCHAR</span>
<span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> primitive<span class="token punctuation">;</span>
<span class="token class-name">Character</span><span class="token punctuation">[</span><span class="token punctuation">]</span> wrapper<span class="token punctuation">;</span>

<span class="token comment">// mapped as CLOB</span>
<span class="token annotation punctuation">@Lob</span>
<span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> primitiveClob<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Lob</span>
<span class="token class-name">Character</span><span class="token punctuation">[</span><span class="token punctuation">]</span> wrapperClob<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºæ”¯æŒå›½æœ‰åŒ–å­—ç¬¦é›†çš„æ•°æ®åº“ï¼Œè¿˜å¯ä»¥å°†å­—ç¬¦æ•°ç»„å­˜å‚¨ä¸ºå›½æœ‰åŒ–æ•°æ®ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as NVARCHAR</span>
<span class="token annotation punctuation">@Nationalized</span>
<span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> primitiveNVarchar<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Nationalized</span>
<span class="token class-name">Character</span><span class="token punctuation">[</span><span class="token punctuation">]</span> wrapperNVarchar<span class="token punctuation">;</span>

<span class="token comment">// mapped as NCLOB</span>
<span class="token annotation punctuation">@Lob</span>
<span class="token annotation punctuation">@Nationalized</span>
<span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> primitiveNClob<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Lob</span>
<span class="token annotation punctuation">@Nationalized</span>
<span class="token class-name">Character</span><span class="token punctuation">[</span><span class="token punctuation">]</span> wrapperNClob<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="clob-nclob" tabindex="-1"><a class="header-anchor" href="#clob-nclob"><span>Clob / NClob</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†java.sql.Clobç±»å‹æ˜ å°„åˆ°Clobï¼Œjava.sql.NClobæ˜ å°„åˆ°NClobã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Product <span class="token punctuation">(</span>
  id <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  warranty CLOB<span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®©æˆ‘ä»¬é¦–å…ˆä½¿ç”¨@Lob Jakarta Persistenceæ³¨é‡Šå’Œjava.sql.Clobç±»å‹æ¥æ˜ å°„å®ƒï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Lob</span>
    <span class="token keyword">private</span> <span class="token class-name">Clob</span> warranty<span class="token punctuation">;</span>

    <span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦æŒä¹…åŒ–è¿™æ ·çš„å®ä½“ï¼Œå¿…é¡»ä½¿ç”¨Hibernateå®ç”¨ç¨‹åº ClobProxy åˆ›å»ºClobï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">String</span> warranty <span class="token operator">=</span> <span class="token string">&quot;My product warranty&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">final</span> <span class="token class-name">Product</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
product<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
product<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Mobile phone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

product<span class="token punctuation">.</span><span class="token function">setWarranty</span><span class="token punctuation">(</span><span class="token class-name">ClobProxy</span><span class="token punctuation">.</span><span class="token function">generateProxy</span><span class="token punctuation">(</span>warranty<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

entityManager<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦æ£€ç´¢Clobå†…å®¹ï¼Œéœ€è¦è½¬æ¢åº•å±‚java.io.Readerï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">Product</span> product <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">Product</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> productId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Reader</span> reader <span class="token operator">=</span> product<span class="token punctuation">.</span><span class="token function">getWarranty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCharacterStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token string">&quot;My product warranty&quot;</span><span class="token punctuation">,</span> <span class="token function">toString</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬è¿˜å¯ä»¥ä»¥ç‰©åŒ–å½¢å¼æ˜ å°„CLOBã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Stringæˆ–char[]ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Lob</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> warranty<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬ç”šè‡³å¯èƒ½å¸Œæœ›å°†ç‰©åŒ–æ•°æ®ä½œä¸ºå­—ç¬¦æ•°ç»„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Lob</span>
	<span class="token keyword">private</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> warranty<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸CLOBä¸€æ ·ï¼ŒHibernateä¹Ÿå¯ä»¥å¤„ç†NCLOB SQLæ•°æ®ç±»å‹</p><h3 id="byte-array" tabindex="-1"><a class="header-anchor" href="#byte-array"><span>Byte array</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†byte[]å’Œbyte[]ç±»å‹çš„å€¼æ˜ å°„åˆ°JDBCç±»å‹VARBINARYã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as VARBINARY</span>
<span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> primitive<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">Byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> wrapper<span class="token punctuation">;</span>

<span class="token comment">// mapped as (materialized) BLOB</span>
<span class="token annotation punctuation">@Lob</span>
<span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> primitiveLob<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Lob</span>
<span class="token keyword">private</span> <span class="token class-name">Byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> wrapperLob<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸å­—ç¬¦ä¸²ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨@Columnï¼ˆlength=â€¦) æˆ–Hibernate Validatorçš„@Sizeæ³¨é‡Šã€‚å¯¹äºéå¸¸å¤§çš„æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨org.hibernate.Lengthå®šä¹‰çš„å¸¸é‡ã€‚æˆ–è€…ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼æŒ‡å®šé•¿åº¦ï¼Œ@JdbcTypeCodeï¼ˆTypes.LONGVARBINARYï¼‰å°†è¢«è§†ä¸ºVARBINARYæ˜ å°„ï¼Œé»˜è®¤é•¿åº¦ä¸ºLength.LONGã€‚</p><p>å¦‚æœä½¿ç”¨Hibernateç”Ÿæˆæ¨¡å¼ï¼ŒHibernateå°†ç”Ÿæˆå…·æœ‰è¶³å¤Ÿå¤§çš„åˆ—ç±»å‹çš„DDLï¼Œä»¥å®¹çº³æŒ‡å®šçš„æœ€å¤§é•¿åº¦ã€‚</p><h3 id="blob" tabindex="-1"><a class="header-anchor" href="#blob"><span>Blob</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†java.sql.Blob javaç±»å‹æ˜ å°„åˆ°Blobã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Product <span class="token punctuation">(</span>
    id <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>
    image <span class="token keyword">blob</span> <span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span> id <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®©æˆ‘ä»¬é¦–å…ˆä½¿ç”¨JDBCjava.sql.Blobç±»å‹æ˜ å°„å®ƒã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Lob</span>
    <span class="token keyword">private</span> <span class="token class-name">Blob</span> image<span class="token punctuation">;</span>

    <span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦æŒä¹…åŒ–è¿™æ ·çš„å®ä½“ï¼Œå¿…é¡»ä½¿ç”¨BlobProxy Hibernateå®ç”¨ç¨‹åºåˆ›å»ºBlobï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">final</span> <span class="token class-name">Product</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
product<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
product<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Mobile phone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

product<span class="token punctuation">.</span><span class="token function">setImage</span><span class="token punctuation">(</span><span class="token class-name">BlobProxy</span><span class="token punctuation">.</span><span class="token function">generateProxy</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

entityManager<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦æ£€ç´¢Blobå†…å®¹ï¼Œéœ€è¦è½¬æ¢åº•å±‚java.io.InputStreamï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">Product</span> product <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">Product</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> productId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> product<span class="token punctuation">.</span><span class="token function">getImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBinaryStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">assertArrayEquals</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">toBytes</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬è¿˜å¯ä»¥ä»¥ç‰©åŒ–å½¢å¼ï¼ˆä¾‹å¦‚byte[]ï¼‰æ˜ å°„BLOBã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Lob</span>
    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> image<span class="token punctuation">;</span>

    <span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="duration" tabindex="-1"><a class="header-anchor" href="#duration"><span>Duration</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateä¼šå°†Durationæ˜ å°„åˆ°INTERVAL_SECOND SQLç±»å‹ï¼Œå¹¶åœ¨å¿…è¦æ—¶å›é€€åˆ°NUMERICã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">Duration</span> duration<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="instant" tabindex="-1"><a class="header-anchor" href="#instant"><span>Instant</span></a></h3><p>Instantæ˜ å°„åˆ°TIMESTAMP_UTC SQLç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as TIMESTAMP</span>
<span class="token keyword">private</span> <span class="token class-name">Instant</span> instant<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="localdate" tabindex="-1"><a class="header-anchor" href="#localdate"><span>LocalDate</span></a></h4><p>LocalDateæ˜ å°„åˆ°DATE JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as DATE</span>
<span class="token keyword">private</span> <span class="token class-name">LocalDate</span> localDate<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="localdatetime" tabindex="-1"><a class="header-anchor" href="#localdatetime"><span>LocalDateTime</span></a></h3><p>LocalDateTimeæ˜ å°„åˆ°TIMESTAMP JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as TIMESTAMP</span>
<span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> localDateTime<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="localtime" tabindex="-1"><a class="header-anchor" href="#localtime"><span>LocalTime</span></a></h3><p>LocalTimeæ˜ å°„åˆ°TIME JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as TIME</span>
<span class="token keyword">private</span> <span class="token class-name">LocalTime</span> localTime<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="offsetdatetime" tabindex="-1"><a class="header-anchor" href="#offsetdatetime"><span>OffsetDateTime</span></a></h3><p>OffsetDateTimeæ˜ å°„åˆ°TIMESTAMPæˆ–TIMESTAMP_WITH_TIMEZONE JDBCç±»å‹ï¼Œå…·ä½“å–å†³äºæ•°æ®åº“ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as TIMESTAMP or TIMESTAMP_WITH_TIMEZONE</span>
<span class="token keyword">private</span> <span class="token class-name">OffsetDateTime</span> offsetDateTime<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="offsettime" tabindex="-1"><a class="header-anchor" href="#offsettime"><span>OffsetTime</span></a></h3><p>OffsetTimeæ˜ å°„åˆ°TIMEæˆ–TIME_WITH_TIMEZONE JDBCç±»å‹ï¼Œå…·ä½“å–å†³äºæ•°æ®åº“ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as TIME or TIME_WITH_TIMEZONE</span>
<span class="token keyword">private</span> <span class="token class-name">OffsetTime</span> offsetTime<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="timezone" tabindex="-1"><a class="header-anchor" href="#timezone"><span>TimeZone</span></a></h3><p>TimeZoneæ˜ å°„åˆ°VARCHAR JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as VARCHAR</span>
<span class="token keyword">private</span> <span class="token class-name">TimeZone</span> timeZone<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="zoneddatetime" tabindex="-1"><a class="header-anchor" href="#zoneddatetime"><span>ZonedDateTime</span></a></h3><p>ZonedDateTimeæ˜ å°„åˆ°TIMESTAMPæˆ–TIMESTAMP_WITH_TIMEZONE JDBCç±»å‹ï¼Œå…·ä½“å–å†³äºæ•°æ®åº“ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as TIMESTAMP or TIMESTAMP_WITH_TIMEZONE</span>
<span class="token keyword">private</span> <span class="token class-name">ZonedDateTime</span> zonedDateTime<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="zoneoffset" tabindex="-1"><a class="header-anchor" href="#zoneoffset"><span>ZoneOffset</span></a></h4><p>ZoneOffsetæ˜ å°„åˆ°VARCHAR JDBCç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as VARCHAR</span>
<span class="token keyword">private</span> <span class="token class-name">ZoneOffset</span> zoneOffset<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="calendarã€dateã€timeã€timestamp" tabindex="-1"><a class="header-anchor" href="#calendarã€dateã€timeã€timestamp"><span>Calendarã€Dateã€Timeã€Timestamp</span></a></h3><h3 id="class" tabindex="-1"><a class="header-anchor" href="#class"><span>Class</span></a></h3><p>Hibernateå°†ç±»å¼•ç”¨æ˜ å°„åˆ°VARCHAR JDBCç±»å‹</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as VARCHAR</span>
<span class="token keyword">private</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="currency" tabindex="-1"><a class="header-anchor" href="#currency"><span>Currency</span></a></h3><p>Hibernateå°†Currencyå¼•ç”¨æ˜ å°„åˆ°VARCHAR JDBCç±»å‹</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as VARCHAR</span>
<span class="token keyword">private</span> <span class="token class-name">Currency</span> currency<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="locale" tabindex="-1"><a class="header-anchor" href="#locale"><span>Locale</span></a></h3><p>Hibernateå°†Localeå¼•ç”¨æ˜ å°„åˆ°VARCHAR JDBCç±»å‹</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as VARCHAR</span>
<span class="token keyword">private</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="uuid" tabindex="-1"><a class="header-anchor" href="#uuid"><span>UUID</span></a></h3><p>Hibernateå…è®¸ä»¥å¤šç§æ–¹å¼æ˜ å°„UUIDå€¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†ä½¿ç”¨SQLç±»å‹UUIDä»¥æœ¬æœºå½¢å¼å­˜å‚¨UUIDå€¼ï¼Œå¦‚æœæ•°æ®åº“æ²¡æœ‰æœ¬æœºUUIDç±»å‹ï¼Œåˆ™ä½¿ç”¨binary JDBCç±»å‹ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜å‚¨UUDå€¼ã€‚</p><p>é»˜è®¤å€¼ä½¿ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œå› ä¸ºå®ƒä½¿ç”¨äº†æ›´é«˜æ•ˆçš„åˆ—å­˜å‚¨ã€‚ç„¶è€Œï¼Œè®¸å¤šåº”ç”¨ç¨‹åºæ›´å–œæ¬¢åŸºäºå­—ç¬¦çš„åˆ—å­˜å‚¨çš„å¯è¯»æ€§ã€‚è¦åˆ‡æ¢é»˜è®¤æ˜ å°„ï¼Œè¯·å°†hibernate.type.preferred_uuid_jdbc_typeé…ç½®è®¾ç½®ä¸ºCHARã€‚</p><h5 id="uuid-as-binary" tabindex="-1"><a class="header-anchor" href="#uuid-as-binary"><span>UUID as binary</span></a></h5><p>å¦‚ä¸Šæ‰€è¿°ï¼ŒUUIDå±æ€§çš„é»˜è®¤æ˜ å°„ä½¿ç”¨java.util.UUID#getMostSignificantBitså’Œjava.util.UUID#getLeastSignificantBitå°†UUIDæ˜ å°„åˆ°byte[]ï¼Œå¹¶å°†å…¶å­˜å‚¨ä¸ºBINARYæ•°æ®ã€‚ä¹‹æ‰€ä»¥é€‰æ‹©ä¸ºé»˜è®¤å€¼ï¼Œåªæ˜¯å› ä¸ºä»å­˜å‚¨è§’åº¦æ¥çœ‹ï¼Œå®ƒé€šå¸¸æ›´é«˜æ•ˆã€‚</p><h5 id="uuid-as-var-char" tabindex="-1"><a class="header-anchor" href="#uuid-as-var-char"><span>UUID as (var)char</span></a></h5><p>ä½¿ç”¨java.util.UUID#toStringå’Œjava.util.UUID#fromStringå°†UUIDæ˜ å°„åˆ°å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶å­˜å‚¨ä¸ºCHARæˆ–VARCHARæ•°æ®ã€‚</p><h5 id="uuid-as-identifier" tabindex="-1"><a class="header-anchor" href="#uuid-as-identifier"><span>UUID as identifier</span></a></h5><p>Hibernateæ”¯æŒä½¿ç”¨UUIDå€¼ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œç”šè‡³å¯ä»¥ä»£è¡¨ç”¨æˆ·ç”ŸæˆUUIDå€¼ã€‚</p><h3 id="inetaddress" tabindex="-1"><a class="header-anchor" href="#inetaddress"><span>InetAddress</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateå°†InetAddressæ˜ å°„åˆ°INET SQLç±»å‹ï¼Œå¹¶åœ¨å¿…è¦æ—¶å›é€€åˆ°BINARYã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">InetAddress</span> address<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="json-mapping" tabindex="-1"><a class="header-anchor" href="#json-mapping"><span>JSON mapping</span></a></h3><p>å¦‚æœé€šè¿‡@JdbcTypeCodeï¼ˆSqlTypes.JSONï¼‰æ˜¾å¼é…ç½®ï¼ŒHibernateå°†ä»…ä½¿ç”¨JSONç±»å‹ã€‚è‡ªåŠ¨æ£€æµ‹ç”¨äºåºåˆ—åŒ–/ååºåˆ—åŒ–çš„JSONåº“ï¼Œä½†å¯ä»¥é€šè¿‡è®¾ç½®hibernate.type.JSON_format_mapperæ¥è¦†ç›–ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@JdbcTypeCode</span><span class="token punctuation">(</span> <span class="token class-name">SqlTypes</span><span class="token punctuation">.</span><span class="token constant">JSON</span> <span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> payload<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="xml-mapping" tabindex="-1"><a class="header-anchor" href="#xml-mapping"><span>XML mapping</span></a></h3><p>å¦‚æœé€šè¿‡@JdbcTypeCodeï¼ˆSqlTypes.SQLXMLï¼‰æ˜¾å¼é…ç½®ï¼ŒHibernateå°†ä»…ä½¿ç”¨XMLç±»å‹ã€‚ç”¨äºåºåˆ—åŒ–/ååºåˆ—åŒ–çš„XMLåº“æ˜¯è‡ªåŠ¨æ£€æµ‹çš„ï¼Œä½†å¯ä»¥é€šè¿‡è®¾ç½®hibernate.type.XML_format_mapperæ¥è¦†ç›–ã€‚</p><h3 id="åŸºæœ¬æ•°ç»„æ˜ å°„" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ•°ç»„æ˜ å°„"><span>åŸºæœ¬æ•°ç»„æ˜ å°„</span></a></h3><p>åŸºæœ¬æ•°ç»„ï¼Œè€Œä¸æ˜¯byte[]/Byte[]å’Œchar[]/Character[]ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜ å°„åˆ°ç±»å‹SqlTypes.ARRAYï¼Œå¦‚æœå¯èƒ½ï¼Œå®ƒæ˜ å°„åˆ°SQLæ ‡å‡†arrayç±»å‹ï¼Œè¿™æ˜¯é€šè¿‡org.ibernate.dialect.dialectçš„æ–°æ–¹æ³•getArrayTypeNameå’ŒsupportsStandardArraysç¡®å®šçš„ã€‚å¦‚æœSQLæ ‡å‡†æ•°ç»„ç±»å‹ä¸å¯ç”¨ï¼Œæ•°æ®å°†è¢«å»ºæ¨¡ä¸ºSqlTypes.JSONã€SqlTypes.XMLæˆ–SqlTypes.VARBINARYï¼Œè¿™å–å†³äºé€šè¿‡æ–°æ–¹æ³•org.ibernate.dialect.dialect.getPreferredSqlTypeCodeForArrayç¡®å®šçš„æ•°æ®åº“æ”¯æŒã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">Short</span><span class="token punctuation">[</span><span class="token punctuation">]</span> wrapper<span class="token punctuation">;</span>
<span class="token keyword">short</span><span class="token punctuation">[</span><span class="token punctuation">]</span> primitive<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åŸºæœ¬é›†åˆç±»å‹" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬é›†åˆç±»å‹"><span>åŸºæœ¬é›†åˆç±»å‹</span></a></h3><p>æœªä½¿ç”¨@ElementCollectionæ³¨é‡Šçš„åŸºæœ¬é›†åˆï¼ˆä»…ä¸ºé›†åˆçš„å­ç±»å‹ï¼‰é»˜è®¤æ˜ å°„åˆ°ç±»å‹ä»£ç SqlTypes.ARRAYï¼Œå¦‚æœå¯èƒ½ï¼Œè¯¥ç±»å‹ä»£ç æ˜ å°„åˆ°SQLæ ‡å‡†æ•°ç»„ç±»å‹ï¼Œè¿™é€šè¿‡org.ibernate.dialect.dialectçš„æ–°æ–¹æ³•getArrayTypeNameå’ŒsupportsStandardArraysç¡®å®šã€‚å¦‚æœSQLæ ‡å‡†æ•°ç»„çš„ç±»å‹ä¸å¯ç”¨ï¼Œæ•°æ®å°†è¢«å»ºæ¨¡ä¸ºSqlTypes.JSONï¼ŒSqlTypes.XMLæˆ–SqlTypes.VARBINARYï¼Œå…·ä½“å–å†³äºé€šè¿‡æ–°æ–¹æ³•org.ibernate.dialect.dialect.getPreferredSqlTypeCodeForArrayç¡®å®šçš„æ•°æ®åº“æ”¯æŒã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Short</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">;</span>
<span class="token class-name">SortedSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Short</span><span class="token punctuation">&gt;</span></span> sortedSet<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç»„åˆåŸºæœ¬ç±»å‹çš„æ˜ å°„" tabindex="-1"><a class="header-anchor" href="#ç»„åˆåŸºæœ¬ç±»å‹çš„æ˜ å°„"><span>ç»„åˆåŸºæœ¬ç±»å‹çš„æ˜ å°„</span></a></h3><h4 id="javatype" tabindex="-1"><a class="header-anchor" href="#javatype"><span>JavaType</span></a></h4><p>Hibernateéœ€è¦äº†è§£Javaç±»å‹çš„æŸäº›æ–¹é¢ï¼Œæ‰èƒ½æ­£ç¡®æœ‰æ•ˆåœ°å¤„ç†å€¼ã€‚Hibernateé€šè¿‡org.ibernate.type.descriptor.java.JavaTypeåˆåŒäº†è§£è¿™äº›åŠŸèƒ½ã€‚Hibernateä¸ºè®¸å¤šJDKç±»å‹ï¼ˆä¾‹å¦‚Integerã€Stringï¼‰æä¾›å†…ç½®æ”¯æŒï¼Œä½†ä¹Ÿæ”¯æŒåº”ç”¨ç¨‹åºæ›´æ”¹ä»»ä½•æ ‡å‡†JavaTypeæ³¨å†Œçš„å¤„ç†ä»¥åŠéæ ‡å‡†ç±»å‹çš„æ’ä»¶å¤„ç†ã€‚Hibernateä¸ºåº”ç”¨ç¨‹åºæä¾›äº†å¤šç§æ–¹å¼æ¥å½±å“è¦ä½¿ç”¨çš„JavaTypeæè¿°ç¬¦ã€‚</p><p>ä½¿ç”¨ç‰¹å®šæ˜ å°„ä¸Šçš„@JavaTypeæ³¨é‡Šå¯ä»¥åœ¨æœ¬åœ°å½±å“è§£æã€‚æ‰€æŒ‡ç¤ºçš„æè¿°ç¬¦å°†ä»…ç”¨äºè¯¥æ˜ å°„ã€‚ä¹Ÿæœ‰@JavaTypeçš„å½¢å¼ï¼Œç”¨äºå½±å“Mapçš„é”®ï¼ˆ@MapKeyJavaTypeï¼‰ã€Listæˆ–æ•°ç»„çš„ç´¢å¼•ï¼ˆ@ListIndexJavaTypeï¼‰ï¼ŒID-BAGæ˜ å°„çš„æ ‡è¯†ç¬¦ï¼ˆ@CollectionIdJavaTypeï¼‰ä»¥åŠANYæ˜ å°„çš„é‰´åˆ«å™¨ï¼ˆ@AnyDiscriminatorï¼‰å’Œé”®ï¼ˆ@AnyKeyJavaClassï¼Œ@AnyKeyJavaTypeï¼‰ã€‚</p><p>è¿˜å¯ä»¥é€šè¿‡å‘JavaTypeRegistryæ³¨å†Œé€‚å½“çš„JavaTypeæè¿°ç¬¦æ¥å…¨å±€å½±å“è§£æã€‚è¿™ç§æ–¹æ³•æ—¢å¯ä»¥â€œè¦†ç›–â€æŸäº›Javaç±»å‹çš„å¤„ç†ï¼Œä¹Ÿå¯ä»¥æ³¨å†Œæ–°ç±»å‹ã€‚æœ‰å…³JavaTypeRegistryçš„è®¨è®ºã€‚</p><h4 id="jdbctype" tabindex="-1"><a class="header-anchor" href="#jdbctype"><span>JdbcType</span></a></h4><p>Hibernateè¿˜éœ€è¦äº†è§£å®ƒåº”è¯¥ä½¿ç”¨çš„JDBCç±»å‹çš„å„ä¸ªæ–¹é¢ï¼ˆå®ƒåº”è¯¥å¦‚ä½•ç»‘å®šå€¼ï¼Œå®ƒåº”è¯¥å¦‚ä½•æå–å€¼ç­‰ï¼‰ï¼Œè¿™æ˜¯å…¶org.Hibernate.type.descriptor.JDBC.JdbcTypeå¥‘çº¦çš„ä½œç”¨ã€‚Hibernateä¸ºåº”ç”¨ç¨‹åºæä¾›äº†å¤šç§æ–¹å¼æ¥å½±å“è¦ä½¿ç”¨çš„JdbcTypeæè¿°ç¬¦ã€‚</p><p>åœ¨æœ¬åœ°ï¼Œå¯ä»¥ä½¿ç”¨@JdbcTypeæˆ–@JdbcTypeCodeæ³¨é‡Šæ¥å½±å“è§£æã€‚è¿˜æœ‰ä¸€äº›æ³¨é‡Šå¯ä»¥å½±å“ä¸Mapé”®ï¼ˆ@MapKeyJdbcTypeï¼Œ@MapKeyJdbcTypeCodeï¼‰ã€Listæˆ–æ•°ç»„çš„ç´¢å¼•ï¼ˆ@ListIndexJdbcTypeï¼Œ@ListIndexJdbcTypeCodeï¼‰ï¼ŒID-BAGæ˜ å°„çš„æ ‡è¯†ç¬¦ï¼ˆ@CollectionIdJdbcTypeï¼Œ@CollectionIdJdbcTypeï¼‰ä»¥åŠANYæ˜ å°„çš„é”®ï¼ˆ@AnyKeyJdbcTypeï¼Œ@AnyKeyjdbcTypeCodeï¼‰ç›¸å…³çš„Jdbcç±»å‹ã€‚@JdbcTypeæŒ‡å®šè¦ä½¿ç”¨çš„ç‰¹å®šJdbcç±»å‹å®ç°ï¼Œè€Œ@JdbcTypeCodeæŒ‡å®šä¸€ä¸ªâ€œä»£ç â€ï¼Œç„¶åæ ¹æ®JdbcTypeRegistryè¿›è¡Œè§£æã€‚</p><p>å¯ä»¥é€šè¿‡@JdbcTypeRegistrationå’ŒTypeContributoræ¥å®šåˆ¶JdbcTypeæ³¨å†Œè¡¨ã€‚æœ‰å…³JavaTypeRegistryçš„è®¨è®ºï¼Œè¯·å‚è§Registrysã€‚æœ‰å…³TypeContributorçš„è®¨è®ºï¼Œè¯·å‚é˜…TypeContributerã€‚</p><h4 id="mutabilityplan" tabindex="-1"><a class="header-anchor" href="#mutabilityplan"><span>MutabilityPlan</span></a></h4><p>MutabilityPlanæ˜¯Hibernateäº†è§£å¦‚ä½•æ ¹æ®åŸŸå€¼çš„å†…éƒ¨å¯å˜æ€§ä»¥åŠç›¸å…³é—®é¢˜ï¼ˆå¦‚å¤åˆ¶ï¼‰æ¥å¤„ç†åŸŸå€¼çš„æ–¹æ³•ã€‚è™½ç„¶è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªå°é—®é¢˜ï¼Œä½†å®ƒå¯èƒ½ä¼šå¯¹æ€§èƒ½äº§ç”Ÿé‡å¤§å½±å“ã€‚è¯·å‚é˜…AttributeConverterå¯å˜æ€§è®¡åˆ’ï¼Œäº†è§£å¯èƒ½å‡ºç°è¿™ç§æƒ…å†µçš„ä¸€ç§æƒ…å†µã€‚å¦ä¸€ä¸ªè®¨è®ºè¯·å‚è§æ¡ˆä¾‹ç ”ç©¶ï¼šBitSetã€‚</p><p>æ˜ å°„çš„MutabilityPlanå¯èƒ½ä¼šå—åˆ°ä»¥ä¸‹ä»»ä½•æ³¨é‡Šçš„å½±å“ï¼š</p><ul><li><code>@Mutability</code></li><li><code>@Immutable</code></li><li><code>@MapKeyMutability</code></li><li><code>@CollectionIdMutability</code></li></ul><p>HibernateæŒ‰ä¼˜å…ˆçº§é¡ºåºæ£€æŸ¥@Mutabilityå’Œ@Immutableçš„ä»¥ä¸‹ä½ç½®ï¼š</p><ul><li>æ˜ å°„çš„æœ¬åœ°</li><li>åœ¨å…³è”çš„AttributeConverterå®ç°ç±»ï¼ˆå¦‚æœæœ‰ï¼‰ä¸Š</li><li>å…³äºå€¼çš„Javaç±»å‹</li></ul><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒJavaType#getMutabilityPlanå®šä¹‰çš„å›é€€æ˜¯æ­£ç¡®çš„ç­–ç•¥ã€‚ Hibernateä½¿ç”¨MutabilityPlanï¼š</p><ul><li>æ£€æŸ¥å€¼æ˜¯å¦è¢«è®¤ä¸ºæ˜¯è„çš„</li><li>åˆ¶ä½œæ·±åº¦å‰¯æœ¬</li><li>å°†å€¼å°é€è‡³äºŒçº§ç¼“å­˜å’Œä»äºŒçº§ç¼“å­˜å°é€å€¼</li></ul><p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸å¯å˜å€¼åœ¨æ‰€æœ‰è¿™äº›æƒ…å†µä¸‹éƒ½è¡¨ç°å¾—æ›´å¥½</p><ul><li>ä¸ºäº†æ£€æŸ¥è„ï¼ŒHibernateåªéœ€è¦æ£€æŸ¥å¯¹è±¡æ ‡è¯†ï¼ˆ==ï¼‰ï¼Œè€Œä¸æ˜¯ç›¸ç­‰ï¼ˆobject#equalsï¼‰ã€‚</li><li>ç›¸åŒçš„å€¼å®ä¾‹å¯ä»¥ç”¨ä½œå…¶è‡ªèº«çš„æ·±åº¦å‰¯æœ¬ã€‚</li><li>å¯ä»¥ä»äºŒçº§ç¼“å­˜ä»¥åŠæˆ‘ä»¬æ”¾å…¥äºŒçº§ç¼“å­˜çš„å€¼ä¸­ä½¿ç”¨ç›¸åŒçš„å€¼ã€‚</li></ul><p>å¦‚æœæŸä¸ªç‰¹å®šçš„Javaç±»å‹è¢«è®¤ä¸ºæ˜¯å¯å˜çš„ï¼ˆä¾‹å¦‚Dateï¼‰ï¼Œå¯ä»¥æŒ‡å®š@Immutableæˆ–ä¸å¯å˜çš„ç‰¹å®šMutabilityPlanå®ç°ï¼Œè®©Hibernateå°†è¯¥å€¼è§†ä¸ºä¸å¯å˜ã€‚è¿™ä¹Ÿå……å½“äº†åº”ç”¨ç¨‹åºçš„å¥‘çº¦ï¼Œå³åº”ç”¨ç¨‹åºä¸ä¼šæ›´æ”¹è¿™äº›å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ã€‚æŒ‡å®šå¯å˜ç±»å‹æ˜¯ä¸å¯å˜çš„ï¼Œç„¶åæ›´æ”¹å†…éƒ¨çŠ¶æ€å°†å¯¼è‡´é—®é¢˜ï¼›å› æ­¤ï¼Œåªæœ‰åœ¨åº”ç”¨ç¨‹åºæ˜ç¡®åœ°ä¸æ”¹å˜å†…éƒ¨çŠ¶æ€æ—¶æ‰è¿™æ ·åšã€‚</p><h4 id="basicvalueconverter" tabindex="-1"><a class="header-anchor" href="#basicvalueconverter"><span>BasicValueConverter</span></a></h4><p>BasicValueConverterå¤§è‡´ç±»ä¼¼äºAttributeConverterï¼Œå› ä¸ºå®ƒæè¿°äº†åœ¨è¯»å–æˆ–å†™å…¥åŸºæœ¬å€¼æ¨¡å‹éƒ¨åˆ†çš„å€¼æ—¶å‘ç”Ÿçš„è½¬æ¢ã€‚äº‹å®ä¸Šï¼ŒHibernateåœ¨å†…éƒ¨å°†åº”ç”¨çš„AttributeConverteråŒ…è£…åœ¨BasicValueConverterä¸­ã€‚å®ƒä¹Ÿåœ¨æŸäº›æƒ…å†µä¸‹åº”ç”¨éšå¼BasicValueConverterè½¬æ¢å™¨ï¼Œä¾‹å¦‚æšä¸¾å¤„ç†ç­‰ã€‚</p><h4 id="è§£å†³åˆæˆé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#è§£å†³åˆæˆé—®é¢˜"><span>è§£å†³åˆæˆé—®é¢˜</span></a></h4><p>ä½¿ç”¨è¿™ç§ç»„åˆæ–¹æ³•ï¼ŒHibernateéœ€è¦è§£ææ˜ å°„çš„æŸäº›éƒ¨åˆ†ã€‚é€šå¸¸è¿™æ¶‰åŠåˆ°â€œå¡«ç©ºâ€ï¼Œå› ä¸ºå®ƒåªé’ˆå¯¹æ˜ å°„çš„ä¸€éƒ¨åˆ†è¿›è¡Œé…ç½®ã€‚æœ¬èŠ‚æ¦‚è¿°äº†å¦‚ä½•è§£å†³æ­¤é—®é¢˜ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯»æ‰¾è‡ªå®šä¹‰ç±»å‹ã€‚å¦‚æœæ‰¾åˆ°ï¼Œåˆ™éœ€è¦é¢„å…ˆç¡®å®šã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…è‡ªå®šä¹‰ç±»å‹æ˜ å°„</p><p>å¦‚æœåº”ç”¨äº†AttributeConverterï¼Œæˆ‘ä»¬å°†å…¶ç”¨ä½œè§£æçš„åŸºç¡€</p><ol><li><p>å¦‚æœè¿˜ä½¿ç”¨@JavaTypeï¼Œåˆ™è¯¥ç‰¹å®šJavaTypeç”¨äºè½¬æ¢å™¨çš„â€œåŸŸç±»å‹â€ã€‚å¦åˆ™ï¼Œç”±è½¬æ¢å™¨å®šä¹‰ä¸ºå…¶â€œåŸŸç±»å‹â€çš„Javaç±»å‹å°†æ ¹æ®JavaTypeRegistryè¿›è¡Œè§£æ</p></li><li><p>å¦‚æœä½¿ç”¨@JdbcTypeæˆ–@Jdbc TypeCodeï¼Œåˆ™ä¼šä½¿ç”¨æŒ‡å®šçš„Jdbcç±»å‹ï¼Œè½¬æ¢åçš„â€œå…³ç³»Javaç±»å‹â€ç”±JdbcType#getJdbcRecommendedJavaTypeMappingç¡®å®šã€‚å¦åˆ™ï¼Œå°†ä½¿ç”¨è½¬æ¢å™¨å®šä¹‰ä¸ºå…¶å…³ç³»ç±»å‹çš„Javaç±»å‹ï¼ŒJdbcTypeç”±JdbcType#getRecommendedJdbcTypeç¡®å®š</p></li><li><p>å¯åœ¨AttributeConverterå®ç°ã€åŸºæœ¬å€¼æ˜ å°„æˆ–ç”¨ä½œåŸŸç±»å‹çš„Javaç±»å‹ä¸Šä½¿ç”¨@Mutabilityæˆ–@ImmutableæŒ‡å®šMutabilityPlanã€‚å¦åˆ™ï¼Œå°†ä½¿ç”¨è½¬æ¢åŸŸç±»å‹çš„JdbcType#getJdbcRecommendedJavaTypeMappingæ¥ç¡®å®šå¯å˜æ€§è®¡åˆ’ã€‚</p></li></ol><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°è¯•è§£æç”¨äºæ˜ å°„çš„JavaTypeã€‚æˆ‘ä»¬æ£€æŸ¥æ˜¾å¼@JavaTypeï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™ä½¿ç”¨æŒ‡å®šçš„JavaTypeã€‚æ¥ä¸‹æ¥ï¼Œæ£€æŸ¥ä»»ä½•â€œéšå«â€æŒ‡ç¤ºï¼›ä¾‹å¦‚ï¼ŒListçš„ç´¢å¼•å…·æœ‰éšå¼Javaç±»å‹Integerã€‚æ¥ä¸‹æ¥ï¼Œå¦‚æœå¯èƒ½ï¼Œæˆ‘ä»¬ä½¿ç”¨åå°„ã€‚å¦‚æœæˆ‘ä»¬æ— æ³•é€šè¿‡å‰é¢çš„æ­¥éª¤ç¡®å®šè¦ä½¿ç”¨çš„JavaTypeï¼Œæˆ‘ä»¬å°è¯•è§£æè¦ä½¿ç”¨çš„æ˜¾å¼æŒ‡å®šçš„JdbcTypeï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™ä½¿ç”¨å…¶JdbcType#getJdbcRecommendedJavaTypeMappingä½œä¸ºæ˜ å°„çš„JavaTypeã€‚å¦‚æœæ­¤æ—¶æ— æ³•ç¡®å®šJavaTypeï¼Œåˆ™ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><p>ç„¶åæ£€æŸ¥å…ˆå‰è§£æçš„JavaTypeæ˜¯å¦å­˜åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µã€‚</p><ol><li>å¯¹äºæšä¸¾å€¼ï¼Œæˆ‘ä»¬æ£€æŸ¥æ˜¾å¼@Enumeratedå¹¶åˆ›å»ºæšä¸¾æ˜ å°„ã€‚è¯·æ³¨æ„ï¼Œæ­¤è§£å†³æ–¹æ¡ˆä»ç„¶ä½¿ç”¨ä»»ä½•æ˜¾å¼JdbcTypeæŒ‡ç¤ºç¬¦</li><li>å¯¹äºæ—¶é—´å€¼ï¼Œæˆ‘ä»¬æ£€æŸ¥@temporalå¹¶åˆ›å»ºä¸€ä¸ªæšä¸¾æ˜ å°„ã€‚è¯·æ³¨æ„ï¼Œæ­¤è§£å†³æ–¹æ¡ˆä»ç„¶ä½¿ç”¨ä»»ä½•æ˜¾å¼JdbcTypeæŒ‡ç¤ºç¬¦ï¼›è¿™åŒ…æ‹¬@JdbcTypeå’Œ@Jdbc TypeCodeï¼Œä»¥åŠ@TimeZoneStorageå’Œ@TimeZoneåˆ—ï¼ˆå¦‚æœé€‚ç”¨ï¼‰ã€‚</li></ol><p>æ­¤æ—¶çš„é€€è·¯æ˜¯ä½¿ç”¨å‰é¢æ­¥éª¤ä¸­ç¡®å®šçš„JavaTypeå’ŒJdbcTypeæ¥åˆ›å»ºJDBCæ˜ å°„ï¼ˆå®ƒå°è£…äº†JavaTypeå’ŒJdbcTypeï¼‰ï¼Œå¹¶å°†å…¶ä¸å·²è§£æçš„MutabilityPlanç›¸ç»“åˆ ä½¿ç”¨ç»„åˆæ–¹æ³•æ—¶ï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥å½±å“åˆ†è¾¨ç‡ï¼Œå¦‚æšä¸¾ã€å¤„ç†æ—¶é—´æ•°æ®ã€å¤„ç†LOBæ•°æ®å’Œå¤„ç†å›½æœ‰åŒ–å­—ç¬¦æ•°æ®ä¸­æ‰€è¿° æœ‰å…³@JavaTypeRegistrationå’Œ@JdbcTypeRegistratitionçš„æ›¿ä»£æ–¹æ¡ˆï¼Œè¯·å‚é˜…TypeContributorã€‚</p><h3 id="è‡ªå®šä¹‰ç±»å‹æ˜ å°„" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰ç±»å‹æ˜ å°„"><span>è‡ªå®šä¹‰ç±»å‹æ˜ å°„</span></a></h3><p>å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨@Typeæä¾›org.ibernate.usertype.UserTypeåˆçº¦çš„å®ç°ã€‚</p><p>å¯¹äºç‰¹å®šçš„æ¨¡å‹éƒ¨åˆ†ï¼Œä¹Ÿæœ‰ç›¸åº”çš„@Typeä¸“ç”¨å½¢å¼ï¼š</p><ul><li>æ˜ å°„Mapæ—¶ï¼Œ@Typeæè¿°Mapå€¼ï¼Œè€Œ@MapKeyTypeæè¿°Mapé”®</li><li>æ˜ å°„idåŒ…æ—¶ï¼Œ@Typeæè¿°å…ƒç´ ï¼Œè€Œ@CollectionIdTypeæè¿°é›†åˆid</li><li>å¯¹äºå…¶ä»–é›†åˆæ˜ å°„ï¼Œ@Typeæè¿°äº†å…ƒç´ </li><li>å¯¹äºåŒºåˆ†çš„å…³è”æ˜ å°„ï¼ˆ@Anyå’Œ@ManyToAnyï¼‰ï¼Œ@Typeæè¿°äº†åŒºåˆ†ç¬¦å€¼</li></ul><p>@Typeå…è®¸æ›´å¤æ‚çš„æ˜ å°„é—®é¢˜ï¼›ä½†æ˜¯ï¼ŒAttributeConverterå’ŒCompositionalåŸºæœ¬æ˜ å°„é€šå¸¸åº”é¦–é€‰ä¸ºæ›´ç®€å•çš„è§£å†³æ–¹æ¡ˆ</p><h3 id="å¤„ç†æ—¶é—´æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å¤„ç†æ—¶é—´æ•°æ®"><span>å¤„ç†æ—¶é—´æ•°æ®</span></a></h3><p>Hibernateæ”¯æŒä»¥å¤šç§æ–¹å¼æ˜ å°„æ—¶é—´å€¼ï¼Œå°½ç®¡è¿™äº›ç­–ç•¥æœ€ç»ˆå½’ç»“ä¸ºSQLè§„èŒƒå®šä¹‰çš„3ç§ä¸»è¦æ—¥æœŸ/æ—¶é—´ç±»å‹ï¼š</p><ul><li>DATE</li><li>TIME</li><li>TIMESTAMP</li><li>TIMESTAMP WITH TIME ZONE</li></ul><p>java.timeæ—¶é—´ç±»å‹åˆ°ç‰¹å®šSQLæ—¥æœŸ/æ—¶é—´ç±»å‹çš„æ˜ å°„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li><p>DATEï¼šjava.time.LocalDate</p></li><li><p>TIMEï¼šjava.time.LocalTime, java.time.OffsetTime</p></li><li><p>TIMESTAMPï¼šjava.time.Instant, java.time.LocalDateTime, java.time.OffsetDateTime and java.time.ZonedDateTime</p></li><li><p>TIMESTAMP WITH TIME ZONEï¼šjava.time.OffsetDateTime, java.time.ZonedDateTime</p></li></ul><p>å°½ç®¡Hibernateå»ºè®®ä½¿ç”¨java.timeåŒ…æ¥è¡¨ç¤ºæ—¶é—´å€¼ï¼Œä½†å®ƒç¡®å®æ”¯æŒä½¿ç”¨java.sql.Dateã€java.sql.timeã€java.sql_Timestampã€java.util.Dateå’Œjava.util.Calendarã€‚</p><ul><li><p>DATEï¼šjava.sql.Date</p></li><li><p>TIMEï¼šjava.sql.Time</p></li><li><p>TIMESTAMPï¼šjava.sql.Timestamp</p></li></ul><p>å°†@Temporalåº”ç”¨äºjava.sql.Dateã€java.sql.Timeã€java.sql_Timestampæˆ–ä»»ä½•java.Timeç±»å‹éƒ½è¢«è§†ä¸ºå¼‚å¸¸ã€‚</p><p>å½“ä½¿ç”¨java.util.Dateæˆ–java.util.Calendaræ—¶ï¼ŒHibernateé‡‡ç”¨TIMESTAMPã€‚è¦æ”¹å˜è¿™ç§æƒ…å†µï¼Œè¯·ä½¿ç”¨@Temporalã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// mapped as TIMESTAMP by default</span>
<span class="token class-name">Date</span> dateAsTimestamp<span class="token punctuation">;</span>

<span class="token comment">// explicitly mapped as DATE</span>
<span class="token annotation punctuation">@Temporal</span><span class="token punctuation">(</span><span class="token class-name">TemporalType</span><span class="token punctuation">.</span><span class="token constant">DATE</span><span class="token punctuation">)</span>
<span class="token class-name">Date</span> dateAsDate<span class="token punctuation">;</span>

<span class="token comment">// explicitly mapped as TIME</span>
<span class="token annotation punctuation">@Temporal</span><span class="token punctuation">(</span><span class="token class-name">TemporalType</span><span class="token punctuation">.</span><span class="token constant">TIME</span><span class="token punctuation">)</span>
<span class="token class-name">Date</span> dateAsTime<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨ç‰¹å®šçš„æ—¶åŒº" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ç‰¹å®šçš„æ—¶åŒº"><span>ä½¿ç”¨ç‰¹å®šçš„æ—¶åŒº</span></a></h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä¿å­˜java.sql.Timestampæˆ–java.sql.Timeå±æ€§æ—¶ï¼ŒHibernateå°†ä½¿ç”¨PreparedStatement.setTimestampï¼ˆint parameterIndexï¼Œjava.sql.Ttimestampï¼‰æˆ–PreparedSStatement.setTimeï¼ˆint paramarameterIndexï¼Œjava.sql.Time xï¼‰ã€‚</p><p>å½“æœªæŒ‡å®šæ—¶åŒºæ—¶ï¼ŒJDBCé©±åŠ¨ç¨‹åºå°†ä½¿ç”¨åº•å±‚JVMé»˜è®¤æ—¶åŒºï¼Œå¦‚æœåº”ç”¨ç¨‹åºåœ¨å…¨çƒèŒƒå›´å†…ä½¿ç”¨ï¼Œåˆ™è¯¥æ—¶åŒºå¯èƒ½ä¸é€‚ç”¨ã€‚å› æ­¤ï¼Œæ¯å½“ä»æ•°æ®åº“ä¿å­˜/åŠ è½½æ•°æ®æ—¶ï¼Œé€šå¸¸ä½¿ç”¨å•ä¸ªå‚è€ƒæ—¶åŒºï¼ˆä¾‹å¦‚UTCï¼‰ã€‚</p><p>å¦ä¸€ç§é€‰æ‹©æ˜¯å°†æ‰€æœ‰JVMé…ç½®ä¸ºä½¿ç”¨å‚è€ƒæ—¶åŒºï¼š</p><p>å‚æ•°æ–¹å¼ï¼š <code>java -Duser.timezone=UTC</code></p><p>ç¼–ç¨‹æ–¹å¼ï¼š<code>TimeZone.setDefault( TimeZone.getTimeZone( &quot;UTC&quot; ) );</code></p><p>ç„¶è€Œï¼Œæ­£å¦‚<a href="https://in.relation.to/2016/09/12/jdbc-time-zone-configuration-property/" target="_blank" rel="noopener noreferrer">æœ¬æ–‡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>æ‰€è§£é‡Šçš„ï¼Œè¿™å¹¶ä¸æ€»æ˜¯å¯è¡Œçš„ï¼Œå°¤å…¶æ˜¯å¯¹äºå‰ç«¯èŠ‚ç‚¹ã€‚å› æ­¤ï¼ŒHibernateæä¾›äº†Hibernate.jdbc.time_zoneé…ç½®å±æ€§ï¼Œå¯ä»¥é…ç½®è¯¥å±æ€§ï¼š</p><p>å£°æ˜æ€§åœ°ï¼Œåœ¨SessionFactoryçº§åˆ«ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code>settings<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>
    <span class="token class-name">AvailableSettings</span><span class="token punctuation">.</span><span class="token constant">JDBC_TIME_ZONE</span><span class="token punctuation">,</span>
    <span class="token class-name">TimeZone</span><span class="token punctuation">.</span><span class="token function">getTimeZone</span><span class="token punctuation">(</span> <span class="token string">&quot;UTC&quot;</span> <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŒ‰æ¯ä¸ªä¼šè¯ç¼–ç¨‹:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token function">sessionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">withOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">jdbcTimeZone</span><span class="token punctuation">(</span> <span class="token class-name">TimeZone</span><span class="token punctuation">.</span><span class="token function">getTimeZone</span><span class="token punctuation">(</span> <span class="token string">&quot;UTC&quot;</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ‰äº†è¿™ä¸ªé…ç½®å±æ€§ï¼ŒHibernateå°†è°ƒç”¨PreparedStatement.setTimestampï¼ˆint parameterIndexï¼Œjava.sql.Timestampï¼ŒCalendar calï¼‰æˆ–PreparedSStatement.setTimeï¼ˆint parametrIndexï¼Œjava.ql.Time xï¼ŒCalendar alï¼‰ï¼Œå…¶ä¸­java.util.Calendarå¼•ç”¨é€šè¿‡Hibernate.jdbc.Time_zoneå±æ€§æä¾›çš„æ—¶åŒºã€‚</p><h4 id="å¤„ç†æ—¶é—´ç±»å‹çš„æ—¶åŒº" tabindex="-1"><a class="header-anchor" href="#å¤„ç†æ—¶é—´ç±»å‹çš„æ—¶åŒº"><span>å¤„ç†æ—¶é—´ç±»å‹çš„æ—¶åŒº</span></a></h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateä¼šå°†OffsetDateTimeå’ŒZonedDateTimeè½¬æ¢å¹¶æ ‡å‡†åŒ–ä¸ºUTCæ ¼å¼çš„java.sql.Timestampã€‚å¯ä»¥é€šè¿‡é…ç½®hibernate.timezone.default_storageå±æ€§æ¥æ›´æ”¹æ­¤è¡Œä¸º</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code>settings<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>
    <span class="token class-name">AvailableSettings</span><span class="token punctuation">.</span><span class="token constant">TIMEZONE_DEFAULT_STORAGE</span><span class="token punctuation">,</span>
    <span class="token class-name">TimeZoneStorageType</span><span class="token punctuation">.</span><span class="token constant">AUTO</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä»–å¯èƒ½çš„å­˜å‚¨ç±»å‹åŒ…æ‹¬AUTOã€COLUMNã€NATIVEå’ŒNORMALIZEï¼ˆé»˜è®¤å€¼ï¼‰ã€‚ä½¿ç”¨COLUMNï¼ŒHibernateå°†æ—¶åŒºä¿¡æ¯ä¿å­˜åˆ°ä¸€ä¸ªä¸“ç”¨åˆ—ä¸­ï¼Œè€ŒNATIVEå°†éœ€è¦æ•°æ®åº“æ”¯æŒä¿ç•™æ—¶åŒºä¿¡æ¯çš„TIMESTAMP With time zoneæ•°æ®ç±»å‹ã€‚NORMALIZEä¸å­˜å‚¨æ—¶åŒºä¿¡æ¯ï¼Œåªå°†æ—¶é—´æˆ³è½¬æ¢ä¸ºUTCã€‚Hibernateé€šè¿‡æ–¹è¨€#getTimeZoneSupportäº†è§£æ•°æ®åº“/æ–¹è¨€æ”¯æŒä»€ä¹ˆï¼Œå¦‚æœNATIVEä¸ä¸æ”¯æŒæ­¤åŠŸèƒ½çš„æ•°æ®åº“ä¸€èµ·ä½¿ç”¨ï¼Œåˆ™ä¼šå› å¯åŠ¨é”™è¯¯è€Œä¸­æ­¢ã€‚å¯¹äºAUTOï¼Œå¦‚æœå¯èƒ½ï¼ŒHibernateå°è¯•ä½¿ç”¨NATIVEï¼Œå¦åˆ™è¿”å›COLUMNã€‚</p><h3 id="timezonestorage" tabindex="-1"><a class="header-anchor" href="#timezonestorage"><span><code>@TimeZoneStorage</code></span></a></h3><p>Hibernateæ”¯æŒé€šè¿‡@TimeZoneStorageå’Œ@TimeZoneColumnæ³¨é‡Šå®šä¹‰å­˜å‚¨ä»¥ç”¨äºå•ä¸ªå±æ€§çš„æ—¶åŒºä¿¡æ¯ã€‚å­˜å‚¨ç±»å‹å¯ä»¥é€šè¿‡@TimeZoneStorageæŒ‡å®šorg.hibernate.annotations.TimeZoneStorageTypeæ¥æŒ‡å®šã€‚é»˜è®¤å­˜å‚¨ç±»å‹ä¸ºAUTOï¼Œè¿™å°†ç¡®ä¿ä¿ç•™æ—¶åŒºä¿¡æ¯ã€‚@TimeZoneColumnæ³¨é‡Šå¯ä¸AUTOæˆ–COLUMNä¸€èµ·ä½¿ç”¨ï¼Œå¹¶å…è®¸å®šä¹‰æ—¶åŒºä¿¡æ¯å­˜å‚¨çš„åˆ—è¯¦ç»†ä¿¡æ¯ã€‚</p><p>ç”±äºåŒºåŸŸè§„åˆ™å¯èƒ½ä¼šæ›´æ”¹ï¼Œå› æ­¤å­˜å‚¨åŒºåŸŸåç§»é‡å¯¹äºå°†æ¥çš„æ—¶é—´æˆ³å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚å› æ­¤ï¼Œå­˜å‚¨åç§»é‡ä»…å¯¹è¿‡å»çš„æ—¶é—´æˆ³æ˜¯å®‰å…¨çš„ï¼Œæˆ‘ä»¬å»ºè®®é»˜è®¤æƒ…å†µä¸‹åšæŒNORMALIZEç­–ç•¥ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@TimeZoneStorage</span><span class="token punctuation">(</span><span class="token class-name">TimeZoneStorageType</span><span class="token punctuation">.</span><span class="token constant">COLUMN</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@TimeZoneColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;birthday_offset_offset&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;birthday_offset&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">OffsetDateTime</span> offsetDateTimeColumn<span class="token punctuation">;</span>

<span class="token annotation punctuation">@TimeZoneStorage</span><span class="token punctuation">(</span><span class="token class-name">TimeZoneStorageType</span><span class="token punctuation">.</span><span class="token constant">COLUMN</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@TimeZoneColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;birthday_zoned_offset&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;birthday_zoned&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">ZonedDateTime</span> zonedDateTimeColumn<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="attributeconverters" tabindex="-1"><a class="header-anchor" href="#attributeconverters"><span>AttributeConverters</span></a></h3><p>ä½¿ç”¨è‡ªå®šä¹‰AttributeConverterï¼Œåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜å¯ä»¥å°†ç»™å®šçš„JDBCç±»å‹æ˜ å°„åˆ°å®ä½“åŸºæœ¬ç±»å‹ã€‚ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œjava.time.Periodå°†è¢«æ˜ å°„åˆ°VARCHARæ•°æ®åº“åˆ—ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Converter</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PeriodStringConverter</span>
        <span class="token keyword">implements</span> <span class="token class-name">AttributeConverter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Period</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">convertToDatabaseColumn</span><span class="token punctuation">(</span><span class="token class-name">Period</span> attribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> attribute<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Period</span> <span class="token function">convertToEntityAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> dbData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Period</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>dbData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦ä½¿ç”¨æ­¤è‡ªå®šä¹‰è½¬æ¢å™¨ï¼Œ@Convertæ³¨é‡Šå¿…é¡»ä¿®é¥°å®ä½“å±æ€§ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Event&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Event</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@GeneratedValue</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name">PeriodStringConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>columnDefinition <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Period</span> span<span class="token punctuation">;</span>

    <span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“æŒä¹…åŒ–è¿™æ ·çš„å®ä½“æ—¶ï¼ŒHibernateå°†æ ¹æ®AttributeConverteré€»è¾‘è¿›è¡Œç±»å‹è½¬æ¢ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Event <span class="token punctuation">(</span> span<span class="token punctuation">,</span> id <span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span> <span class="token string">&#39;P1Y2M3D&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>AttributeConverterå¯ä»¥å…¨å±€åº”ç”¨äºï¼ˆ@Converterï¼ˆautoApply=trueï¼‰ï¼‰æˆ–æœ¬åœ°åº”ç”¨ã€‚</p><h4 id="attributeconverter-javaå’Œjdbcç±»å‹" tabindex="-1"><a class="header-anchor" href="#attributeconverter-javaå’Œjdbcç±»å‹"><span>AttributeConverter Javaå’ŒJDBCç±»å‹</span></a></h4><p>å¦‚æœä¸ºè½¬æ¢çš„â€œæ•°æ®åº“ç«¯â€æŒ‡å®šæœªçŸ¥çš„Javaç±»å‹ï¼ˆç¬¬äºŒä¸ªAttributeConverterç»‘å®šå‚æ•°ï¼‰ï¼ŒHibernateå°†å›é€€åˆ°Java.io.Serializableç±»å‹ã€‚ å¦‚æœHibernateä¸çŸ¥é“Javaç±»å‹ï¼Œæ‚¨å°†é‡åˆ°ä»¥ä¸‹æ¶ˆæ¯ï¼š</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>HHH000481: Encountered Java type for which we could not locate a JavaType and which does not appear to implement equals and/or hashCode. This can lead to significant performance problems when performing equality/dirty checking involving this Java type. Consider registering a custom JavaType or at least implementing equals/hashCode.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœJavaç±»å‹åœ¨JavaTypeRegistryä¸­æœ‰æ³¨å†Œï¼Œåˆ™å®ƒæ˜¯â€œå·²çŸ¥â€çš„ã€‚è™½ç„¶Hibernateç¡®å®å°†è®¸å¤šJDKç±»å‹åŠ è½½åˆ°JavaTypeRegistryä¸­ï¼Œä½†åº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ æ–°çš„JavaTypeæ¡ç›®æ¥æ‰©å±•JavaTypeRegistryï¼Œå¦‚CompositionalåŸºæœ¬æ˜ å°„å’ŒTypeContributorä¸­æ‰€è®¨è®ºçš„ã€‚</p><h4 id="ä½¿ç”¨hbmæ˜ å°„æ˜ å°„attributeconverter" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨hbmæ˜ å°„æ˜ å°„attributeconverter"><span>ä½¿ç”¨HBMæ˜ å°„æ˜ å°„AttributeConverter</span></a></h4><p>å½“ä½¿ç”¨HBMæ˜ å°„æ—¶ï¼Œæ‚¨ä»ç„¶å¯ä»¥ä½¿ç”¨Jakarta Persistence AttributeConverterï¼Œå› ä¸ºHibernateæ”¯æŒé€šè¿‡ç±»å‹å±æ€§è¿›è¡Œæ˜ å°„ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Money</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">long</span> cents<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Money</span><span class="token punctuation">(</span><span class="token keyword">long</span> cents<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cents <span class="token operator">=</span> cents<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getCents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> cents<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCents</span><span class="token punctuation">(</span><span class="token keyword">long</span> cents<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cents <span class="token operator">=</span> cents<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> owner<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Money</span> balance<span class="token punctuation">;</span>

    <span class="token comment">//Getters and setters are omitted for brevity</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±äºHibernateä¸çŸ¥é“å¦‚ä½•æŒä¹…åŒ–Moneyç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Jakarta Persistence AttributeConverterå°†Moneyç±»å‹è½¬æ¢ä¸ºLongã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹MoneyConverterå®ç”¨ç¨‹åºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MoneyConverter</span>
        <span class="token keyword">implements</span> <span class="token class-name">AttributeConverter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Money</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">convertToDatabaseColumn</span><span class="token punctuation">(</span><span class="token class-name">Money</span> attribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> attribute <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> attribute<span class="token punctuation">.</span><span class="token function">getCents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Money</span> <span class="token function">convertToEntityAttribute</span><span class="token punctuation">(</span><span class="token class-name">Long</span> dbData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> dbData <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Money</span><span class="token punctuation">(</span>dbData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦ä½¿ç”¨HBMé…ç½®æ–‡ä»¶æ˜ å°„MoneyConverterï¼Œéœ€è¦åœ¨propertyå…ƒç´ çš„typeå±æ€§ä¸­ä½¿ç”¨<code>converted::</code>å‰ç¼€ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">hibernate-mapping</span> <span class="token name">PUBLIC</span>
        <span class="token string">&quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN&quot;</span>
        <span class="token string">&quot;http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd&quot;</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hibernate-mapping</span> <span class="token attr-name">package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.hibernate.userguide.mapping.converter.hbm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>class</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Account<span class="token punctuation">&quot;</span></span> <span class="token attr-name">table</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>account<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>owner<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>balance<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>converted::org.hibernate.userguide.mapping.converter.hbm.MoneyConverter<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hibernate-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="attributeconverter-mutability-plan" tabindex="-1"><a class="header-anchor" href="#attributeconverter-mutability-plan"><span><code>AttributeConverter</code> Mutability Plan</span></a></h4><p>å¦‚æœåŸºç¡€Javaç±»å‹æ˜¯ä¸å¯å˜çš„ï¼Œåˆ™ç”±Jakarta Persistence AttributeConverterè½¬æ¢çš„åŸºæœ¬ç±»å‹æ˜¯ä¸å¯æ›´æ”¹çš„ï¼›å¦‚æœå…³è”çš„å±æ€§ç±»å‹ä¹Ÿæ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆåŸºæœ¬ç±»å‹æ˜¯å¯å˜çš„ã€‚ å› æ­¤ï¼Œå…³è”å®ä½“å±æ€§ç±»å‹çš„JavaType#getMutabilityPlanæä¾›äº†å¯å˜æ€§ã€‚ è¿™å¯ä»¥é€šè¿‡åœ¨ä»¥ä¸‹ä»»ä½•ä¸€é¡¹ä¸Šä½¿ç”¨@Immutableæˆ–@Mutabilityè¿›è¡Œè°ƒæ•´ï¼š</p><ol><li>the basic value</li><li>the <code>AttributeConverter</code> class</li><li>the basic value type</li></ol><h4 id="ä¸å¯å˜ç±»å‹" tabindex="-1"><a class="header-anchor" href="#ä¸å¯å˜ç±»å‹"><span>ä¸å¯å˜ç±»å‹</span></a></h4><p>å¦‚æœå®ä½“å±æ€§æ˜¯å­—ç¬¦ä¸²ã€åŸºæœ¬åŒ…è£…å™¨ï¼ˆä¾‹å¦‚Integerã€Longï¼‰ã€æšä¸¾ç±»å‹æˆ–ä»»ä½•å…¶ä»–ä¸å¯å˜çš„Objectç±»å‹ï¼Œåˆ™åªèƒ½é€šè¿‡å°†å®ä½“å±æ€§å€¼é‡æ–°åˆ†é…ä¸ºæ–°å€¼æ¥æ›´æ”¹å®ä½“å±æ€§å€¼ã€‚</p><p>è€ƒè™‘åˆ°æˆ‘ä»¬å…·æœ‰ä¸AttributeConverterséƒ¨åˆ†æ‰€ç¤ºç›¸åŒçš„Periodå®ä½“å±æ€§ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Event&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Event</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@GeneratedValue</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name">PeriodStringConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>columnDefinition <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Period</span> span<span class="token punctuation">;</span>

    <span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ›´æ”¹spanå±æ€§çš„å”¯ä¸€æ–¹æ³•æ˜¯å°†å…¶é‡æ–°æŒ‡å®šä¸ºå…¶ä»–å€¼ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code> <span class="token class-name">Event</span> event <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token string">&quot;from Event&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Event</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSingleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 event<span class="token punctuation">.</span><span class="token function">setSpan</span><span class="token punctuation">(</span><span class="token class-name">Period</span>
     <span class="token punctuation">.</span><span class="token function">ofYears</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">plusMonths</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">plusDays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å¯å˜ç±»å‹" tabindex="-1"><a class="header-anchor" href="#å¯å˜ç±»å‹"><span>å¯å˜ç±»å‹</span></a></h4><p>å¦ä¸€æ–¹é¢ï¼Œè€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼Œå…¶ä¸­Moneyç±»å‹æ˜¯å¯å˜çš„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Money</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token keyword">long</span> cents<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Account&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> owner<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name">MoneyConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">Money</span> balance<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MoneyConverter</span>
		<span class="token keyword">implements</span> <span class="token class-name">AttributeConverter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Money</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">convertToDatabaseColumn</span><span class="token punctuation">(</span><span class="token class-name">Money</span> attribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> attribute <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> attribute<span class="token punctuation">.</span><span class="token function">getCents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">Money</span> <span class="token function">convertToEntityAttribute</span><span class="token punctuation">(</span><span class="token class-name">Long</span> dbData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> dbData <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Money</span><span class="token punctuation">(</span>dbData<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯å˜å¯¹è±¡å…è®¸æ‚¨ä¿®æ”¹å…¶å†…éƒ¨ç»“æ„ï¼ŒHibernateçš„è„æ£€æŸ¥æœºåˆ¶ä¼šå°†æ›´æ”¹ä¼ æ’­åˆ°æ•°æ®åº“ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">Account</span> account <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
account<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCents</span><span class="token punctuation">(</span><span class="token number">150</span> <span class="token operator">*</span> <span class="token number">100L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
entityManager<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span>account<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å°½ç®¡AttributeConverterç±»å‹å¯ä»¥æ˜¯å¯å˜çš„ï¼Œä»¥ä¾¿è„æ£€æŸ¥ã€æ·±åº¦å¤åˆ¶å’ŒäºŒçº§ç¼“å­˜èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œä½†å°†å®ƒä»¬è§†ä¸ºä¸å¯å˜ï¼ˆå½“å®ƒä»¬ç¡®å®æ˜¯ä¸å¯å˜æ—¶ï¼‰æ›´æœ‰æ•ˆã€‚ å‡ºäºè¿™ä¸ªåŸå› ï¼Œå°½å¯èƒ½é€‰æ‹©ä¸å¯å˜ç±»å‹è€Œä¸æ˜¯å¯å˜ç±»å‹ã€‚</p><h4 id="ä½¿ç”¨attributeconverterå®ä½“å±æ€§ä½œä¸ºæŸ¥è¯¢å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨attributeconverterå®ä½“å±æ€§ä½œä¸ºæŸ¥è¯¢å‚æ•°"><span>ä½¿ç”¨AttributeConverterå®ä½“å±æ€§ä½œä¸ºæŸ¥è¯¢å‚æ•°</span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Photo&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>length <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>length <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name">CaptionConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">Caption</span> caption<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Caption</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> text<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token class-name">Caption</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>text <span class="token operator">=</span> text<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> text<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setText</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>text <span class="token operator">=</span> text<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token operator">==</span> o <span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span> o <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token class-name">Caption</span> caption <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Caption</span><span class="token punctuation">)</span> o<span class="token punctuation">;</span>
		<span class="token keyword">return</span> text <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> text<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span> caption<span class="token punctuation">.</span>text <span class="token punctuation">)</span> <span class="token operator">:</span> caption<span class="token punctuation">.</span>text <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> text <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> text<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">CaptionConverter</span>
		<span class="token keyword">implements</span> <span class="token class-name">AttributeConverter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Caption</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">convertToDatabaseColumn</span><span class="token punctuation">(</span><span class="token class-name">Caption</span> attribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> attribute<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">Caption</span> <span class="token function">convertToEntityAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> dbData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Caption</span><span class="token punctuation">(</span> dbData <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¼ ç»Ÿä¸Šï¼Œå½“å¼•ç”¨Captionå®ä½“å±æ€§æ—¶ï¼Œåªèƒ½ä½¿ç”¨DBæ•°æ®Captionè¡¨ç¤ºï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">Photo</span> photo <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>
				<span class="token string">&quot;select p &quot;</span> <span class="token operator">+</span>
						<span class="token string">&quot;from Photo p &quot;</span> <span class="token operator">+</span>
						<span class="token string">&quot;where upper(caption) = upper(:caption) &quot;</span><span class="token punctuation">,</span> <span class="token class-name">Photo</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">setParameter</span><span class="token punctuation">(</span> <span class="token string">&quot;caption&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Nicolae Grigorescu&quot;</span> <span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">getSingleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸ºäº†ä½¿ç”¨Javaå¯¹è±¡Captionè¡¨ç¤ºï¼Œå¿…é¡»è·å–ç›¸å…³çš„Hibernateç±»å‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">SessionFactoryImplementor</span> sessionFactory <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getEntityManagerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span> <span class="token class-name">SessionFactoryImplementor</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> <span class="token class-name">MappingMetamodelImplementor</span> mappingMetamodel <span class="token operator">=</span> sessionFactory
		<span class="token punctuation">.</span><span class="token function">getRuntimeMetamodels</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">getMappingMetamodel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Type</span> captionType <span class="token operator">=</span> mappingMetamodel
		<span class="token punctuation">.</span><span class="token function">getEntityDescriptor</span><span class="token punctuation">(</span> <span class="token class-name">Photo</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">getPropertyType</span><span class="token punctuation">(</span> <span class="token string">&quot;caption&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Photo</span> photo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Photo</span><span class="token punctuation">)</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>
				<span class="token string">&quot;select p &quot;</span> <span class="token operator">+</span>
						<span class="token string">&quot;from Photo p &quot;</span> <span class="token operator">+</span>
						<span class="token string">&quot;where upper(caption) = upper(:caption) &quot;</span><span class="token punctuation">,</span> <span class="token class-name">Photo</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">setParameter</span><span class="token punctuation">(</span>
				<span class="token string">&quot;caption&quot;</span><span class="token punctuation">,</span>
				<span class="token keyword">new</span> <span class="token class-name">Caption</span><span class="token punctuation">(</span> <span class="token string">&quot;Nicolae Grigorescu&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
				<span class="token punctuation">(</span><span class="token class-name">BindableType</span><span class="token punctuation">)</span> captionType
		<span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">getSingleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä¼ é€’å…³è”çš„Hibernateç±»å‹ï¼Œå¯ä»¥åœ¨ç»‘å®šæŸ¥è¯¢å‚æ•°å€¼æ—¶ä½¿ç”¨Captionå¯¹è±¡ã€‚</p><h3 id="registries" tabindex="-1"><a class="header-anchor" href="#registries"><span>Registries</span></a></h3><p>æˆ‘ä»¬å·²ç»å¤šæ¬¡ä»‹ç»äº†JavaTypeRegistryå’ŒJdbcTypeRegistryï¼Œä¸»è¦æ˜¯åœ¨è§£æç»„åˆä¸­è®¨è®ºçš„æ˜ å°„è§£ææ–¹é¢ã€‚ä½†å®ƒä»¬å„è‡ªä¹Ÿå‘æŒ¥ç€é¢å¤–çš„é‡è¦ä½œç”¨ã€‚ JavaTypeRegistryæ˜¯ç”±Javaç±»å‹é”®å…¥çš„JavaTypeå¼•ç”¨çš„æ³¨å†Œè¡¨ã€‚é™¤äº†æ˜ å°„è§£æä¹‹å¤–ï¼Œè¯¥æ³¨å†Œè¡¨è¿˜ç”¨äºå¤„ç†å„ç§APIï¼ˆå¦‚æŸ¥è¯¢å‚æ•°ç±»å‹ï¼‰ä¸­å…¬å¼€çš„ç±»å¼•ç”¨ã€‚JavaTypeå¼•ç”¨å¯ä»¥é€šè¿‡@JavaTypeRegistrationæ³¨å†Œã€‚</p><p>JdbcTypeRegistryæ˜¯ç”±æ•´æ•°ä»£ç é”®å…¥çš„JdbcTypeå¼•ç”¨çš„æ³¨å†Œè¡¨ã€‚æ­£å¦‚JdbcTypeä¸­æ‰€è®¨è®ºçš„ï¼Œè¿™äº›ç±»å‹ä»£ç é€šå¸¸ä¸java.sql.Typesä¸­çš„ç›¸åº”ä»£ç åŒ¹é…ï¼Œä½†è¿™ä¸æ˜¯ä¸€ä¸ªè¦æ±‚-å¯ä»¥ä½¿ç”¨java.sql.typeå®šä¹‰çš„æ•´æ•°ä»¥å¤–çš„æ•´æ•°ã€‚è¿™å¯¹äºæ˜ å°„JDBCç”¨æˆ·æ•°æ®ç±»å‹ï¼ˆUDTï¼‰æˆ–å…¶ä»–ä¸“ç”¨æ•°æ®åº“ç‰¹å®šç±»å‹ï¼ˆä¾‹å¦‚PostgreSQLçš„UUIDç±»å‹ï¼‰å¯èƒ½å¾ˆæœ‰ç”¨ã€‚é™¤äº†åœ¨æ˜ å°„è§£æä¸­ä½¿ç”¨å®ƒä¹‹å¤–ï¼Œè¯¥æ³¨å†Œè¡¨è¿˜ç”¨ä½œè§£æJDBC ResultSetä¸­â€œå‘ç°â€å€¼çš„ä¸»è¦æºã€‚JdbcTypeå¼•ç”¨å¯ä»¥é€šè¿‡@JdbcTypeRegistrationæ³¨å†Œã€‚</p><h3 id="typecontributor" tabindex="-1"><a class="header-anchor" href="#typecontributor"><span>TypeContributor</span></a></h3><p>org.ibernate.boot.model.TypeContributoræ˜¯ä¸€ä¸ªé‡å†™æˆ–æ‰©å±•hibernateç±»å‹ç³»ç»Ÿéƒ¨åˆ†çš„åˆçº¦ã€‚ æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥é›†æˆTypeContributorã€‚æœ€å¸¸è§çš„æ˜¯å°†TypeContributorå®šä¹‰ä¸ºJavaæœåŠ¡ï¼ˆè¯·å‚è§Java.util.ServiceLoaderï¼‰ã€‚</p><p>TypeContributorè¢«ä¼ é€’ä¸€ä¸ªTypeContributionså¼•ç”¨ï¼Œè¯¥å¼•ç”¨å…è®¸æ³¨å†Œè‡ªå®šä¹‰JavaTypeã€JdbcTypeå’ŒBasicTypeå¼•ç”¨ã€‚</p><p>è™½ç„¶TypeContributorä»ç„¶å…¬å¼€äº†æ³¨å†ŒBasicTypeå¼•ç”¨çš„åŠŸèƒ½ï¼Œä½†è¿™è¢«è®¤ä¸ºæ˜¯ä¸æ¨èçš„ã€‚ä»6.0å¼€å§‹ï¼Œè¿™äº›BasicTypeæ³¨å†Œä»…åœ¨è§£é‡Šhbm.xmlæ˜ å°„æ—¶ä½¿ç”¨ï¼Œè¿™äº›æ˜ å°„æœ¬èº«è¢«è®¤ä¸ºæ˜¯ä¸æ¨èçš„ã€‚è¯·æ”¹ç”¨è‡ªå®šä¹‰ç±»å‹æ˜ å°„æˆ–åˆæˆåŸºæœ¬æ˜ å°„ã€‚</p><h3 id="æ¡ˆä¾‹ç ”ç©¶-bitset" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹ç ”ç©¶-bitset"><span>æ¡ˆä¾‹ç ”ç©¶ï¼šBitSet</span></a></h3><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ä»‹ç»äº†è®¸å¤šæŒ‡å®šåŸºæœ¬å€¼æ˜ å°„çš„æ–¹æ³•ã€‚æœ¬èŠ‚å°†é€šè¿‡åº”ç”¨åˆ°ç›®å‰ä¸ºæ­¢ä»‹ç»çš„ä¸åŒæŠ€æœ¯æ¥ç ”ç©¶java.util.BitSetç±»å‹çš„æ˜ å°„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">BitSet</span> bitSet<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚å‰æ‰€è¿°ï¼ŒHibernateæ˜ å°„å®ç°Serializableçš„åŸºæœ¬ç±»å‹çš„æœ€åæƒ…å†µæ˜¯å°†å…¶åºåˆ—åŒ–åˆ°æ•°æ®åº“ã€‚BitSetç¡®å®å®ç°äº†Serializableï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹Hibernateå°†é€šè¿‡åºåˆ—åŒ–å¤„ç†æ­¤æ˜ å°„ã€‚</p><p>è¿™ä¸æ˜¯ä¸€ä¸ªç†æƒ³çš„æ˜ å°„ã€‚åœ¨ä¸‹é¢çš„éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶å¦‚ä½•æ”¹å˜BitSetå¦‚ä½•æ˜ å°„åˆ°æ•°æ®åº“çš„å„ä¸ªæ–¹é¢ã€‚</p><h5 id="using-attributeconverter" tabindex="-1"><a class="header-anchor" href="#using-attributeconverter"><span>Using <code>AttributeConverter</code></span></a></h5><p>è¿™åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½å¾ˆæœ‰æ•ˆï¼Œå¹¶ä¸”å¯ä»¥åœ¨Jakarta Persistenceæä¾›è€…ä¹‹é—´ç§»æ¤ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name">BitSetConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">BitSet</span> bitSet<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Converter</span><span class="token punctuation">(</span>autoApply <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">BitSetConverter</span> <span class="token keyword">implements</span> <span class="token class-name">AttributeConverter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BitSet</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">convertToDatabaseColumn</span><span class="token punctuation">(</span><span class="token class-name">BitSet</span> attribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token class-name">BitSetHelper</span><span class="token punctuation">.</span><span class="token function">bitSetToString</span><span class="token punctuation">(</span>attribute<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">BitSet</span> <span class="token function">convertToEntityAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> dbData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token class-name">BitSetHelper</span><span class="token punctuation">.</span><span class="token function">stringToBitSet</span><span class="token punctuation">(</span>dbData<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™å¤§å¤§æé«˜äº†å¤„ç†è¿™äº›BitSetå€¼çš„è¯»å†™æ€§èƒ½ï¼Œå› ä¸ºAttributeConverterä½¿ç”¨ç®€å•çš„å¯å¤–åŒ–å½¢å¼çš„BitSetï¼Œè€Œä¸æ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–å€¼ï¼Œå¯ä»¥æ›´æœ‰æ•ˆåœ°å®ç°è¿™ä¸€ç‚¹ã€‚</p><h4 id="ä½¿ç”¨javatypedescriptor" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨javatypedescriptor"><span>ä½¿ç”¨<code>JavaTypeDescriptor</code></span></a></h4><p>å¦‚[åŸºæœ¬æ˜ å°„æ˜¾å¼]ä¸­æ‰€è¿°ï¼Œæˆ‘ä»¬å°†ä¸ºBitSetå®šä¹‰ä¸€ä¸ªJavaTypeï¼Œé»˜è®¤æƒ…å†µä¸‹å°†å€¼æ˜ å°„åˆ°VARCHARè¿›è¡Œå­˜å‚¨ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BitSetJavaType</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractClassJavaType</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BitSet</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">BitSetJavaType</span> <span class="token constant">INSTANCE</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BitSetJavaType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">BitSetJavaType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token class-name">BitSet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">MutabilityPlan</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BitSet</span><span class="token punctuation">&gt;</span></span> <span class="token function">getMutabilityPlan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BitSetMutabilityPlan</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">JdbcType</span> <span class="token function">getRecommendedJdbcType</span><span class="token punctuation">(</span><span class="token class-name">JdbcTypeIndicators</span> indicators<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> indicators<span class="token punctuation">.</span><span class="token function">getTypeConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">getJdbcTypeRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">getDescriptor</span><span class="token punctuation">(</span><span class="token class-name">Types</span><span class="token punctuation">.</span><span class="token constant">VARCHAR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">BitSet</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BitSetHelper</span><span class="token punctuation">.</span><span class="token function">bitSetToString</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">BitSet</span> <span class="token function">fromString</span><span class="token punctuation">(</span><span class="token class-name">CharSequence</span> string<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BitSetHelper</span><span class="token punctuation">.</span><span class="token function">stringToBitSet</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">X</span> <span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token class-name">BitSet</span> value<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> type<span class="token punctuation">,</span> <span class="token class-name">WrapperOptions</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">BitSet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">X</span><span class="token punctuation">)</span> value<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">X</span><span class="token punctuation">)</span> <span class="token function">toString</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">getComponentType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">byte</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">X</span><span class="token punctuation">)</span> value<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token function">unknownUnwrap</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">BitSet</span> <span class="token function">wrap</span><span class="token punctuation">(</span><span class="token class-name">X</span> value<span class="token punctuation">,</span> <span class="token class-name">WrapperOptions</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">CharSequence</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">fromString</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">CharSequence</span><span class="token punctuation">)</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">BitSet</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">BitSet</span><span class="token punctuation">)</span> value<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token function">unknownWrap</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@JavaTypeåœ¨æœ¬åœ°åº”ç”¨è¯¥ç±»å‹</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@JavaType</span><span class="token punctuation">(</span><span class="token class-name">BitSetJavaType</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">BitSet</span> bitSet<span class="token punctuation">;</span>

	<span class="token comment">//Constructors, getters, and setters are omitted for brevity</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@JavaTypeRegistrationå…¨å±€åº”ç”¨å®ƒã€‚è¿™å…è®¸åœ¨é‡åˆ°BitSetç±»å‹æ—¶å°†æ³¨å†Œçš„JavaTypeç”¨ä½œé»˜è®¤å€¼</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@JavaTypeRegistration</span><span class="token punctuation">(</span>javaType <span class="token operator">=</span> <span class="token class-name">BitSet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> descriptorClass <span class="token operator">=</span> <span class="token class-name">BitSetJavaType</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">BitSet</span> bitSet<span class="token punctuation">;</span>

	<span class="token comment">//Constructors, getters, and setters are omitted for brevity</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="é€‰æ‹©ä¸åŒçš„jdbctypedescriptor" tabindex="-1"><a class="header-anchor" href="#é€‰æ‹©ä¸åŒçš„jdbctypedescriptor"><span>é€‰æ‹©ä¸åŒçš„JdbcTypeDescriptor</span></a></h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„è‡ªå®šä¹‰BitSetJavaTypeå°†BitSetå€¼æ˜ å°„åˆ°VARCHARã€‚è¿™æ˜¯ä¸€ä¸ªæ¯”ç›´æ¥åºåˆ—åŒ–æ›´å¥½çš„é€‰é¡¹ã€‚ä½†ç”±äºBitSetæœ€ç»ˆæ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ‘ä»¬å¯èƒ½çœŸçš„å¸Œæœ›å°†å…¶æ˜ å°„ä¸ºVARBINARYç±»å‹ã€‚ä¸€ç§æ–¹æ³•æ˜¯å°†BitSetJavaType#getRecommendedJdbcTypeæ›´æ”¹ä¸ºè¿”å›VARBINARYæè¿°ç¬¦ã€‚å¦ä¸€ç§é€‰æ‹©æ˜¯ä½¿ç”¨æœ¬åœ°@JdbcTypeæˆ–@JdbcTypeCodeã€‚</p><p>æŒ‡å®šJdbcTypeçš„ç¤ºä¾‹å‡è®¾æˆ‘ä»¬çš„BitSetJavaTypeæ˜¯å…¨å±€æ³¨å†Œçš„ã€‚ æˆ‘ä»¬å°†å†æ¬¡å°†è¿™äº›å€¼ä½œä¸ºVARBINARYå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚ç„¶è€Œï¼Œç°åœ¨çš„åŒºåˆ«æ˜¯ï¼Œå¼ºåˆ¶æ–¹æ³•#wrapå’Œ#unwrapå°†ç”¨äºå‡†å¤‡å€¼ï¼Œè€Œä¸æ˜¯ä¾èµ–äºåºåˆ—åŒ–ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@JdbcTypeCode</span><span class="token punctuation">(</span><span class="token class-name">Types</span><span class="token punctuation">.</span><span class="token constant">VARBINARY</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">BitSet</span> bitSet<span class="token punctuation">;</span>

	<span class="token comment">//Constructors, getters, and setters are omitted for brevity</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œ@JdbcTypeCodeç”¨äºæŒ‡ç¤ºåº”ä½¿ç”¨ä¸ºJDBCçš„VARBINARYç±»å‹æ³¨å†Œçš„JdbcTypeã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@JdbcType</span><span class="token punctuation">(</span><span class="token class-name">CustomBinaryJdbcType</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">BitSet</span> bitSet<span class="token punctuation">;</span>

	<span class="token comment">//Constructors, getters, and setters are omitted for brevity</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œ@JdbcTypeå·²ç”¨äºä¸ºè¯¥å±æ€§æœ¬åœ°æŒ‡å®šè‡ªå®šä¹‰BitSetJdbcç±»å‹æè¿°ç¬¦ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@JdbcTypeRegistrationæ›¿æ¢Hibernateå¤„ç†æ‰€æœ‰VARBINARYçš„æ–¹å¼ï¼Œä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰impl</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@JdbcTypeRegistration</span><span class="token punctuation">(</span><span class="token class-name">CustomBinaryJdbcType</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">BitSet</span> bitSet<span class="token punctuation">;</span>

	<span class="token comment">//Constructors, getters, and setters are omitted for brevity</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="sqlå¼•ç”¨æ ‡è¯†ç¬¦" tabindex="-1"><a class="header-anchor" href="#sqlå¼•ç”¨æ ‡è¯†ç¬¦"><span>SQLå¼•ç”¨æ ‡è¯†ç¬¦</span></a></h3><p>æ‚¨å¯ä»¥å¼ºåˆ¶Hibernateåœ¨ç”Ÿæˆçš„SQLä¸­å¼•ç”¨æ ‡è¯†ç¬¦ï¼Œæ–¹æ³•æ˜¯å°†è¡¨æˆ–åˆ—åæ‹¬åœ¨æ˜ å°„æ–‡æ¡£çš„åå¼•å·ä¸­ã€‚ä¼ ç»Ÿä¸Šï¼ŒHibernateä½¿ç”¨åå¼•å·æ¥è½¬ä¹‰SQLä¿ç•™å…³é”®å­—ï¼Œè€ŒJakarta Persistenceä½¿ç”¨åŒå¼•å·ã€‚</p><p>ä¸€æ—¦è½¬ä¹‰äº†ä¿ç•™çš„å…³é”®å­—ï¼ŒHibernateå°†ä¸ºSQLæ–¹è¨€ä½¿ç”¨æ­£ç¡®çš„å¼•å·æ ·å¼ã€‚è¿™é€šå¸¸æ˜¯åŒå¼•å·ï¼Œä½†SQL Serverä½¿ç”¨æ‹¬å·ï¼ŒMySQLä½¿ç”¨åå¼•å·ã€‚</p><p><em>Hibernate quoting</em></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;`name`&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;`number`&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> number<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>Jakarta Persistence quoting</em></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;\&quot;name\&quot;&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;\&quot;number\&quot;&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> number<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› ä¸ºnameå’Œnumberæ˜¯ä¿ç•™å­—ï¼ŒProductå®ä½“æ˜ å°„ä½¿ç”¨åå¼•å·å¼•ç”¨è¿™äº›åˆ—åã€‚ä¿å­˜ä»¥ä¸‹Productå®ä½“æ—¶ï¼ŒHibernateç”Ÿæˆä»¥ä¸‹SQLæ’å…¥è¯­å¥ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">Product</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
product<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
product<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Mobile phone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
product<span class="token punctuation">.</span><span class="token function">setNumber</span><span class="token punctuation">(</span><span class="token string">&quot;123-456-7890&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
entityManager<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Product <span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;Mobile phone&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;123-456-7890&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å…¨å±€å¼•å·" tabindex="-1"><a class="header-anchor" href="#å…¨å±€å¼•å·"><span>å…¨å±€å¼•å·</span></a></h4><p>Hibernateè¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®å±æ€§å¼•ç”¨æ‰€æœ‰æ ‡è¯†ç¬¦ï¼ˆä¾‹å¦‚è¡¨ã€åˆ—ï¼‰ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span>
    <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hibernate.globally_quoted_identifiers<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨å¼•ç”¨ä»»ä½•æ ‡è¯†ç¬¦ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Product&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> number<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“æŒä¹…åŒ–Productå®ä½“æ—¶ï¼ŒHibernateå°†å¼•ç”¨æ‰€æœ‰æ ‡è¯†ç¬¦ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;Product&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;Mobile phone&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;123-456-7890&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æ‚¨æ‰€è§ï¼Œè¡¨åå’Œæ‰€æœ‰åˆ—éƒ½è¢«å¼•ç”¨äº†ã€‚</p><h3 id="ç”Ÿæˆå±æ€§" tabindex="-1"><a class="header-anchor" href="#ç”Ÿæˆå±æ€§"><span>ç”Ÿæˆå±æ€§</span></a></h3><p>æœ¬èŠ‚è®¨è®ºä¸ºéæ ‡è¯†ç¬¦å±æ€§ç”Ÿæˆå€¼ã€‚æœ‰å…³ç”Ÿæˆæ ‡è¯†ç¬¦å€¼çš„è®¨è®ºï¼Œè¯·å‚é˜…ç”Ÿæˆæ ‡è¯†ç¬¦å€¼ã€‚</p><p>ç”Ÿæˆçš„å±æ€§çš„å€¼æ˜¯åœ¨æ‰§è¡ŒSQL INSERTæˆ–UPDATEæ—¶ç”Ÿæˆçš„ã€‚åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼ç”Ÿæˆè¿™äº›å€¼ï¼ˆSQLDEFAULTå€¼ã€è§¦å‘å™¨ç­‰ï¼‰ã€‚é€šå¸¸ï¼Œåº”ç”¨ç¨‹åºéœ€è¦åˆ·æ–°å¯¹è±¡ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸»è¦ç¼ºç‚¹ã€‚</p><p>åº”ç”¨ç¨‹åºè¿˜å¯ä»¥å°†ç”Ÿæˆå§”æ‰˜ç»™Hibernateï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒHibernateå°†è‡ªè¡Œç®¡ç†å€¼ç”Ÿæˆå’Œï¼ˆæ½œåœ¨çš„[3]ï¼‰çŠ¶æ€åˆ·æ–°ã€‚</p><p>åªèƒ½å°†@Basicå’Œ@Versionå±æ€§æ ‡è®°ä¸ºå·²ç”Ÿæˆã€‚æ­¤å¤–ï¼Œç”Ÿæˆçš„å±æ€§å¿…é¡»æ˜¯ä¸å¯æ’å…¥å’Œä¸å¯æ›´æ–°çš„ã€‚</p><p>Hibernateæ”¯æŒVMå’ŒDBç”Ÿæˆã€‚ä½¿ç”¨å½“å‰JVMæ—¶é—´æˆ³ä½œä¸ºç”Ÿæˆå€¼çš„ç”Ÿæˆæ˜¯VMå†…ç­–ç•¥çš„ä¸€ä¸ªç¤ºä¾‹ã€‚ä½¿ç”¨æ•°æ®åº“çš„current_timestampå‡½æ•°çš„ç”Ÿæˆæ˜¯æ•°æ®åº“å†…ç­–ç•¥çš„ä¸€ä¸ªç¤ºä¾‹ã€‚</p><p>Hibernateæ”¯æŒä»¥ä¸‹ç”Ÿæˆç­–ç•¥ï¼š</p><ul><li><code>NEVER</code> (the default)ï¼šæœªç”Ÿæˆç»™å®šçš„å±æ€§å€¼</li><li>INSERTï¼šå±æ€§å€¼åœ¨æ’å…¥æ—¶ç”Ÿæˆï¼Œä½†åœ¨åç»­æ›´æ–°æ—¶ä¸ä¼šé‡æ–°ç”Ÿæˆ</li><li>ALWAYSï¼šæ’å…¥å’Œæ›´æ–°æ—¶éƒ½ä¼šç”Ÿæˆå±æ€§å€¼ã€‚</li></ul><p>Hibernateæ”¯æŒå¤šç§æ–¹å¼å°†å±æ€§æ ‡è®°ä¸ºç”Ÿæˆï¼š</p><ul><li>ä½¿ç”¨Hibernateæä¾›çš„ä¸“ç”¨ç”Ÿæˆå™¨</li></ul><ul><li><code>@CurrentTimestamp</code> - <a href="https://docs.jboss.org/hibernate/orm/6.1/userguide/html_single/Hibernate_User_Guide.html#mapping-generated-CurrentTimestamp" target="_blank" rel="noopener noreferrer"><code>@CurrentTimestamp</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><code>@CreationTimestamp</code> - <a href="https://docs.jboss.org/hibernate/orm/6.1/userguide/html_single/Hibernate_User_Guide.html#mapping-generated-CreationTimestamp" target="_blank" rel="noopener noreferrer"><code>@CreationTimestamp</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><code>@UpdateTimestamp</code> - <a href="https://docs.jboss.org/hibernate/orm/6.1/userguide/html_single/Hibernate_User_Guide.html#mapping-generated-UpdateTimestamp" target="_blank" rel="noopener noreferrer"><code>@UpdateTimestamp</code> annotation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><code>@Generated</code> - <a href="https://docs.jboss.org/hibernate/orm/6.1/userguide/html_single/Hibernate_User_Guide.html#mapping-generated-Generated" target="_blank" rel="noopener noreferrer"><code>@Generated</code> annotation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><ul><li>@GeneratorType-å·²å¼ƒç”¨ï¼Œæ­¤å¤„æœªæ¶‰åŠ</li><li>ä½¿ç”¨è‡ªå®šä¹‰ç”Ÿæˆç­–ç•¥-è‡ªå®šä¹‰ç”Ÿæˆç­–ç•¥</li></ul><h5 id="currenttimestamp" tabindex="-1"><a class="header-anchor" href="#currenttimestamp"><span><code>@CurrentTimestamp</code></span></a></h5><p>@CurrentTimestampæ³¨é‡Šæ˜¯ä¸€ç§dbç”Ÿæˆç­–ç•¥ï¼Œå¯ä»¥é…ç½®INSERTæˆ–ALWAYSç­–ç•¥ã€‚å®ƒä½¿ç”¨æ•°æ®åº“çš„current_timestampå‡½æ•°ä½œä¸ºç”Ÿæˆçš„å€¼</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@CurrentTimestamp</span><span class="token punctuation">(</span> timing <span class="token operator">=</span> <span class="token class-name">GenerationTiming</span><span class="token punctuation">.</span><span class="token constant">INSERT</span> <span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Instant</span> createdAt<span class="token punctuation">;</span>

<span class="token annotation punctuation">@CurrentTimestamp</span><span class="token punctuation">(</span> timing <span class="token operator">=</span> <span class="token class-name">GenerationTiming</span><span class="token punctuation">.</span><span class="token constant">ALWAYS</span> <span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Instant</span> lastUpdatedAt<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="creationtimestamp" tabindex="-1"><a class="header-anchor" href="#creationtimestamp"><span><code>@CreationTimestamp</code></span></a></h5><p>@CreationTimestampæ³¨é‡Šæ˜¯VMå†…INSERTç­–ç•¥ã€‚Hibernateå°†ä½¿ç”¨JVMçš„å½“å‰æ—¶é—´æˆ³ä½œä¸ºå±æ€§çš„æ’å…¥å€¼ã€‚æ”¯æŒå¤§å¤šæ•°æ—¶é—´ç±»å‹ï¼ˆjava.time.Instantã€java.util.Dateã€java.util.Calendarç­‰ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Event&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Event</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token annotation punctuation">@GeneratedValue</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;`timestamp`&quot;</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@CreationTimestamp</span>
	<span class="token keyword">private</span> <span class="token class-name">Date</span> timestamp<span class="token punctuation">;</span>

	<span class="token comment">//Constructors, getters, and setters are omitted for brevity</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ’å…¥äº‹ä»¶æ—¶ï¼ŒHibernateå°†ç”¨å½“å‰JVMæ—¶é—´æˆ³å€¼å¡«å……åº•å±‚æ—¶é—´æˆ³åˆ—</p><h5 id="updatetimestamp" tabindex="-1"><a class="header-anchor" href="#updatetimestamp"><span><code>@UpdateTimestamp</code></span></a></h5><p>@UpdateTimestampæ³¨é‡Šæ˜¯VMå†…INSERTç­–ç•¥ã€‚Hibernateå°†ä½¿ç”¨JVMçš„å½“å‰æ—¶é—´æˆ³ä½œä¸ºå±æ€§çš„æ’å…¥å’Œæ›´æ–°å€¼ã€‚æ”¯æŒå¤§å¤šæ•°æ—¶é—´ç±»å‹ï¼ˆjava.time.Instantã€java.util.Dateã€java.util.Calendarç­‰ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Bid&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Bid</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token annotation punctuation">@GeneratedValue</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;updated_on&quot;</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@UpdateTimestamp</span>
	<span class="token keyword">private</span> <span class="token class-name">Date</span> updatedOn<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;updated_by&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> updatedBy<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">Long</span> cents<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters are omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="generated" tabindex="-1"><a class="header-anchor" href="#generated"><span><code>@Generated</code></span></a></h5><p>@Generatedæ³¨é‡Šæ˜¯ä¸€ç§DBå†…ç­–ç•¥ï¼Œå¯ä»¥é…ç½®timingç­‰äºINSERTæˆ–ALWAYS,è¿™æ˜¯DBä¸­ç”Ÿæˆå€¼çš„é—ç•™æ˜ å°„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Person&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> firstName<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> middleName1<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> middleName2<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> middleName3<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> middleName4<span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">String</span> middleName5<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Generated</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">GenerationTime</span><span class="token punctuation">.</span><span class="token constant">ALWAYS</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>columnDefinition <span class="token operator">=</span>
		<span class="token string">&quot;AS CONCAT(&quot;</span> <span class="token operator">+</span>
		<span class="token string">&quot;	COALESCE(firstName, &#39;&#39;), &quot;</span> <span class="token operator">+</span>
		<span class="token string">&quot;	COALESCE(&#39; &#39; + middleName1, &#39;&#39;), &quot;</span> <span class="token operator">+</span>
		<span class="token string">&quot;	COALESCE(&#39; &#39; + middleName2, &#39;&#39;), &quot;</span> <span class="token operator">+</span>
		<span class="token string">&quot;	COALESCE(&#39; &#39; + middleName3, &#39;&#39;), &quot;</span> <span class="token operator">+</span>
		<span class="token string">&quot;	COALESCE(&#39; &#39; + middleName4, &#39;&#39;), &quot;</span> <span class="token operator">+</span>
		<span class="token string">&quot;	COALESCE(&#39; &#39; + middleName5, &#39;&#39;), &quot;</span> <span class="token operator">+</span>
		<span class="token string">&quot;	COALESCE(&#39; &#39; + lastName, &#39;&#39;) &quot;</span> <span class="token operator">+</span>
		<span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> fullName<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è‡ªå®šä¹‰ç”Ÿæˆç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰ç”Ÿæˆç­–ç•¥"><span>è‡ªå®šä¹‰ç”Ÿæˆç­–ç•¥</span></a></h4><p>Hibernateè¿˜æ”¯æŒä½¿ç”¨@ValueGenerationTypeå’ŒAnnotationValueGenerationå¯æ’æ‹”APIç”Ÿæˆå€¼ï¼Œå…è®¸ç”¨æˆ·å®šä¹‰ä»–ä»¬æƒ³è¦çš„ä»»ä½•ç”Ÿæˆç­–ç•¥ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç”ŸæˆUUIDå€¼çš„ç¤ºä¾‹ã€‚é¦–å…ˆæ˜¯å±æ€§æ˜ å°„</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@GeneratedUuidValue</span><span class="token punctuation">(</span> timing <span class="token operator">=</span> <span class="token class-name">GenerationTiming</span><span class="token punctuation">.</span><span class="token constant">INSERT</span> <span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">UUID</span> createdUuid<span class="token punctuation">;</span>

<span class="token annotation punctuation">@GeneratedUuidValue</span><span class="token punctuation">(</span> timing <span class="token operator">=</span> <span class="token class-name">GenerationTiming</span><span class="token punctuation">.</span><span class="token constant">ALWAYS</span> <span class="token punctuation">)</span>
   <span class="token keyword">public</span> <span class="token class-name">UUID</span> updatedUuid<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç¤ºä¾‹ä½¿ç”¨äº†ä¸€ä¸ªåä¸º@GeneratedUuidValueçš„æ³¨é‡Šï¼Œä½†è¯¥æ³¨é‡Šæ˜¯åœ¨å“ªé‡Œå®šä¹‰çš„ï¼Ÿè¿™æ˜¯åº”ç”¨ç¨‹åºæä¾›çš„è‡ªå®šä¹‰æ³¨é‡Šã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@ValueGenerationType</span><span class="token punctuation">(</span> generatedBy <span class="token operator">=</span> <span class="token class-name">UuidValueGeneration</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">FIELD</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION_TYPE</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token annotation punctuation">@Inherited</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">GeneratedUuidValue</span> <span class="token punctuation">{</span>
	<span class="token class-name">GenerationTiming</span> <span class="token function">timing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„@ValueGenerationTypeï¼ˆgeneratedBy=UuidValueGeneration.classï¼‰æ˜¯é‡è¦çš„éƒ¨åˆ†ï¼›å®ƒå‘Šè¯‰Hibernateå¦‚ä½•ä¸ºå±æ€§ç”Ÿæˆå€¼-åœ¨è¿™é‡Œå®ƒå°†ä½¿ç”¨æŒ‡å®šçš„UuidValueGenerationç±»</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">UuidValueGeneration</span> <span class="token keyword">implements</span> <span class="token class-name">AnnotationValueGeneration</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GeneratedUuidValue</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">ValueGenerator</span><span class="token generics"><span class="token punctuation">&lt;</span>UUID<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token class-name">GenerationTiming</span> timing<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token class-name">GeneratedUuidValue</span> annotation<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> propertyType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		timing <span class="token operator">=</span> annotation<span class="token punctuation">.</span><span class="token function">timing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">GenerationTiming</span> <span class="token function">getGenerationTiming</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> timing<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">ValueGenerator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getValueGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">referenceColumnInSql</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDatabaseGeneratedReferencedColumnValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">UUID</span> <span class="token function">generateValue</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">,</span> <span class="token class-name">Object</span> owner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆ—è½¬åŒ–æ¢å™¨-è¯»å–å’Œå†™å…¥è¡¨è¾¾å¼" tabindex="-1"><a class="header-anchor" href="#åˆ—è½¬åŒ–æ¢å™¨-è¯»å–å’Œå†™å…¥è¡¨è¾¾å¼"><span>åˆ—è½¬åŒ–æ¢å™¨ï¼šè¯»å–å’Œå†™å…¥è¡¨è¾¾å¼</span></a></h3><p>Hibernateå…è®¸æ‚¨è‡ªå®šä¹‰ç”¨äºè¯»å–å’Œå†™å…¥æ˜ å°„åˆ°@Basicç±»å‹çš„åˆ—å€¼çš„SQLã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„æ•°æ®åº“æä¾›äº†ä¸€ç»„æ•°æ®åŠ å¯†å‡½æ•°ï¼Œåˆ™å¯ä»¥åƒä¸‹é¢çš„ç¤ºä¾‹ä¸€æ ·ä¸ºå„ä¸ªåˆ—è°ƒç”¨å®ƒä»¬ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Employee&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>

		<span class="token annotation punctuation">@Id</span>
		<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

		<span class="token annotation punctuation">@NaturalId</span>
		<span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

		<span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;pswd&quot;</span><span class="token punctuation">)</span>
		<span class="token annotation punctuation">@ColumnTransformer</span><span class="token punctuation">(</span>
			read <span class="token operator">=</span> <span class="token string">&quot;decrypt(&#39;AES&#39;, &#39;00&#39;, pswd )&quot;</span><span class="token punctuation">,</span>
			write <span class="token operator">=</span> <span class="token string">&quot;encrypt(&#39;AES&#39;, &#39;00&#39;, ?)&quot;</span>
		<span class="token punctuation">)</span>
<span class="token comment">// For H2 2.0.202+ one must use the varbinary DDL type</span>
<span class="token comment">//		@Column(name = &quot;pswd&quot;, columnDefinition = &quot;varbinary&quot;)</span>
<span class="token comment">//		@ColumnTransformer(</span>
<span class="token comment">//			read = &quot;trim(trailing u&amp;&#39;\\0000&#39; from cast(decrypt(&#39;AES&#39;, &#39;00&#39;, pswd ) as character varying))&quot;,</span>
<span class="token comment">//			write = &quot;encrypt(&#39;AES&#39;, &#39;00&#39;, ?)&quot;</span>
<span class="token comment">//		)</span>
		<span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

		<span class="token keyword">private</span> <span class="token keyword">int</span> accessLevel<span class="token punctuation">;</span>

		<span class="token annotation punctuation">@ManyToOne</span><span class="token punctuation">(</span>fetch <span class="token operator">=</span> <span class="token class-name">FetchType</span><span class="token punctuation">.</span><span class="token constant">LAZY</span><span class="token punctuation">)</span>
		<span class="token keyword">private</span> <span class="token class-name">Department</span> department<span class="token punctuation">;</span>

		<span class="token annotation punctuation">@ManyToMany</span><span class="token punctuation">(</span>mappedBy <span class="token operator">=</span> <span class="token string">&quot;employees&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Project</span><span class="token punctuation">&gt;</span></span> projects <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//Getters and setters omitted for brevity</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœå±æ€§ä½¿ç”¨å¤šä¸ªåˆ—ï¼Œåˆ™å¿…é¡»ä½¿ç”¨forColumnå±æ€§æŒ‡å®š@ColumnTransformerè¯»å†™è¡¨è¾¾å¼çš„ç›®æ ‡åˆ—:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Savings&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Savings</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Id</span>
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@CompositeType</span><span class="token punctuation">(</span><span class="token class-name">MonetaryAmountUserType</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@AttributeOverrides</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token annotation punctuation">@AttributeOverride</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;amount&quot;</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;money&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token annotation punctuation">@AttributeOverride</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@ColumnTransformer</span><span class="token punctuation">(</span>
			forColumn <span class="token operator">=</span> <span class="token string">&quot;money&quot;</span><span class="token punctuation">,</span>
			read <span class="token operator">=</span> <span class="token string">&quot;money / 100&quot;</span><span class="token punctuation">,</span>
			write <span class="token operator">=</span> <span class="token string">&quot;? * 100&quot;</span>
	<span class="token punctuation">)</span>
	<span class="token keyword">private</span> <span class="token class-name">MonetaryAmount</span> wallet<span class="token punctuation">;</span>

	<span class="token comment">//Getters and setters omitted for brevity</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯å½“æŸ¥è¯¢ä¸­å¼•ç”¨å±æ€§æ—¶ï¼ŒHibernateéƒ½ä¼šè‡ªåŠ¨åº”ç”¨è‡ªå®šä¹‰è¡¨è¾¾å¼ã€‚æ­¤åŠŸèƒ½ç±»ä¼¼äºæ´¾ç”Ÿå±æ€§[æ˜ å°„åˆ—å…¬å¼]ï¼Œä½†æœ‰ä¸¤ä¸ªåŒºåˆ«ï¼š</p><ul><li>è¯¥å±æ€§ç”±ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—ä½œä¸ºè‡ªåŠ¨æ¶æ„ç”Ÿæˆçš„ä¸€éƒ¨åˆ†å¯¼å‡ºã€‚</li><li>è¯¥å±æ€§æ˜¯è¯»å†™çš„ï¼Œè€Œä¸æ˜¯åªè¯»çš„ã€‚</li></ul><p>å¦‚æœæŒ‡å®šäº†writeè¡¨è¾¾å¼ï¼Œåˆ™è¯¥è¡¨è¾¾å¼å¿…é¡»ä»…åŒ…å«ä¸€ä¸ªâ€œï¼Ÿâ€å€¼çš„å ä½ç¬¦ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code>doInJPA<span class="token punctuation">(</span>this::entityManagerFactory<span class="token punctuation">,</span> entityManager <span class="token operator">-</span><span class="token operator">&gt;</span> {
	Savings savings <span class="token operator">=</span> new Savings<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	savings<span class="token punctuation">.</span>setId<span class="token punctuation">(</span><span class="token number">1</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>
	savings<span class="token punctuation">.</span>setWallet<span class="token punctuation">(</span>new MonetaryAmount<span class="token punctuation">(</span>BigDecimal<span class="token punctuation">.</span>TEN<span class="token punctuation">,</span> Currency<span class="token punctuation">.</span>getInstance<span class="token punctuation">(</span>Locale<span class="token punctuation">.</span>US<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	entityManager<span class="token punctuation">.</span>persist<span class="token punctuation">(</span>savings<span class="token punctuation">)</span><span class="token punctuation">;</span>
}<span class="token punctuation">)</span><span class="token punctuation">;</span>

doInJPA<span class="token punctuation">(</span>this::entityManagerFactory<span class="token punctuation">,</span> entityManager <span class="token operator">-</span><span class="token operator">&gt;</span> {
	Savings savings <span class="token operator">=</span> entityManager<span class="token punctuation">.</span>find<span class="token punctuation">(</span>Savings<span class="token punctuation">.</span>class<span class="token punctuation">,</span> <span class="token number">1</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>
	assertEquals<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> savings<span class="token punctuation">.</span>getWallet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getAmount<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>intValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	assertEquals<span class="token punctuation">(</span>Currency<span class="token punctuation">.</span>getInstance<span class="token punctuation">(</span>Locale<span class="token punctuation">.</span>US<span class="token punctuation">)</span><span class="token punctuation">,</span> savings<span class="token punctuation">.</span>getWallet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getCurrency<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
}<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Savings <span class="token punctuation">(</span>money<span class="token punctuation">,</span> currency<span class="token punctuation">,</span> id<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">&#39;USD&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">SELECT</span>
    s<span class="token punctuation">.</span>id <span class="token keyword">as</span> id1_0_0_<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>money <span class="token operator">/</span> <span class="token number">100</span> <span class="token keyword">as</span> money2_0_0_<span class="token punctuation">,</span>
    s<span class="token punctuation">.</span>currency <span class="token keyword">as</span> currency3_0_0_
<span class="token keyword">FROM</span>
    Savings s
<span class="token keyword">WHERE</span>
    s<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="criteriaæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#criteriaæŸ¥è¯¢"><span>CriteriaæŸ¥è¯¢</span></a></h1><p>æ¡ä»¶æŸ¥è¯¢ä¸ºHQLã€JPQLå’Œnative SQLæŸ¥è¯¢æä¾›äº†ä¸€ç§ç±»å‹å®‰å…¨çš„æ›¿ä»£æ–¹æ³•ã€‚</p><p>æ¡ä»¶æŸ¥è¯¢æ˜¯ä¸€ç§ç¼–ç¨‹çš„ã€ç±»å‹å®‰å…¨çš„è¡¨è¾¾æŸ¥è¯¢çš„æ–¹å¼ã€‚ä½¿ç”¨æ¥å£å’Œç±»æ¥è¡¨ç¤ºæŸ¥è¯¢çš„å„ä¸ªéƒ¨åˆ†ï¼ˆå¦‚æŸ¥è¯¢æœ¬èº«ã€selectå­å¥æˆ–order byç­‰ï¼‰ã€‚åœ¨å¼•ç”¨å±æ€§æ–¹é¢ï¼Œå®ƒä»¬ä¹Ÿæ˜¯ç±»å‹å®‰å…¨çš„ï¼Œæˆ‘ä»¬ç¨åä¼šçœ‹åˆ°ã€‚</p><p>æ¡ä»¶æŸ¥è¯¢æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¯¹è±¡å›¾ï¼Œå›¾ä¸­çš„æ¯ä¸ªéƒ¨åˆ†è¡¨ç¤ºä¸€ä¸ªåŸå­çš„æŸ¥è¯¢ã€‚æ‰§è¡Œæ¡ä»¶æŸ¥è¯¢çš„ç¬¬ä¸€æ­¥æ˜¯æ„å»ºæ­¤å›¾ã€‚åœ¨ä½¿ç”¨æ¡ä»¶æŸ¥è¯¢ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦ç†Ÿæ‚‰jakarta.persistence.criteria.CriteriaBuilderæ¥å£ã€‚å®ƒæ˜¯CriteriaQueryçš„æ„å»ºå·¥å‚ã€‚é€šè¿‡è°ƒç”¨jakarta.persistence.EntityManagerFactoryæˆ–jakarta.persistence.EntityManagerçš„getCriteriaBuilderï¼ˆï¼‰æ–¹æ³•ï¼Œå¯ä»¥è·å¾—jakarta.prersistence.CriteriaBuilderå®ä¾‹ã€‚</p><p>ä¸‹ä¸€æ­¥æ˜¯è·å–jakarta.persistence.criteria.CriteriaQueryã€‚ä¸ºæ­¤ï¼Œå¯ä»¥ä½¿ç”¨jakarta.prersistence.coriteria.CriteriaBuilderä¸Šçš„ä¸‰ç§æ–¹æ³•ä¹‹ä¸€å®Œæˆæ­¤æ“ä½œï¼š</p><ul><li><code>&lt;T&gt; CriteriaQuery&lt;T&gt; createQuery( Class&lt;T&gt; resultClass )</code></li><li><code>CriteriaQuery&lt;Tuple&gt; createTupleQuery()</code></li><li><code>CriteriaQuery&lt;Object&gt; createQuery()</code></li></ul><p>æ ¹æ®æŸ¥è¯¢ç»“æœçš„ç±»å‹ï¼Œæ¯ç§æ–¹æ³•éƒ½æœ‰ä¸åŒçš„ç”¨é€”ã€‚</p><h2 id="æ¡ä»¶æŸ¥è¯¢çš„ç±»å‹" tabindex="-1"><a class="header-anchor" href="#æ¡ä»¶æŸ¥è¯¢çš„ç±»å‹"><span>æ¡ä»¶æŸ¥è¯¢çš„ç±»å‹</span></a></h2><p>æ¡ä»¶æŸ¥è¯¢çš„ç±»å‹ï¼ˆä¹Ÿç§°ä¸ºï¼œTï¼ï¼‰æŒ‡ç¤ºæŸ¥è¯¢ç»“æœä¸­çš„é¢„æœŸç±»å‹ã€‚è¿™å¯èƒ½æ˜¯å®ä½“ã€æ•´æ•°æˆ–ä»»ä½•å…¶ä»–å¯¹è±¡ã€‚</p><h2 id="é€‰æ‹©å®ä½“" tabindex="-1"><a class="header-anchor" href="#é€‰æ‹©å®ä½“"><span>é€‰æ‹©å®ä½“</span></a></h2><p>è¿™å¯èƒ½æ˜¯æœ€å¸¸è§çš„æŸ¥è¯¢å½¢å¼ã€‚åº”ç”¨ç¨‹åºå¸Œæœ›æŸ¥è¯¢å®ä½“å®ä¾‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1.</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> root <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2.</span>
criteria<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//3.</span>
criteria<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//4.</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> persons <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>è¯¥ç¤ºä¾‹ä½¿ç”¨createQuery()ä¼ å…¥Personç±»å¼•ç”¨ï¼Œå› ä¸ºæŸ¥è¯¢ç»“æœå°†æ˜¯Personå¯¹è±¡ã€‚</li><li>é€‰æ‹©æŸ¥è¯¢çš„å®ä½“ï¼Œ å¯¹åº”SQLä¸­çš„ <code>from table</code></li><li>æŒ‡å®šè¿”å›é‚£äº›åˆ—ï¼Œæœ¬ä¾‹ä¸­å¯¹CriteriaQuery#selectæ–¹æ³•çš„è°ƒç”¨æ˜¯ä¸å¿…è¦çš„ï¼Œå› ä¸ºæ ¹å°†æ˜¯éšå«çš„é€‰æ‹©ï¼Œå› ä¸ºæˆ‘ä»¬åªæœ‰ä¸€ä¸ªæŸ¥è¯¢æ ¹ã€‚è¿™é‡Œåªåšäº†ä¸€ä¸ªç¤ºä¾‹çš„å®Œæ•´æ€§ã€‚</li><li>Person_.nameå¼•ç”¨æ˜¯Jakarta Persistence Metamodelå¼•ç”¨çš„é™æ€å½¢å¼çš„ä¸€ä¸ªç¤ºä¾‹ã€‚</li></ol><h2 id="é€‰æ‹©è¡¨è¾¾å¼" tabindex="-1"><a class="header-anchor" href="#é€‰æ‹©è¡¨è¾¾å¼"><span>é€‰æ‹©è¡¨è¾¾å¼</span></a></h2><p>é€‰æ‹©è¡¨è¾¾å¼çš„æœ€ç®€å•å½¢å¼æ˜¯ä»å®ä½“ä¸­é€‰æ‹©ç‰¹å®šå±æ€§ã€‚ä½†è¿™ä¸ªè¡¨è¾¾å¼ä¹Ÿå¯èƒ½è¡¨ç¤ºèšåˆã€æ•°å­¦è¿ç®—ç­‰ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> root <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
criteria<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>nickName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
criteria<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nickNames <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æœ¬ä¾‹ä¸­ï¼ŒæŸ¥è¯¢ç±»å‹ä¸ºjava.lang.Stringï¼Œå› ä¸ºè¿™æ˜¯é¢„æœŸçš„ç»“æœç±»å‹ï¼ˆPerson#nickNameå±æ€§çš„ç±»å‹ä¸ºjava.lang.Stringï¼‰ã€‚å±æ€§å¼•ç”¨é€šè¿‡Root#getæ–¹æ³•è°ƒç”¨å®Œæˆçš„ã€‚</p><h2 id="é€‰æ‹©å¤šä¸ªå€¼" tabindex="-1"><a class="header-anchor" href="#é€‰æ‹©å¤šä¸ªå€¼"><span>é€‰æ‹©å¤šä¸ªå€¼</span></a></h2><p>å®é™…ä¸Šï¼Œä½¿ç”¨æ¡ä»¶æŸ¥è¯¢é€‰æ‹©å¤šä¸ªå€¼æœ‰å‡ ç§ä¸åŒçš„æ–¹æ³•ã€‚æˆ‘ä»¬å°†åœ¨è¿™é‡Œæ¢è®¨ä¸¤ä¸ªé€‰é¡¹ï¼Œä¸€ç§æ¨èçš„æ–¹æ³•æ˜¯ä½¿ç”¨å…ƒç»„ï¼Œå¦ä¸€ç§æ˜¯åŒ…è£…å™¨æŸ¥è¯¢ã€‚</p><h5 id="ç¤ºä¾‹-ä½¿ç”¨æ•°ç»„" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-ä½¿ç”¨æ•°ç»„"><span>ç¤ºä¾‹ï¼šä½¿ç”¨æ•°ç»„</span></a></h5><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token operator">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> root <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Path</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> idPath <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Path</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nickNamePath <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>nickName<span class="token punctuation">)</span><span class="token punctuation">;</span>

criteria<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span>idPath<span class="token punctuation">,</span> nickNamePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>
criteria<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> idAndNickNames <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»æŠ€æœ¯ä¸Šè®²ï¼Œè¿™è¢«å½’ç±»ä¸ºç±»å‹åŒ–æŸ¥è¯¢ï¼Œä½†ä»å¤„ç†ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œè¿™æœ‰ç‚¹è¯¯å¯¼ã€‚æ— è®ºå¦‚ä½•ï¼Œè¿™é‡Œçš„é¢„æœŸç»“æœç±»å‹æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</p><h5 id="ç¤ºä¾‹-ä½¿ç”¨multiselect" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-ä½¿ç”¨multiselect"><span>ç¤ºä¾‹ï¼šä½¿ç”¨multiselect</span></a></h5><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token operator">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> root <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Path</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> idPath <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Path</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nickNamePath <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>nickName<span class="token punctuation">)</span><span class="token punctuation">;</span>

criteria<span class="token punctuation">.</span><span class="token function">multiselect</span><span class="token punctuation">(</span>idPath<span class="token punctuation">,</span> nickNamePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
criteria<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> idAndNickNames <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="é€‰æ‹©-åŒ…è£…å™¨" tabindex="-1"><a class="header-anchor" href="#é€‰æ‹©-åŒ…è£…å™¨"><span>é€‰æ‹© åŒ…è£…å™¨</span></a></h2><p>é€‰æ‹©å¤šä¸ªå€¼çš„å¦ä¸€ç§é€‰æ‹©æ˜¯é€‰æ‹©ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°†â€œåŒ…è£…â€å¤šä¸ªå€¼ã€‚è¿”å›ç¤ºä¾‹æŸ¥è¯¢ï¼Œè€Œä¸æ˜¯è¿”å›[Person#idï¼ŒPerson#nickName]æ•°ç»„ï¼Œè€Œæ˜¯å£°æ˜ä¸€ä¸ªä¿å­˜è¿™äº›å€¼çš„ç±»å¹¶å°†å…¶ç”¨ä½œè¿”å›å¯¹è±¡ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PersonWrapper</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> nickName<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">PersonWrapper</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> nickName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>nickName <span class="token operator">=</span> nickName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getNickName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> nickName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PersonWrapper</span><span class="token punctuation">&gt;</span></span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">PersonWrapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> root <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Path</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> idPath <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Path</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nickNamePath <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>nickName<span class="token punctuation">)</span><span class="token punctuation">;</span>

criteria<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span><span class="token class-name">PersonWrapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> idPath<span class="token punctuation">,</span> nickNamePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
criteria<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PersonWrapper</span><span class="token punctuation">&gt;</span></span> wrappers <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é¦–å…ˆï¼Œæˆ‘ä»¬çœ‹åˆ°å°†ç”¨äºåŒ…è£…ç»“æœå€¼çš„åŒ…è£…å™¨å¯¹è±¡çš„ç®€å•å®šä¹‰ã€‚å…·ä½“æ¥è¯´ï¼Œè¯·æ³¨æ„æ„é€ å‡½æ•°åŠå…¶å‚æ•°ç±»å‹ã€‚å› ä¸ºæˆ‘ä»¬å°†è¿”å›PersonWrapperå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨PersonWrappeä½œä¸ºæ¡ä»¶æŸ¥è¯¢çš„ç±»å‹ã€‚</p><h2 id="å…ƒç»„æ¡ä»¶æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#å…ƒç»„æ¡ä»¶æŸ¥è¯¢"><span>å…ƒç»„æ¡ä»¶æŸ¥è¯¢</span></a></h2><p>é€‰æ‹©å¤šä¸ªå€¼çš„æ›´å¥½æ–¹æ³•æ˜¯ä½¿ç”¨åŒ…è£…å™¨ï¼ˆæˆ‘ä»¬åˆšåˆšåœ¨é€‰æ‹©åŒ…è£…å™¨ä¸­çœ‹åˆ°ï¼‰æˆ–ä½¿ç”¨jakarta.persistence.Tupleåˆçº¦ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple</span><span class="token punctuation">&gt;</span></span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">Tuple</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> root <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Path</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> idPath <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Path</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nickNamePath <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>nickName<span class="token punctuation">)</span><span class="token punctuation">;</span>

criteria<span class="token punctuation">.</span><span class="token function">multiselect</span><span class="token punctuation">(</span>idPath<span class="token punctuation">,</span> nickNamePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
criteria<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple</span><span class="token punctuation">&gt;</span></span> tuples <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Tuple</span> tuple <span class="token operator">:</span> tuples<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">Long</span> id <span class="token operator">=</span> tuple<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>idPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> nickName <span class="token operator">=</span> tuple<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>nickNamePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//or using indices</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Tuple</span> tuple <span class="token operator">:</span> tuples<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">Long</span> id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">)</span> tuple<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> nickName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> tuple<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤ç¤ºä¾‹è¯´æ˜å¦‚ä½•é€šè¿‡jakarta.persistence.Tupleæ¥å£è®¿é—®æŸ¥è¯¢ç»“æœã€‚è¯¥ç¤ºä¾‹ä½¿ç”¨jakarta.persistence.criteria.criteria.CriteriaBuilderçš„æ˜¾å¼createTupleQueryï¼ˆï¼‰ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨createQueryï¼ˆTuple.classï¼‰ã€‚</p><p>jakarta.persistence.TupleåˆåŒæä¾›äº†ä¸‰ç§å½¢å¼çš„åº•å±‚å…ƒç´ è®¿é—®ï¼š</p><ul><li>typed: <code>tuple.get( idPath )</code> å’Œ <code>tuple.get( nickNamePath )</code>ä½¿ç”¨çš„å°±æ˜¯è¿™ç§æ–¹å¼ï¼Œè¿™å…è®¸åŸºäºç”¨äºæ„å»ºæ¡ä»¶çš„jakarta.persistence.TupleElementè¡¨è¾¾å¼å¯¹åº•å±‚å…ƒç»„å€¼è¿›è¡Œç±»å‹åŒ–è®¿é—®ã€‚</li><li>positionalï¼š å…è®¸åŸºäºä½ç½®è®¿é—®åŸºç¡€å…ƒç»„å€¼ã€‚ç®€å•çš„Object getï¼ˆint positionï¼‰å½¢å¼ä¸é€‰æ‹©æ•°ç»„å’Œä½¿ç”¨multiselecté€‰æ‹©æ•°ç»„ä¸­æ‰€ç¤ºçš„è®¿é—®éå¸¸ç›¸ä¼¼ã€‚ï¼œXï¼X getï¼ˆint positionï¼ŒClassï¼œXï¼ç±»å‹å½¢å¼å…è®¸ç±»å‹åŒ–ä½ç½®è®¿é—®ï¼Œä½†åŸºäºæ˜¾å¼æä¾›çš„ç±»å‹ï¼Œå…ƒç»„å€¼å¿…é¡»æ˜¯ç±»å‹å¯èµ‹å€¼çš„ã€‚</li><li>aliasedï¼šå…è®¸åŸºäºï¼ˆå¯é€‰ï¼‰åˆ†é…çš„åˆ«åè®¿é—®åŸºç¡€å…ƒç»„å€¼ã€‚ç¤ºä¾‹æŸ¥è¯¢æœªåº”ç”¨åˆ«åã€‚åˆ«åå°†é€šè¿‡jakarta.persistence.criteriaSelectionä¸Šçš„alias æ–¹æ³•åº”ç”¨ã€‚å°±åƒä½ç½®è®¿é—®ä¸€æ ·ï¼Œæœ‰ç±»å‹åŒ–ï¼ˆObject getï¼ˆString aliasï¼‰ï¼‰å’Œéç±»å‹åŒ–ï¼ˆï¼œXï¼X getï¼ˆStringåˆ«åï¼ŒClassï¼œXï¼typeï¼‰ï¼‰å½¢å¼ã€‚</li></ul><h2 id="fromå­å¥" tabindex="-1"><a class="header-anchor" href="#fromå­å¥"><span>fromå­å¥</span></a></h2><p>CriteriaQueryå¯¹è±¡å®šä¹‰å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªå®ä½“ã€å¯åµŒå…¥æˆ–åŸºæœ¬æŠ½è±¡æ¨¡å¼ç±»å‹çš„æŸ¥è¯¢ã€‚æŸ¥è¯¢çš„æ ¹å¯¹è±¡æ˜¯å®ä½“ï¼Œå¯ä»¥ä»ä¸­è®¿é—®å…¶ä»–ç±»å‹ã€‚</p><p>FROMå­å¥çš„æ‰€æœ‰å•ç‹¬éƒ¨åˆ†ï¼ˆroots, joins, pathsï¼‰éƒ½å®ç°äº†jakarta.persistence.criteria.FROMæ¥å£ã€‚</p><h2 id="roots" tabindex="-1"><a class="header-anchor" href="#roots"><span>roots</span></a></h2><p>æ ¹å®šä¹‰æŸ¥è¯¢ä¸­æ‰€æœ‰joinã€è·¯å¾„å’Œå±æ€§çš„åŸºç¡€ã€‚æ ¹å§‹ç»ˆæ˜¯å®ä½“ç±»å‹ã€‚æ ¹ç”±jakarta.persistence.criteria.criteria.CriteriaQueryä¸Šçš„é‡è½½fromæ–¹æ³•å®šä¹‰å¹¶æ·»åŠ åˆ°æ¡ä»¶ä¸­ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> <span class="token function">from</span><span class="token punctuation">(</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> <span class="token function">from</span><span class="token punctuation">(</span> <span class="token class-name">EntityType</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">X</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> root <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¡ä»¶æŸ¥è¯¢å¯ä»¥å®šä¹‰å¤šä¸ªæ ¹ï¼Œå…¶æ•ˆæœæ˜¯åœ¨æ–°æ·»åŠ çš„æ ¹å’Œå…¶ä»–æ ¹ä¹‹é—´åˆ›å»ºç¬›å¡å°”ç§¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple</span><span class="token punctuation">&gt;</span></span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">Tuple</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> personRoot <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Partner</span><span class="token punctuation">&gt;</span></span> partnerRoot <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Partner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
criteria<span class="token punctuation">.</span><span class="token function">multiselect</span><span class="token punctuation">(</span>personRoot<span class="token punctuation">,</span> partnerRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Predicate</span> personRestriction <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>
	builder<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>personRoot<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">,</span> address<span class="token punctuation">)</span><span class="token punctuation">,</span>
	builder<span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>personRoot<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>phones<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Predicate</span> partnerRestriction <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>
	builder<span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span>partnerRoot<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Partner_</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> prefix<span class="token punctuation">)</span><span class="token punctuation">,</span>
	builder<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>partnerRoot<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Partner_</span><span class="token punctuation">.</span>version<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
criteria<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>personRestriction<span class="token punctuation">,</span> partnerRestriction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple</span><span class="token punctuation">&gt;</span></span> tuples <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="joins" tabindex="-1"><a class="header-anchor" href="#joins"><span>joins</span></a></h2><p>joinså…è®¸ä»å…¶ä»–jakarta.persistence.criteria.fromå¯¼èˆªåˆ°å…³è”æˆ–åµŒå…¥å±æ€§ã€‚joinsæ˜¯ç”±jakarta.persistence.criteria.Fromæ¥å£çš„å¤§é‡é‡è½½joinæ–¹æ³•åˆ›å»ºçš„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Phone</span><span class="token punctuation">&gt;</span></span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">Phone</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Phone</span><span class="token punctuation">&gt;</span></span> root <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Phone</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Phone.person is a @ManyToOne</span>
<span class="token class-name">Join</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Phone</span><span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> personJoin <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token class-name">Phone_</span><span class="token punctuation">.</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Person.addresses is an @ElementCollection</span>
<span class="token class-name">Join</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> addressesJoin <span class="token operator">=</span> personJoin<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>addresses<span class="token punctuation">)</span><span class="token punctuation">;</span>

criteria<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Phone_</span><span class="token punctuation">.</span>calls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Phone</span><span class="token punctuation">&gt;</span></span> phones <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="fetches" tabindex="-1"><a class="header-anchor" href="#fetches"><span>Fetches</span></a></h2><p>å°±åƒåœ¨HQLå’ŒJPQLä¸­ä¸€æ ·ï¼Œæ¡ä»¶æŸ¥è¯¢å¯ä»¥æŒ‡å®šä¸æ‰€æœ‰è€…ä¸€èµ·fetchå…³è”æ•°æ®ã€‚fetchç”±jakarta.persistence.criteria.Fromæ¥å£çš„å¤§é‡é‡è½½fetchæ–¹æ³•åˆ›å»ºã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Phone</span><span class="token punctuation">&gt;</span></span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">Phone</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Phone</span><span class="token punctuation">&gt;</span></span> root <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Phone</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Phone.person is a @ManyToOne</span>
<span class="token class-name">Fetch</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Phone</span><span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> personFetch <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token class-name">Phone_</span><span class="token punctuation">.</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Person.addresses is an @ElementCollection</span>
<span class="token class-name">Fetch</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> addressesJoin <span class="token operator">=</span> personFetch<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>addresses<span class="token punctuation">)</span><span class="token punctuation">;</span>

criteria<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Phone_</span><span class="token punctuation">.</span>calls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Phone</span><span class="token punctuation">&gt;</span></span> phones <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»æŠ€æœ¯ä¸Šè®²ï¼ŒåµŒå…¥å±æ€§æ€»æ˜¯ä»å…¶æ‰€æœ‰è€…é‚£é‡Œè·å–çš„ã€‚ç„¶è€Œï¼Œä¸ºäº†å®šä¹‰Phone#addressesçš„è·å–ï¼Œæˆ‘ä»¬éœ€è¦jakarta.persistence.criteria.Fetchï¼Œå› ä¸ºå…ƒç´ é›†åˆé»˜è®¤ä¸ºLAZYã€‚</p><h2 id="path-expressions" tabindex="-1"><a class="header-anchor" href="#path-expressions"><span>Path expressions</span></a></h2><p>Roots, joins å’Œ fetchesæœ¬èº«ä¹Ÿæ˜¯è·¯å¾„è¡¨è¾¾å¼ã€‚</p><h2 id="ä½¿ç”¨å‚æ•°" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨å‚æ•°"><span>ä½¿ç”¨å‚æ•°</span></a></h2><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> root <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">ParameterExpression</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nickNameParameter <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">parameter</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
criteria<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Person_</span><span class="token punctuation">.</span>nickName<span class="token punctuation">)</span><span class="token punctuation">,</span> nickNameParameter<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">TypedQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> query <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">setParameter</span><span class="token punctuation">(</span>nickNameParameter<span class="token punctuation">,</span> <span class="token string">&quot;JD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> persons <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨jakarta.persistence.criteria.CriteriaBuilderçš„parameteræ–¹æ³•è·å–å‚æ•°å¼•ç”¨ã€‚ç„¶åä½¿ç”¨å‚æ•°å¼•ç”¨å°†å‚æ•°å€¼ç»‘å®šåˆ°jakarta.persistence.Queryã€‚</p><h2 id="using-group-by" tabindex="-1"><a class="header-anchor" href="#using-group-by"><span>Using group by</span></a></h2><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaBuilder</span> builder <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">getCriteriaBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple</span><span class="token punctuation">&gt;</span></span> criteria <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">Tuple</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> root <span class="token operator">=</span> criteria<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

criteria<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
criteria<span class="token punctuation">.</span><span class="token function">multiselect</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> builder<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple</span><span class="token punctuation">&gt;</span></span> tuples <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Tuple</span> tuple <span class="token operator">:</span> tuples<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> tuple<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">Long</span> count <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">)</span> tuple<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="è§„èŒƒ" tabindex="-1"><a class="header-anchor" href="#è§„èŒƒ"><span>è§„èŒƒ</span></a></h1><h3 id="pathå¯¼èˆª" tabindex="-1"><a class="header-anchor" href="#pathå¯¼èˆª"><span>pathå¯¼èˆª</span></a></h3><p>Pathå®ä¾‹å¯ä»¥æ˜¯Rootå®ä¾‹ã€Joinå®ä¾‹ã€é€šè¿‡getå¯¼èˆªæ–¹æ³•ä»å¦ä¸€ä¸ªPathå®ä¾‹æ´¾ç”Ÿçš„Pathå®ä¾‹ï¼Œæˆ–è€…é€šè¿‡ä½¿ç”¨keyæˆ–valueæ–¹æ³•ä»æ˜ å°„å€¼å…³è”æˆ–å…ƒç´ é›†åˆæ´¾ç”Ÿå‡ºçš„Pathå®ä¾‹ã€‚</p><p>å½“æ‰§è¡Œæ¡ä»¶æŸ¥è¯¢æ—¶ï¼Œä½¿ç”¨Jakarta PersistenceæŸ¥è¯¢è¯­è¨€çš„è·¯å¾„å¯¼èˆªï¼Œ ç­‰åŒäº inner join çš„è¯­ä¹‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœéç»ˆç«¯Pathå®ä¾‹çš„å€¼ä¸ºç©ºï¼Œåˆ™è¯¥è·¯å¾„è¢«è®¤ä¸ºæ²¡æœ‰å€¼ï¼Œå¹¶ä¸”ä¸å‚ä¸æŸ¥è¯¢ç»“æœçš„ç¡®å®šã€‚</p><p>getæ–¹æ³•ç”¨äºè·¯å¾„å¯¼èˆªã€‚getæ–¹æ³•çš„å‚æ•°ç”±ç›¸åº”å…ƒæ¨¡å‹ç±»å¯¹åº”çš„SingularAttributeæˆ–é›†åˆå€¼å±æ€§ï¼ˆCollectionAttributeã€SetAttributeã€ListAttributeæˆ–MapAttributeï¼‰æŒ‡å®šã€‚</p><h5 id="ç¤ºä¾‹ä¸€" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹ä¸€"><span>ç¤ºä¾‹ä¸€ï¼š</span></a></h5><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ<em>ContactInfo</em>æ˜¯ç”±ä¸€ä¸ª<em>address</em> å’Œä¸€ç»„<em>Phone</em> ç»„æˆçš„å¯åµŒå…¥ç±»ã€‚<em>Phone</em> æ˜¯ä¸€ä¸ªå®ä½“ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Vendor</span><span class="token punctuation">&gt;</span></span> q <span class="token operator">=</span> cb<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token class-name">Vendor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> emp <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Join</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ContactInfo</span><span class="token punctuation">,</span> <span class="token class-name">Phone</span><span class="token punctuation">&gt;</span></span> phone <span class="token operator">=</span>emp<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token class-name">Employee_</span><span class="token punctuation">.</span>contactInfo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token class-name">ContactInfo_</span><span class="token punctuation">.</span>phones<span class="token punctuation">)</span><span class="token punctuation">;</span>
q<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>cb<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>emp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Employee_</span><span class="token punctuation">.</span>contactInfo<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">ContactInfo_</span><span class="token punctuation">.</span>address<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Address_</span><span class="token punctuation">.</span>zipcode<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;95054&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>phone<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Phone_</span><span class="token punctuation">.</span>vendor<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸‹Jakarta PersistenceæŸ¥è¯¢è¯­è¨€æŸ¥è¯¢æ˜¯ç­‰æ•ˆçš„ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> p<span class="token punctuation">.</span>vendor
<span class="token keyword">FROM</span> Employee e <span class="token keyword">JOIN</span> e<span class="token punctuation">.</span>contactInfo<span class="token punctuation">.</span>phones p
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>contactInfo<span class="token punctuation">.</span>address<span class="token punctuation">.</span>zipcode <span class="token operator">=</span> <span class="token string">&#39;95054&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="ç¤ºä¾‹äºŒ" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹äºŒ"><span>ç¤ºä¾‹äºŒï¼š</span></a></h5><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œphotoså±æ€§å¯¹åº”äºmap(key=ç…§ç‰‡æ ‡ç­¾,value=æ–‡ä»¶å)ã€‚mapé”®æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚æ­¤æŸ¥è¯¢çš„ç»“æœå°†ä½œä¸ºTupleå¯¹è±¡è¿”å›ï¼Œå…¶å…ƒç´ ç±»å‹ä¸ºStringå’Œobjectã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">CriteriaQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple</span><span class="token punctuation">&gt;</span></span> q <span class="token operator">=</span> cb<span class="token punctuation">.</span><span class="token function">createTupleQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Root</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Item</span><span class="token punctuation">&gt;</span></span> item <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token class-name">Item</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">MapJoin</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Item</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> photo <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token class-name">Item_</span><span class="token punctuation">.</span>photos<span class="token punctuation">)</span><span class="token punctuation">;</span>
q<span class="token punctuation">.</span><span class="token function">multiselect</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Item_</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> photo<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>cb<span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span>photo<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;%egret%&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸‹Jakarta PersistenceæŸ¥è¯¢è¯­è¨€æŸ¥è¯¢æ˜¯ç­‰æ•ˆçš„ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> i<span class="token punctuation">.</span>name<span class="token punctuation">,</span> p
<span class="token keyword">FROM</span> Item i <span class="token keyword">JOIN</span> i<span class="token punctuation">.</span>photos p
<span class="token keyword">WHERE</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">LIKE</span> <span class="token string">&#39;%egret%&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!----><!--]--><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a href="https://github.com/banrenshan/banrenshan.github.io/edit/main/src/gudie/15-Hibernate.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link vp-meta-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: CP_zhaozhiqiang@163.com">banrenshan</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link nav-link prev" href="/gudie/01-flyway.html" aria-label="flywayæŒ‡å—"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->flywayæŒ‡å—</div></a><a class="route-link nav-link next" href="/gudie/02-jsonassert.html" aria-label="JSONassertæŒ‡å—"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">JSONassertæŒ‡å—<!----></div></a></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><!----></div><!--]--><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-Brzzz3sI.js" defer></script>
  </body>
</html>
