import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o,c as t,a as i}from"./app-g-OKA8ms.js";const r={},a=i(`<h2 id="配置" tabindex="-1"><a class="header-anchor" href="#配置"><span>配置</span></a></h2><h3 id="超时设置" tabindex="-1"><a class="header-anchor" href="#超时设置"><span>超时设置</span></a></h3><p><code>haproxy.router.openshift.io/timeout</code>: 设定超时时间</p><h3 id="cookie设置" tabindex="-1"><a class="header-anchor" href="#cookie设置"><span>cookie设置</span></a></h3><p><code>haproxy.router.openshift.io/disable_cookies</code>:是否禁用cookie</p><p><code>router.openshift.io/cookie_name</code>: 指定cookie的名称</p><p><code>router.openshift.io/cookie-same-site</code>：数值是：</p><ul><li><code>Lax</code>：cookies 在访问的站点和第三方站点间进行传输。</li><li><code>Strict</code>：cookies 仅限于访问的站点。</li><li><code>None</code>：cookies 仅限于指定的站点。</li></ul><h3 id="连接限制" tabindex="-1"><a class="header-anchor" href="#连接限制"><span>连接限制</span></a></h3><ul><li><p><code>haproxy.router.openshift.io/pod-concurrent-connections</code>:设置路由支持的 pod 允许的最大连接数。如果有多个 pod，每个 pod 都有这些数量的连接。如果有多个路由器，它们之间没有协调关系，每个路由器都可能会多次连接。如果没有设置，或者将其设定为 0，则没有限制。</p></li><li><p><code>haproxy.router.openshift.io/rate-limit-connections</code>: 是否启用速率限制</p></li><li><p><code>haproxy.router.openshift.io/rate-limit-connections.concurrent-tcp</code>:限制通过同一源 IP 地址进行的并发 TCP 连接数。</p></li><li><p>流量限制:</p><ul><li><code>haproxy.router.openshift.io/rate-limit-connections.rate-http</code>:限制具有相同源 IP 地址的客户端可以发出 HTTP 请求的速率。</li><li><code>haproxy.router.openshift.io/rate-limit-connections.rate-tcp</code>:限制具有相同源 IP 地址的客户端可以进行 TCP 连接的速率。</li></ul></li></ul><h3 id="ip限制" tabindex="-1"><a class="header-anchor" href="#ip限制"><span>ip限制</span></a></h3><p><code>haproxy.router.openshift.io/ip_whitelist</code>: 为路由设置允许列表。允许列表（allowlist）是以空格分开的 IP 地址和 CIDR 范围列表，用来代表批准的源地址。不是来自允许列表中的 IP 地址的请求会被丢弃。</p><h3 id="其他设置" tabindex="-1"><a class="header-anchor" href="#其他设置"><span>其他设置</span></a></h3><p><code>router.openshift.io/haproxy.health.check.interval</code>:为后端健康检查设定间隔。</p><h3 id="路径重写" tabindex="-1"><a class="header-anchor" href="#路径重写"><span>路径重写</span></a></h3><p><code>haproxy.router.openshift.io/rewrite-target</code>: 在后端中设置请求的重写路径。</p><h2 id="安全路由" tabindex="-1"><a class="header-anchor" href="#安全路由"><span>安全路由</span></a></h2><p>不支持保护密钥文件。要从密钥文件中删除密码，使用以下命令：</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>openssl rsa -in password_protected_tls.key -out tls.key
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>安全路由分为下面三种：</p><ul><li><code>reencrypt</code>：是 edge 的一种变种。首先 router 上会使用一个证书做 TLS 终结，然后使用另外的证书再进行加密，然后发给后端 pod。因此，整个网络路径都是加密的。因此需要配置两个证书</li></ul><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>oc create route reencrypt --service=frontend --cert=tls.crt --key=tls.key --dest-ca-cert=destca.crt --ca-cert=ca.crt --hostname=www.example.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p><code>edge</code>：TLS 在 router 上被终结，然后非SSL网络包被转发给后端 pod。因此需要在 router 上安装 TLS 证书。不安装的话，会使用 router 的默认证书。只需要配置一个证书。</p></li><li><p><code>passthrough </code>：加密网络包直接被发给 pod，router 上不做TLS 终结，因为不需要在 router 上配置证书或密钥。</p></li></ul>`,23),n=[a];function c(p,l){return o(),t("div",null,n)}const h=e(r,[["render",c],["__file","17-OpenShift路由.html.vue"]]),u=JSON.parse('{"path":"/gudie/17-OpenShift%E8%B7%AF%E7%94%B1.html","title":"OpenShift 路由","lang":"zh-CN","frontmatter":{"title":"OpenShift 路由","date":"2024-04-20T00:00:00.000Z","categories":["OpenShift","kubernates"],"tags":["OpenShift"],"description":"配置 超时设置 haproxy.router.openshift.io/timeout: 设定超时时间 cookie设置 haproxy.router.openshift.io/disable_cookies:是否禁用cookie router.openshift.io/cookie_name: 指定cookie的名称 router.openshift...","head":[["meta",{"property":"og:url","content":"https://banrenshan.github.io/gudie/17-OpenShift%E8%B7%AF%E7%94%B1.html"}],["meta",{"property":"og:site_name","content":"心之所向，素履以往"}],["meta",{"property":"og:title","content":"OpenShift 路由"}],["meta",{"property":"og:description","content":"配置 超时设置 haproxy.router.openshift.io/timeout: 设定超时时间 cookie设置 haproxy.router.openshift.io/disable_cookies:是否禁用cookie router.openshift.io/cookie_name: 指定cookie的名称 router.openshift..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-24T08:19:31.000Z"}],["meta",{"property":"article:author","content":"banrenshan"}],["meta",{"property":"article:tag","content":"OpenShift"}],["meta",{"property":"article:published_time","content":"2024-04-20T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-24T08:19:31.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"OpenShift 路由\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-04-20T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-24T08:19:31.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"banrenshan\\",\\"url\\":\\"https://github.com/banrenshan\\"}]}"]]},"headers":[{"level":2,"title":"配置","slug":"配置","link":"#配置","children":[{"level":3,"title":"超时设置","slug":"超时设置","link":"#超时设置","children":[]},{"level":3,"title":"cookie设置","slug":"cookie设置","link":"#cookie设置","children":[]},{"level":3,"title":"连接限制","slug":"连接限制","link":"#连接限制","children":[]},{"level":3,"title":"ip限制","slug":"ip限制","link":"#ip限制","children":[]},{"level":3,"title":"其他设置","slug":"其他设置","link":"#其他设置","children":[]},{"level":3,"title":"路径重写","slug":"路径重写","link":"#路径重写","children":[]}]},{"level":2,"title":"安全路由","slug":"安全路由","link":"#安全路由","children":[]}],"git":{"createdTime":1713946771000,"updatedTime":1713946771000,"contributors":[{"name":"banrenshan","email":"CP_zhaozhiqiang@163.com","commits":1}]},"readingTime":{"minutes":1.98,"words":594},"filePathRelative":"gudie/17-OpenShift路由.md","localizedDate":"2024年4月20日","excerpt":"<h2>配置</h2>\\n<h3>超时设置</h3>\\n<p><code>haproxy.router.openshift.io/timeout</code>: 设定超时时间</p>\\n<h3>cookie设置</h3>\\n<p><code>haproxy.router.openshift.io/disable_cookies</code>:是否禁用cookie</p>\\n<p><code>router.openshift.io/cookie_name</code>: 指定cookie的名称</p>\\n<p><code>router.openshift.io/cookie-same-site</code>：数值是：</p>","autoDesc":true}');export{h as comp,u as data};
