<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.36" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://banrenshan.github.io/Spring/spring-%E5%AE%B9%E5%99%A8%E9%AB%98%E7%BA%A7.html"><meta property="og:site_name" content="å¿ƒä¹‹æ‰€å‘ï¼Œç´ å±¥ä»¥å¾€"><meta property="og:title" content="Spring å®¹å™¨é«˜çº§"><meta property="og:description" content="beanå®šä¹‰çš„é›†æˆ ä¸€ä¸ªbeanå®šä¹‰å¯ä»¥åŒ…å«å¾ˆå¤šé…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ„é€ å‡½æ•°å‚æ•°ï¼Œå±æ€§å€¼å’Œç‰¹å®šäºå®¹å™¨çš„ä¿¡æ¯ï¼Œä¾‹å¦‚åˆå§‹åŒ–æ–¹æ³•ï¼Œé™æ€å·¥å‚æ–¹æ³•åç§°ç­‰ç­‰ã€‚å­beanå®šä¹‰ä»çˆ¶å®šä¹‰ç»§æ‰¿é…ç½®æ•°æ®ã€‚ æ ¹æ®éœ€è¦ï¼Œå­å®šä¹‰å¯ä»¥è¦†ç›–ä¸€äº›å€¼æˆ–æ·»åŠ å…¶ä»–å€¼ã€‚ ä½¿ç”¨çˆ¶å­beanå®šä¹‰å¯ä»¥èŠ‚çœå¤§é‡çš„è¾“å…¥ã€‚ å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ç§æ¨¡æ¿å½¢å¼ã€‚ å­Beanå®šä¹‰ç”±ChildBeanDefinitionç±»è¡¨ç¤º..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-05-01T09:42:13.000Z"><meta property="article:author" content="banrenshan"><meta property="article:tag" content="Spring"><meta property="article:tag" content="å®¹å™¨"><meta property="article:published_time" content="2024-05-01T00:00:00.000Z"><meta property="article:modified_time" content="2024-05-01T09:42:13.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Spring å®¹å™¨é«˜çº§","image":[""],"datePublished":"2024-05-01T00:00:00.000Z","dateModified":"2024-05-01T09:42:13.000Z","author":[{"@type":"Person","name":"banrenshan","url":"https://github.com/banrenshan"}]}</script><title>Spring å®¹å™¨é«˜çº§ | å¿ƒä¹‹æ‰€å‘ï¼Œç´ å±¥ä»¥å¾€</title><meta name="description" content="beanå®šä¹‰çš„é›†æˆ ä¸€ä¸ªbeanå®šä¹‰å¯ä»¥åŒ…å«å¾ˆå¤šé…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ„é€ å‡½æ•°å‚æ•°ï¼Œå±æ€§å€¼å’Œç‰¹å®šäºå®¹å™¨çš„ä¿¡æ¯ï¼Œä¾‹å¦‚åˆå§‹åŒ–æ–¹æ³•ï¼Œé™æ€å·¥å‚æ–¹æ³•åç§°ç­‰ç­‰ã€‚å­beanå®šä¹‰ä»çˆ¶å®šä¹‰ç»§æ‰¿é…ç½®æ•°æ®ã€‚ æ ¹æ®éœ€è¦ï¼Œå­å®šä¹‰å¯ä»¥è¦†ç›–ä¸€äº›å€¼æˆ–æ·»åŠ å…¶ä»–å€¼ã€‚ ä½¿ç”¨çˆ¶å­beanå®šä¹‰å¯ä»¥èŠ‚çœå¤§é‡çš„è¾“å…¥ã€‚ å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ç§æ¨¡æ¿å½¢å¼ã€‚ å­Beanå®šä¹‰ç”±ChildBeanDefinitionç±»è¡¨ç¤º...">
    <link rel="preload" href="/assets/style-wL6mR3b5.css" as="style"><link rel="stylesheet" href="/assets/style-wL6mR3b5.css">
    <link rel="modulepreload" href="/assets/app-Brzzz3sI.js"><link rel="modulepreload" href="/assets/spring-å®¹å™¨é«˜çº§.html-BIJHmz3r.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-Dinhrg_m.js" as="script"><link rel="prefetch" href="/assets/go-Context.html-B9y274l-.js" as="script"><link rel="prefetch" href="/assets/goå‘½ä»¤è¡Œ.html-CBkl9V82.js" as="script"><link rel="prefetch" href="/assets/goåŸºç¡€.html-Dhe5z5iV.js" as="script"><link rel="prefetch" href="/assets/goå¹¶å‘.html-2pdsFREW.js" as="script"><link rel="prefetch" href="/assets/goæ ‡å‡†åº“-json.html-DX9g76i_.js" as="script"><link rel="prefetch" href="/assets/goæ ‡å‡†åº“-time.html-Dnr_nGkQ.js" as="script"><link rel="prefetch" href="/assets/goæ¨¡å—.html-CqUvC54G.js" as="script"><link rel="prefetch" href="/assets/goæ³›å‹.html-CtnEqPl9.js" as="script"><link rel="prefetch" href="/assets/goç¯å¢ƒ.html-Cfhqt8Nd.js" as="script"><link rel="prefetch" href="/assets/goé¢å‘å¯¹è±¡.html-YRQxSVki.js" as="script"><link rel="prefetch" href="/assets/k8s-client-go.html-DenJcaiu.js" as="script"><link rel="prefetch" href="/assets/è™šæ‹Ÿç¯å¢ƒ.html-DdNTYG6D.js" as="script"><link rel="prefetch" href="/assets/ewsé‚®ç®±.html-CyQ_yAhL.js" as="script"><link rel="prefetch" href="/assets/gradle.html-DBxnGzfo.js" as="script"><link rel="prefetch" href="/assets/spring-resource.html-DJy3Qh1h.js" as="script"><link rel="prefetch" href="/assets/spring-å®¹å™¨åŸºç¡€.html-FdaYNYBW.js" as="script"><link rel="prefetch" href="/assets/spring-ç±»å‹è½¬æ¢.html-C8v1iAs-.js" as="script"><link rel="prefetch" href="/assets/spring-è¡¨è¾¾å¼.html-hdFlsVek.js" as="script"><link rel="prefetch" href="/assets/springäº‹åŠ¡.html-pVZA4H0g.js" as="script"><link rel="prefetch" href="/assets/æ ¡éªŒæ³¨è§£.html-DbdGZYOh.js" as="script"><link rel="prefetch" href="/assets/helm.html-B4lErKcF.js" as="script"><link rel="prefetch" href="/assets/istio.html-D160nfaa.js" as="script"><link rel="prefetch" href="/assets/minikube.html-CbGNEAsJ.js" as="script"><link rel="prefetch" href="/assets/00-é‡‘èçŸ¥è¯†.html-DeFNATDO.js" as="script"><link rel="prefetch" href="/assets/01-flyway.html-DwqpjRP4.js" as="script"><link rel="prefetch" href="/assets/02-jsonassert.html-D21e1m5E.js" as="script"><link rel="prefetch" href="/assets/03-Junit5.html-BDBFUK1y.js" as="script"><link rel="prefetch" href="/assets/04-mocktio.html-BAzCT5IH.js" as="script"><link rel="prefetch" href="/assets/05-jsonpath.html-CWASClsf.js" as="script"><link rel="prefetch" href="/assets/06-spring-cloud-common.html-DTTraJW6.js" as="script"><link rel="prefetch" href="/assets/07-oracle.html-BU2mygyY.js" as="script"><link rel="prefetch" href="/assets/08-å¿«æ·é”®.html-Cfi_FVzA.js" as="script"><link rel="prefetch" href="/assets/09-ç¼–ç¨‹è§„èŒƒ.html-Cvc67TlT.js" as="script"><link rel="prefetch" href="/assets/10-å¤šçº¿ç¨‹.html-DtxX_Z-r.js" as="script"><link rel="prefetch" href="/assets/11-åˆ†å¸ƒå¼äº‹åŠ¡.html-B7kr4vAT.js" as="script"><link rel="prefetch" href="/assets/12-autosys.html-BJ0TlSgO.js" as="script"><link rel="prefetch" href="/assets/13-spring-retryå®˜æ–¹æŒ‡å—.html-Bu0gm_nJ.js" as="script"><link rel="prefetch" href="/assets/14-spring-integration.html-Pq5Vkpri.js" as="script"><link rel="prefetch" href="/assets/15-Hibernate.html-DlmkLCrJ.js" as="script"><link rel="prefetch" href="/assets/16-å¼€å‘ç¯å¢ƒ.html-rpGP80tq.js" as="script"><link rel="prefetch" href="/assets/17-OpenShiftè·¯ç”±.html-zD7l51Zv.js" as="script"><link rel="prefetch" href="/assets/mysqlä¼˜åŒ–.html-BWZJck4j.js" as="script"><link rel="prefetch" href="/assets/mysqlç´¢å¼•.html-Dp2oyuPO.js" as="script"><link rel="prefetch" href="/assets/mysqlè¿ç»´å’Œç›‘æ§.html--3dxmT23.js" as="script"><link rel="prefetch" href="/assets/mysqlé«˜çº§.html-CPik6PyE.js" as="script"><link rel="prefetch" href="/assets/spring-data-jpa.html-DLUiglUg.js" as="script"><link rel="prefetch" href="/assets/spring-data-redis.html-BnXYc559.js" as="script"><link rel="prefetch" href="/assets/AirFlow.html-DFSFXqUB.js" as="script"><link rel="prefetch" href="/assets/ERå›¾.html-Dtg06qDp.js" as="script"><link rel="prefetch" href="/assets/Resilience4j.html-CPSYgC-E.js" as="script"><link rel="prefetch" href="/assets/filebeat.html-V3n59LqF.js" as="script"><link rel="prefetch" href="/assets/goè¯­è¨€.html-BLFUZhuj.js" as="script"><link rel="prefetch" href="/assets/gradle-basic.html-CWzpDfp7.js" as="script"><link rel="prefetch" href="/assets/gradle-depedency.html-PzrtMNnp.js" as="script"><link rel="prefetch" href="/assets/gradle-java.html-Bsxp6hjN.js" as="script"><link rel="prefetch" href="/assets/grafana-1.html-Bdul0kun.js" as="script"><link rel="prefetch" href="/assets/grafana.html-DWECnLLE.js" as="script"><link rel="prefetch" href="/assets/javaæ¥å£.html-BIT41e-e.js" as="script"><link rel="prefetch" href="/assets/javaæ—¥æœŸ.html-brlDnyrc.js" as="script"><link rel="prefetch" href="/assets/javaæ³¨è§£.html-C7Np5uh_.js" as="script"><link rel="prefetch" href="/assets/loki.html-BQEgNYfj.js" as="script"><link rel="prefetch" href="/assets/nginx.html-CBBV20Lv.js" as="script"><link rel="prefetch" href="/assets/remoteConnection.html-C7p4sv1o.js" as="script"><link rel="prefetch" href="/assets/zero-copy.html-CsS6PNZb.js" as="script"><link rel="prefetch" href="/assets/å¤šçº¿ç¨‹-Exchanger.html-KEWkLWwQ.js" as="script"><link rel="prefetch" href="/assets/Vscode.html-D95lJEzK.js" as="script"><link rel="prefetch" href="/assets/ä»£ç†.html-CftJCGF3.js" as="script"><link rel="prefetch" href="/assets/404.html-DJvsvHv3.js" as="script"><link rel="prefetch" href="/assets/index.html-dlFkNtQh.js" as="script"><link rel="prefetch" href="/assets/index.html-esL2x_tP.js" as="script"><link rel="prefetch" href="/assets/index.html-gP4rIQ5C.js" as="script"><link rel="prefetch" href="/assets/index.html-DJz4LLY2.js" as="script"><link rel="prefetch" href="/assets/index.html-B42KFFcF.js" as="script"><link rel="prefetch" href="/assets/index.html-DyW7deL4.js" as="script"><link rel="prefetch" href="/assets/index.html-D8a-rO9S.js" as="script"><link rel="prefetch" href="/assets/index.html-6WPFi9VW.js" as="script"><link rel="prefetch" href="/assets/index.html-Dx-xy0pN.js" as="script"><link rel="prefetch" href="/assets/index.html--JcF2rfJ.js" as="script"><link rel="prefetch" href="/assets/index.html-DtT6rAfM.js" as="script"><link rel="prefetch" href="/assets/index.html-ChmW0nSO.js" as="script"><link rel="prefetch" href="/assets/index.html-loUlgZ--.js" as="script"><link rel="prefetch" href="/assets/index.html-CmukK9da.js" as="script"><link rel="prefetch" href="/assets/index.html-Db_ZHdgv.js" as="script"><link rel="prefetch" href="/assets/index.html-CTQPr8dV.js" as="script"><link rel="prefetch" href="/assets/index.html-ChmW0nSO.js" as="script"><link rel="prefetch" href="/assets/index.html-b1DhYuwz.js" as="script"><link rel="prefetch" href="/assets/index.html-DMKyMfY-.js" as="script"><link rel="prefetch" href="/assets/index.html-CCqTcQyL.js" as="script"><link rel="prefetch" href="/assets/index.html-DRrlpmMy.js" as="script"><link rel="prefetch" href="/assets/index.html--k1J9biO.js" as="script"><link rel="prefetch" href="/assets/index.html-hgggnEPA.js" as="script"><link rel="prefetch" href="/assets/index.html-J7gntB6K.js" as="script"><link rel="prefetch" href="/assets/index.html-loUlgZ--.js" as="script"><link rel="prefetch" href="/assets/index.html-D4YuB0dI.js" as="script"><link rel="prefetch" href="/assets/index.html-DlD4BYA6.js" as="script"><link rel="prefetch" href="/assets/index.html-Dx-xy0pN.js" as="script"><link rel="prefetch" href="/assets/index.html-Dyp2Glwt.js" as="script"><link rel="prefetch" href="/assets/index.html-DVCFTVaZ.js" as="script"><link rel="prefetch" href="/assets/index.html-rYUCBV_X.js" as="script"><link rel="prefetch" href="/assets/index.html-DjVn7ypW.js" as="script"><link rel="prefetch" href="/assets/index.html-CyvG6Zt0.js" as="script"><link rel="prefetch" href="/assets/index.html-4330Sk5c.js" as="script"><link rel="prefetch" href="/assets/index.html-Bcs72AKU.js" as="script"><link rel="prefetch" href="/assets/index.html-Brx6N4M1.js" as="script"><link rel="prefetch" href="/assets/index.html-CMO2WPpa.js" as="script"><link rel="prefetch" href="/assets/index.html-BusLHqZV.js" as="script"><link rel="prefetch" href="/assets/index.html-DnNw564h.js" as="script"><link rel="prefetch" href="/assets/index.html-C0fYdOoe.js" as="script"><link rel="prefetch" href="/assets/index.html-BCgsA13P.js" as="script"><link rel="prefetch" href="/assets/index.html-DpaaCnf5.js" as="script"><link rel="prefetch" href="/assets/index.html-1GpCJWFC.js" as="script"><link rel="prefetch" href="/assets/index.html-C3xRuFlM.js" as="script"><link rel="prefetch" href="/assets/index.html-DiI2Oajp.js" as="script"><link rel="prefetch" href="/assets/index.html-Dp8I4P7_.js" as="script"><link rel="prefetch" href="/assets/index.html-C2DLrje6.js" as="script"><link rel="prefetch" href="/assets/index.html-yA4XFgZ7.js" as="script"><link rel="prefetch" href="/assets/index.html-BtftND-t.js" as="script"><link rel="prefetch" href="/assets/index.html-2bXD5u9n.js" as="script"><link rel="prefetch" href="/assets/index.html-CkLAHvCn.js" as="script"><link rel="prefetch" href="/assets/index.html-DI-Xsb6D.js" as="script"><link rel="prefetch" href="/assets/index.html-Bfx-5tpZ.js" as="script"><link rel="prefetch" href="/assets/index.html-9ogZgMJf.js" as="script"><link rel="prefetch" href="/assets/index.html-BhaDTUj9.js" as="script"><link rel="prefetch" href="/assets/index.html-DduD1OZ8.js" as="script"><link rel="prefetch" href="/assets/index.html-DKo99vaw.js" as="script"><link rel="prefetch" href="/assets/index.html-C05dsm4y.js" as="script"><link rel="prefetch" href="/assets/index.html-BPKJoHfy.js" as="script"><link rel="prefetch" href="/assets/index.html-lMdoztGy.js" as="script"><link rel="prefetch" href="/assets/index.html-DvMgqPI7.js" as="script"><link rel="prefetch" href="/assets/index.html-CxdHwVRk.js" as="script"><link rel="prefetch" href="/assets/index.html-D8MyKXNy.js" as="script"><link rel="prefetch" href="/assets/index.html-B1B8-RbD.js" as="script"><link rel="prefetch" href="/assets/index.html-CxMsPdKB.js" as="script"><link rel="prefetch" href="/assets/index.html-ByNRG9Hf.js" as="script"><link rel="prefetch" href="/assets/index.html-WEmpua9_.js" as="script"><link rel="prefetch" href="/assets/index.html-pOZrTPvD.js" as="script"><link rel="prefetch" href="/assets/index.html-ByKBak0a.js" as="script"><link rel="prefetch" href="/assets/index.html-5l395_fX.js" as="script"><link rel="prefetch" href="/assets/index.html-Brx6N4M1.js" as="script"><link rel="prefetch" href="/assets/index.html-CKimLbNe.js" as="script"><link rel="prefetch" href="/assets/index.html-_R6M7tB8.js" as="script"><link rel="prefetch" href="/assets/index.html-xz1O6DKj.js" as="script"><link rel="prefetch" href="/assets/index.html-C6-9qgjY.js" as="script"><link rel="prefetch" href="/assets/index.html-CvV3tPrA.js" as="script"><link rel="prefetch" href="/assets/index.html-BJW5qfyQ.js" as="script"><link rel="prefetch" href="/assets/index.html-DOEskld8.js" as="script"><link rel="prefetch" href="/assets/index.html-CjvMhBLW.js" as="script"><link rel="prefetch" href="/assets/index.html-O3ekEhBq.js" as="script"><link rel="prefetch" href="/assets/index.html-zttt1MoW.js" as="script"><link rel="prefetch" href="/assets/index.html-DHd_Qtlh.js" as="script"><link rel="prefetch" href="/assets/index.html-DVVMQD8G.js" as="script"><link rel="prefetch" href="/assets/index.html-B36P80aI.js" as="script"><link rel="prefetch" href="/assets/index.html-C7Un48U-.js" as="script"><link rel="prefetch" href="/assets/index.html-JI6OVoJ1.js" as="script"><link rel="prefetch" href="/assets/index.html-DF6TXU_s.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-SzV8tJDW.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">å¿ƒä¹‹æ‰€å‘ï¼Œç´ å±¥ä»¥å¾€</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/" aria-label="ä¸»é¡µ"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/post/" aria-label="åšæ–‡"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>åšæ–‡<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/timeline/" aria-label="äº‹ä»¶è½´"><span class="font-icon icon fa-fw fa-sm fas fa-timeline" style=""></span>äº‹ä»¶è½´<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/tag/" aria-label="æ ‡ç­¾"><span class="font-icon icon fa-fw fa-sm fas fa-tags" style=""></span>æ ‡ç­¾<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/category/" aria-label="åˆ†ç±»"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>åˆ†ç±»<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/banrenshan/banrenshan.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><a class="route-link nav-link vp-sidebar-title" href="/gudie/" aria-label="æŒ‡å—"><!---->æŒ‡å—<!----></a><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/12-autosys.html" aria-label="AutoSys"><!---->AutoSys<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/01-flyway.html" aria-label="flywayæŒ‡å—"><!---->flywayæŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/15-Hibernate.html" aria-label="Hibernate æŒ‡å—"><!---->Hibernate æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/02-jsonassert.html" aria-label="JSONassertæŒ‡å—"><!---->JSONassertæŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/05-jsonpath.html" aria-label="JsonPath æŒ‡å—"><!---->JsonPath æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/03-Junit5.html" aria-label="JUnit5æŒ‡å—"><!---->JUnit5æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/04-mocktio.html" aria-label="mocktioæŒ‡å—"><!---->mocktioæŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/17-OpenShift%E8%B7%AF%E7%94%B1.html" aria-label="OpenShift è·¯ç”±"><!---->OpenShift è·¯ç”±<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/07-oracle.html" aria-label="OracleåŸºç¡€ æŒ‡å—"><!---->OracleåŸºç¡€ æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/spring-data-redis.html" aria-label="redisæ”¯æŒ"><!---->redisæ”¯æŒ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/spring-data-jpa.html" aria-label="Spring Data Repositories"><!---->Spring Data Repositories<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/14-spring-integration.html" aria-label="Spring Integration æŒ‡å—"><!---->Spring Integration æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/13-spring-retry%E5%AE%98%E6%96%B9%E6%8C%87%E5%8D%97.html" aria-label="Spring Retry æŒ‡å—"><!---->Spring Retry æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/06-spring-cloud-common.html" aria-label="Spring-CLoud-Common"><!---->Spring-CLoud-Common<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/mysql%E4%BC%98%E5%8C%96.html" aria-label="sqlè¯­å¥ä¸Šçš„ä¼˜åŒ–"><!---->sqlè¯­å¥ä¸Šçš„ä¼˜åŒ–<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/11-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html" aria-label="åˆ†å¸ƒå¼äº‹åŠ¡"><!---->åˆ†å¸ƒå¼äº‹åŠ¡<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/10-%E5%A4%9A%E7%BA%BF%E7%A8%8B.html" aria-label="å¤šçº¿ç¨‹"><!---->å¤šçº¿ç¨‹<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/mysql%E9%AB%98%E7%BA%A7.html" aria-label="å®‰è£…"><!---->å®‰è£…<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/16-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html" aria-label="å¼€å‘ç¯å¢ƒ"><!---->å¼€å‘ç¯å¢ƒ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/08-%E5%BF%AB%E6%8D%B7%E9%94%AE.html" aria-label="å¿«æ·é”®"><!---->å¿«æ·é”®<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/mysql%E7%B4%A2%E5%BC%95.html" aria-label="æ¦‚è¿°"><!---->æ¦‚è¿°<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/mysql%E8%BF%90%E7%BB%B4%E5%92%8C%E7%9B%91%E6%8E%A7.html" aria-label="ç›‘æ§"><!---->ç›‘æ§<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/09-%E7%BC%96%E7%A8%8B%E8%A7%84%E8%8C%83.html" aria-label="ç¼–ç¨‹è§„èŒƒ"><!---->ç¼–ç¨‹è§„èŒƒ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/gudie/00-%E9%87%91%E8%9E%8D%E7%9F%A5%E8%AF%86.html" aria-label="é‡‘èçŸ¥è¯†"><!---->é‡‘èçŸ¥è¯†<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">æ–‡ç« </span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/AirFlow.html" aria-label="AirFlow"><!---->AirFlow<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/ER%E5%9B%BE.html" aria-label="ERå›¾"><!---->ERå›¾<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/filebeat.html" aria-label="filebeat"><!---->filebeat<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/go%E8%AF%AD%E8%A8%80.html" aria-label="goåŸºç¡€è¯­æ³•"><!---->goåŸºç¡€è¯­æ³•<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/gradle-depedency.html" aria-label="gradle ä¾èµ–è§£æ"><!---->gradle ä¾èµ–è§£æ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/gradle-basic.html" aria-label="gradle-basic"><!---->gradle-basic<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/gradle-java.html" aria-label="gradle-java"><!---->gradle-java<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/grafana-1.html" aria-label="grafana1"><!---->grafana1<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/grafana.html" aria-label="grafana2"><!---->grafana2<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/java%E6%8E%A5%E5%8F%A3.html" aria-label="Java æ¥å£"><!---->Java æ¥å£<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/java%E6%97%A5%E6%9C%9F.html" aria-label="Java æ—¥æœŸ API"><!---->Java æ—¥æœŸ API<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/java%E6%B3%A8%E8%A7%A3.html" aria-label="Java æ³¨è§£"><!---->Java æ³¨è§£<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/loki.html" aria-label="loki"><!---->loki<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/nginx.html" aria-label="nginx"><!---->nginx<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/Resilience4j.html" aria-label="Resilience4j"><!---->Resilience4j<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/zero-copy.html" aria-label="zero-copy"><!---->zero-copy<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/%E5%A4%9A%E7%BA%BF%E7%A8%8B-Exchanger.html" aria-label="å¤šçº¿ç¨‹-Exchanger"><!---->å¤šçº¿ç¨‹-Exchanger<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/post/remoteConnection.html" aria-label="è¿œç¨‹ç®¡ç†åè®®"><!---->è¿œç¨‹ç®¡ç†åè®®<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Go</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go-Context.html" aria-label="Go Context"><!---->Go Context<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E6%A0%87%E5%87%86%E5%BA%93-json.html" aria-label="Go Json"><!---->Go Json<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E6%A0%87%E5%87%86%E5%BA%93-time.html" aria-label="Go Time"><!---->Go Time<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E5%91%BD%E4%BB%A4%E8%A1%8C.html" aria-label="Go å‘½ä»¤è¡Œ"><!---->Go å‘½ä»¤è¡Œ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E5%9F%BA%E7%A1%80.html" aria-label="Go åŸºç¡€"><!---->Go åŸºç¡€<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E5%B9%B6%E5%8F%91.html" aria-label="Go å¹¶å‘"><!---->Go å¹¶å‘<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E6%A8%A1%E5%9D%97.html" aria-label="Go æ¨¡å—"><!---->Go æ¨¡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.html" aria-label="Go é¢å‘å¯¹è±¡"><!---->Go é¢å‘å¯¹è±¡<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E6%B3%9B%E5%9E%8B.html" aria-label="Goæ³›å‹"><!---->Goæ³›å‹<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/go%E7%8E%AF%E5%A2%83.html" aria-label="Goç¯å¢ƒ"><!---->Goç¯å¢ƒ<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Go/k8s-client-go.html" aria-label="Kubernate Go"><!---->Kubernate Go<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">äº‘æŠ€æœ¯</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/cloud/helm.html" aria-label="Helm æŒ‡å—"><!---->Helm æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/cloud/istio.html" aria-label="Istio æŒ‡å—"><!---->Istio æŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/cloud/minikube.html" aria-label="minikube æŒ‡å—"><!---->minikube æŒ‡å—<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Python</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Python/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83.html" aria-label="è™šæ‹Ÿç¯å¢ƒ"><!---->è™šæ‹Ÿç¯å¢ƒ<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Tools</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tool/Vscode.html" aria-label="Vscode"><!---->Vscode<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tool/%E4%BB%A3%E7%90%86.html" aria-label="å„ç§ä»£ç†è®¾ç½®"><!---->å„ç§ä»£ç†è®¾ç½®<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">Spring</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/ews%E9%82%AE%E7%AE%B1.html" aria-label="ews é‚®ç®±API"><!---->ews é‚®ç®±API<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/gradle.html" aria-label="GradleæŒ‡å—"><!---->GradleæŒ‡å—<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/%E6%A0%A1%E9%AA%8C%E6%B3%A8%E8%A7%A3.html" aria-label="Spring Validation"><!---->Spring Validation<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/spring%E4%BA%8B%E5%8A%A1.html" aria-label="Spring äº‹åŠ¡"><!---->Spring äº‹åŠ¡<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/spring-%E5%AE%B9%E5%99%A8%E5%9F%BA%E7%A1%80.html" aria-label="Spring å®¹å™¨åŸºç¡€"><!---->Spring å®¹å™¨åŸºç¡€<!----></a></li><li><a class="route-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/Spring/spring-%E5%AE%B9%E5%99%A8%E9%AB%98%E7%BA%A7.html" aria-label="Spring å®¹å™¨é«˜çº§"><!---->Spring å®¹å™¨é«˜çº§<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/spring-%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2.html" aria-label="Spring ç±»å‹è½¬æ¢"><!---->Spring ç±»å‹è½¬æ¢<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/spring-%E8%A1%A8%E8%BE%BE%E5%BC%8F.html" aria-label="Spring è¡¨è¾¾å¼"><!---->Spring è¡¨è¾¾å¼<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/Spring/spring-resource.html" aria-label="Spring èµ„æºå¤„ç†"><!---->Spring èµ„æºå¤„ç†<!----></a></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Spring å®¹å™¨é«˜çº§</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/banrenshan" target="_blank" rel="noopener noreferrer">banrenshan</a></span><span property="author" content="banrenshan"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-05-01T00:00:00.000Z"></span><span class="page-pageview-info" aria-label="è®¿é—®é‡ğŸ”¢" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span id="ArtalkPV" class="vp-pageview waline-pageview-count" data-path="/Spring/spring-%E5%AE%B9%E5%99%A8%E9%AB%98%E7%BA%A7.html" data-page-key="/Spring/spring-%E5%AE%B9%E5%99%A8%E9%AB%98%E7%BA%A7.html">...</span></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 61 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT61M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#beanå®šä¹‰çš„é›†æˆ">beanå®šä¹‰çš„é›†æˆ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å®¹å™¨æ‰©å±•ç‚¹">å®¹å™¨æ‰©å±•ç‚¹</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨beanpostprocessorå®šåˆ¶bean">ä½¿ç”¨BeanPostProcessorå®šåˆ¶bean</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨beanfactorypostprocessorå®šåˆ¶é…ç½®å…ƒæ•°æ®">ä½¿ç”¨BeanFactoryPostProcessorå®šåˆ¶é…ç½®å…ƒæ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨factorybeanå®šåˆ¶å®ä¾‹åŒ–é€»è¾‘">ä½¿ç”¨FactoryBeanå®šåˆ¶å®ä¾‹åŒ–é€»è¾‘</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#åŸºäºæ³¨è§£çš„å®¹å™¨é…ç½®">åŸºäºæ³¨è§£çš„å®¹å™¨é…ç½®</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#required">Required</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#autowired">Autowired</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#primary">Primary</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#qualifiers">Qualifiers</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨æ³›å‹ä½œä¸ºè‡ªåŠ¨è£…é…é™å®šç¬¦">ä½¿ç”¨æ³›å‹ä½œä¸ºè‡ªåŠ¨è£…é…é™å®šç¬¦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨customautowireconfigurer">ä½¿ç”¨CustomAutowireConfigurer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-resourceæ³¨è§£">ä½¿ç”¨@Resourceæ³¨è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-postconstructå’Œ-predestroy">ä½¿ç”¨@PostConstructå’Œ@PreDestroy</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ç±»è·¯å¾„æ‰«æå’Œç»„ä»¶ç®¡ç†">ç±»è·¯å¾„æ‰«æå’Œç»„ä»¶ç®¡ç†</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#component">@Component</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨å…ƒæ³¨è§£å’Œæ³¨è§£ç»„åˆ">ä½¿ç”¨å…ƒæ³¨è§£å’Œæ³¨è§£ç»„åˆ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è‡ªåŠ¨æ£€æµ‹ç±»å¹¶æ³¨å†Œæˆbean">è‡ªåŠ¨æ£€æµ‹ç±»å¹¶æ³¨å†ŒæˆBean</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨è¿‡æ»¤å™¨è‡ªå®šä¹‰æ‰«æ">ä½¿ç”¨è¿‡æ»¤å™¨è‡ªå®šä¹‰æ‰«æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åœ¨ç»„ä»¶ä¸­å®šä¹‰beanå…ƒæ•°æ®">åœ¨ç»„ä»¶ä¸­å®šä¹‰Beanå…ƒæ•°æ®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¢«æ‰«æåˆ°çš„beançš„å‘½åè§„èŒƒ">è¢«æ‰«æåˆ°çš„Beançš„å‘½åè§„èŒƒ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»™è‡ªåŠ¨æ‰«æçš„æ³¨è§£æŒ‡å®šscope">ç»™è‡ªåŠ¨æ‰«æçš„æ³¨è§£æŒ‡å®šscope</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»™è‡ªåŠ¨æ‰«æçš„beanæä¾›qualifier">ç»™è‡ªåŠ¨æ‰«æçš„beanæä¾›Qualifier</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»„ä»¶ç´¢å¼•">ç»„ä»¶ç´¢å¼•</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ä½¿ç”¨jsr-330æ ‡å‡†æ³¨è§£">ä½¿ç”¨JSR 330æ ‡å‡†æ³¨è§£</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-injectå’Œ-namedè¿›è¡Œä¾èµ–æ³¨å…¥">ä½¿ç”¨@Injectå’Œ@Namedè¿›è¡Œä¾èµ–æ³¨å…¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#named-and-managedbean">@Named and @ManagedBean:</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#jsr-330æ³¨è§£çš„å±€é™æ€§">JSR-330æ³¨è§£çš„å±€é™æ€§</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#åŸºäºjavaä»£ç çš„å®¹å™¨é…ç½®">åŸºäºjavaä»£ç çš„å®¹å™¨é…ç½®</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#beanå’Œ-configuration">@Beanå’Œ@Configuration</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨annotationconfigapplicationcontextå®ä¾‹åŒ–å®¹å™¨">ä½¿ç”¨AnnotationConfigApplicationContextå®ä¾‹åŒ–å®¹å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-beanæ³¨è§£">ä½¿ç”¨@Beanæ³¨è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-configurationæ³¨è§£">ä½¿ç”¨@Configurationæ³¨è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç»„åˆä½¿ç”¨">ç»„åˆä½¿ç”¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ç¯å¢ƒæŠ½è±¡">ç¯å¢ƒæŠ½è±¡</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-profile">ä½¿ç”¨@Profile</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#propertysource-æŠ½è±¡">PropertySource æŠ½è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨-propertysource">ä½¿ç”¨@PropertySource</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#æ³¨å†Œloadtimeweaver">æ³¨å†ŒLoadTimeWeaver</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#applicationcontextçš„é™„åŠ åŠŸèƒ½">ApplicationContextçš„é™„åŠ åŠŸèƒ½</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨messagesourceè¿›è¡Œå›½é™…åŒ–">ä½¿ç”¨MessageSourceè¿›è¡Œå›½é™…åŒ–</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ ‡å‡†å’Œè‡ªå®šä¹‰äº‹ä»¶">æ ‡å‡†å’Œè‡ªå®šä¹‰äº‹ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–¹ä¾¿åœ°è®¿é—®ä½çº§èµ„æº">æ–¹ä¾¿åœ°è®¿é—®ä½çº§èµ„æº</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ–¹ä¾¿çš„webåº”ç”¨ç¨‹åºapplicationcontextå®ä¾‹åŒ–">æ–¹ä¾¿çš„Webåº”ç”¨ç¨‹åºApplicationContextå®ä¾‹åŒ–</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å°†spring-applicationcontextéƒ¨ç½²ä¸ºjava-ee-raræ–‡ä»¶">å°†Spring ApplicationContextéƒ¨ç½²ä¸ºJava EE RARæ–‡ä»¶</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#beanfactory">BeanFactory</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#beanfactory-or-applicationcontext">BeanFactory or ApplicationContext?</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h2 id="beanå®šä¹‰çš„é›†æˆ" tabindex="-1"><a class="header-anchor" href="#beanå®šä¹‰çš„é›†æˆ"><span>beanå®šä¹‰çš„é›†æˆ</span></a></h2><p>ä¸€ä¸ªbeanå®šä¹‰å¯ä»¥åŒ…å«å¾ˆå¤šé…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ„é€ å‡½æ•°å‚æ•°ï¼Œå±æ€§å€¼å’Œç‰¹å®šäºå®¹å™¨çš„ä¿¡æ¯ï¼Œä¾‹å¦‚åˆå§‹åŒ–æ–¹æ³•ï¼Œé™æ€å·¥å‚æ–¹æ³•åç§°ç­‰ç­‰ã€‚å­beanå®šä¹‰ä»çˆ¶å®šä¹‰ç»§æ‰¿é…ç½®æ•°æ®ã€‚ æ ¹æ®éœ€è¦ï¼Œå­å®šä¹‰å¯ä»¥è¦†ç›–ä¸€äº›å€¼æˆ–æ·»åŠ å…¶ä»–å€¼ã€‚ ä½¿ç”¨çˆ¶å­beanå®šä¹‰å¯ä»¥èŠ‚çœå¤§é‡çš„è¾“å…¥ã€‚ å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ç§æ¨¡æ¿å½¢å¼ã€‚</p><p>å­Beanå®šä¹‰ç”±<code>ChildBeanDefinition</code>ç±»è¡¨ç¤ºã€‚åœ¨ä½¿ç”¨åŸºäºXMLçš„é…ç½®å…ƒæ•°æ®æ—¶ï¼Œé€šè¿‡ä½¿ç”¨parentå±æ€§æŒ‡å®šçˆ¶beanä½œä¸ºæ­¤å±æ€§çš„å€¼ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inheritedTestBean<span class="token punctuation">&quot;</span></span> <span class="token attr-name">abstract</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.beans.TestBean<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>parent<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inheritsWithDifferentClass<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.beans.DerivedTestBean<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">parent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inheritedTestBean<span class="token punctuation">&quot;</span></span> <span class="token attr-name">init-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>initialize<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>override<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- the age property value of 1 will be inherited from parent --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™å­beanå®šä¹‰ä½¿ç”¨çˆ¶å®šä¹‰ä¸­çš„beanç±»ï¼Œä½†ä¹Ÿå¯ä»¥è¦†ç›–å®ƒã€‚ åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œå­Beanç±»å¿…é¡»ä¸çˆ¶ç±»å…¼å®¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¿…é¡»æ¥å—çˆ¶ç±»çš„å±æ€§å€¼ã€‚</p><p>å­beanå®šä¹‰ç»§æ‰¿äº†çˆ¶çº§çš„èŒƒå›´ï¼Œæ„é€ å‡½æ•°å‚æ•°å€¼ï¼Œå±æ€§å€¼å’Œæ–¹æ³•é‡å†™ï¼Œå¹¶ä¸”å¯ä»¥æ·»åŠ æ–°å€¼ã€‚ æ‚¨æŒ‡å®šçš„ä»»ä½•èŒƒå›´ï¼Œåˆå§‹åŒ–æ–¹æ³•ï¼Œé”€æ¯æ–¹æ³•å’Œ/æˆ–é™æ€å·¥å‚æ–¹æ³•è®¾ç½®éƒ½å°†è¦†ç›–ç›¸åº”çš„çˆ¶è®¾ç½®ã€‚å…¶ä½™è®¾ç½®å§‹ç»ˆä»å­å®šä¹‰ä¸­è·å–ï¼šä¾èµ–ï¼Œè‡ªåŠ¨è£…é…æ¨¡å¼ï¼Œä¾èµ–å…³ç³»æ£€æŸ¥ï¼Œå•ä¾‹ï¼Œå»¶è¿Ÿåˆå§‹åŒ–ã€‚</p><p>å‰é¢çš„ç¤ºä¾‹é€šè¿‡ä½¿ç”¨abstractå±æ€§å°†çˆ¶beanå®šä¹‰æ˜¾å¼æ ‡è®°ä¸ºæŠ½è±¡ã€‚ å¦‚æœçˆ¶å®šä¹‰æ²¡æœ‰æŒ‡å®šç±»ï¼Œåˆ™éœ€è¦å°†çˆ¶ç±»å®šä¹‰æ˜¾å¼æ ‡è®°ä¸ºæŠ½è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inheritedTestBeanWithoutClass<span class="token punctuation">&quot;</span></span> <span class="token attr-name">abstract</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>parent<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inheritsWithClass<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.beans.DerivedTestBean<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">parent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inheritedTestBeanWithoutClass<span class="token punctuation">&quot;</span></span> <span class="token attr-name">init-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>initialize<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>override<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- age will inherit the value of 1 from the parent bean definition--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çˆ¶beanä¸èƒ½è‡ªè¡Œå®ä¾‹åŒ–ï¼Œå› ä¸ºå®ƒæ˜¯ä¸å®Œæ•´çš„ï¼Œå¹¶ä¸”å®ƒä¹Ÿæ˜ç¡®æ ‡è®°ä¸ºæŠ½è±¡ã€‚å½“å®šä¹‰åƒè¿™æ ·æŠ½è±¡æ—¶ï¼Œå®ƒåªèƒ½ç”¨ä½œçº¯æ¨¡æ¿beanå®šä¹‰ï¼Œä½œä¸ºå­å®šä¹‰çš„çˆ¶å®šä¹‰ã€‚è¯•å›¾å•ç‹¬ä½¿ç”¨è¿™æ ·ä¸€ä¸ªæŠ½è±¡çš„çˆ¶beanï¼Œé€šè¿‡å°†å…¶ç§°ä¸ºå¦ä¸€ä¸ªbeançš„<code>ref</code>å±æ€§æˆ–ä½¿ç”¨çˆ¶bean idæ‰§è¡Œæ˜¾å¼çš„<code>getBean</code>è°ƒç”¨è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚åŒæ ·ï¼Œå®¹å™¨çš„å†…éƒ¨<code>preInstantiateSingletons</code>æ–¹æ³•ä¹Ÿä¼šå¿½ç•¥å®šä¹‰ä¸ºæŠ½è±¡çš„beanå®šä¹‰ã€‚</p><h2 id="å®¹å™¨æ‰©å±•ç‚¹" tabindex="-1"><a class="header-anchor" href="#å®¹å™¨æ‰©å±•ç‚¹"><span>å®¹å™¨æ‰©å±•ç‚¹</span></a></h2><p>é€šå¸¸ï¼Œåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ä¸éœ€è¦ç»§æ‰¿ApplicationContextå®ç°ç±»ã€‚ ç›¸åï¼ŒSpring IoCå®¹å™¨å¯ä»¥é€šè¿‡æ’å…¥ç‰¹æ®Šé›†æˆæ¥å£çš„å®ç°æ¥æ‰©å±•ã€‚ æ¥ä¸‹æ¥çš„å‡ èŠ‚å°†ä»‹ç»è¿™äº›é›†æˆæ¥å£ã€‚</p><h3 id="ä½¿ç”¨beanpostprocessorå®šåˆ¶bean" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨beanpostprocessorå®šåˆ¶bean"><span>ä½¿ç”¨BeanPostProcessorå®šåˆ¶bean</span></a></h3><p><code>BeanPostProcessor</code>æ¥å£å®šä¹‰äº†æ‚¨å¯ä»¥å®ç°çš„å›è°ƒæ–¹æ³•ï¼Œä»¥æä¾›æ‚¨è‡ªå·±çš„ï¼ˆæˆ–è¦†ç›–å®¹å™¨çš„é»˜è®¤å€¼ï¼‰å®ä¾‹åŒ–é€»è¾‘ï¼Œä¾èµ–å…³ç³»è§£æé€»è¾‘ç­‰ç­‰ã€‚å¦‚æœä½ æƒ³åœ¨<code>Spring</code>å®¹å™¨å®Œæˆå®ä¾‹åŒ–ï¼Œé…ç½®å’Œåˆå§‹åŒ–<code>bean</code>ä¹‹åå®ç°ä¸€äº›å®šåˆ¶é€»è¾‘ï¼Œä½ å¯ä»¥æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ª<code>BeanPostProcessor</code>å®ç°ã€‚</p><p>æ‚¨å¯ä»¥é…ç½®å¤šä¸ª<code>BeanPostProcessor</code>å®ä¾‹ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è®¾ç½®<code>order</code>å±æ€§æ¥æ§åˆ¶è¿™äº›<code>BeanPostProcessors</code>æ‰§è¡Œçš„é¡ºåºã€‚åªæœ‰<code>BeanPostProcessor</code>å®ç°<code>Ordered</code>æ¥å£æ—¶ï¼Œæ‰å¯ä»¥è®¾ç½®æ­¤å±æ€§;å¦‚æœä½ ç¼–å†™è‡ªå·±çš„<code>BeanPostProcessor</code>ï¼Œä½ åº”è¯¥è€ƒè™‘å®ç°<code>Ordered</code>æ¥å£ã€‚</p><p><code>BeanPostProcessors</code>å¯¹<code>bean</code>ï¼ˆæˆ–å¯¹è±¡ï¼‰å®ä¾‹è¿›è¡Œæ“ä½œ; ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>Spring IoC</code>å®¹å™¨å®ä¾‹åŒ–ä¸€ä¸ª<code>bean</code>å®ä¾‹å,<code>BeanPostProcessors</code>å¼€å§‹æ‰§è¡Œä»–ä»¬çš„æ“ä½œã€‚</p><p><code>BeanPostProcessors</code>ä½œç”¨åŸŸæ˜¯å®¹å™¨ã€‚è¿™åªæœ‰åœ¨ä½¿ç”¨å®¹å™¨å±‚æ¬¡ç»“æ„æ—¶æ‰æœ‰æ„ä¹‰ã€‚å¦‚æœä½ åœ¨ä¸€ä¸ªå®¹å™¨ä¸­å®šä¹‰äº†ä¸€ä¸ª<code>BeanPostProcessor</code>ï¼Œå®ƒåªä¼šåœ¨è¯¥å®¹å™¨ä¸­åå¤„ç†è¿™äº›<code>bean</code>ã€‚ æ¢å¥è¯è¯´ï¼Œåœ¨ä¸€ä¸ªå®¹å™¨ä¸­å®šä¹‰çš„<code>bean</code>ä¸ä¼šè¢«å¦ä¸€ä¸ªå®¹å™¨ä¸­å®šä¹‰çš„<code>BeanPostProcessor</code>è¿›è¡Œåå¤„ç†ï¼Œå³ä½¿ä¸¤ä¸ªå®¹å™¨éƒ½æ˜¯åŒä¸€å±‚æ¬¡ç»“æ„çš„ä¸€éƒ¨åˆ†ã€‚</p><p>è¦æ›´æ”¹å®é™…çš„<code>bean</code>å®šä¹‰ï¼Œæ‚¨éœ€è¦ä½¿ç”¨<code>BeanFactoryPostProcessor</code>ï¼Œå¦‚ä½¿ç”¨<code>BeanFactoryPostProcessor</code>å®šåˆ¶é…ç½®å…ƒæ•°æ®ä¸­æ‰€è¿°ã€‚</p><p><code>org.springframework.beans.factory.config.BeanPostProcessor</code>æ¥å£æ°å¥½åŒ…å«ä¸¤ä¸ªå›è°ƒæ–¹æ³•ã€‚ å½“è¿™æ ·çš„ç±»è¢«æ³¨å†Œä¸ºå®¹å™¨çš„åå¤„ç†å™¨æ—¶ï¼Œå¯¹äºç”±å®¹å™¨åˆ›å»ºçš„æ¯ä¸ªbeanå®ä¾‹ï¼Œåå¤„ç†å™¨éƒ½ä¼šåœ¨å®¹å™¨åˆå§‹åŒ–æ–¹æ³•ï¼ˆå¦‚<code>InitializingBean</code>çš„<code>afterPropertiesSet</code>ä¹‹å‰å’Œå®¹å™¨ å£°æ˜çš„<code>init</code>æ–¹æ³•ï¼‰ä»¥åŠä»»ä½•<code>bean</code>åˆå§‹åŒ–å›è°ƒä¹‹åè¢«è°ƒç”¨ã€‚åå¤„ç†å™¨å¯ä»¥å¯¹<code>bean</code>å®ä¾‹æ‰§è¡Œä»»ä½•æ“ä½œï¼ŒåŒ…æ‹¬å®Œå…¨å¿½ç•¥å›è°ƒã€‚ä¸€ä¸ª<code>bean</code>åå¤„ç†å™¨é€šå¸¸æ£€æŸ¥å›è°ƒæ¥å£ï¼Œæˆ–è€…å¯èƒ½ç”¨ä¸€ä¸ªä»£ç†åŒ…è£…ä¸€ä¸ª<code>bean</code>ã€‚ ä¸€äº›Spring <code>AOP</code>åŸºç¡€è®¾æ–½ç±»è¢«å®ç°ä¸º<code>bean</code>åå¤„ç†å™¨ï¼Œä»¥æä¾›ä»£ç†åŒ…è£…é€»è¾‘ã€‚</p><p><code>ApplicationContext</code>è‡ªåŠ¨æ£€æµ‹åœ¨é…ç½®å…ƒæ•°æ®ä¸­å®ç°<code>BeanPostProcessor</code>æ¥å£çš„ä»»ä½•<code>bean</code>ã€‚<code>ApplicationContext</code>å°†è¿™äº›<code>bean</code>æ³¨å†Œä¸ºåå¤„ç†å™¨ï¼Œä»¥ä¾¿ç¨ååœ¨åˆ›å»º<code>bean</code>æ—¶è°ƒç”¨å®ƒä»¬ã€‚ <code>Bean</code>åå¤„ç†å™¨å¯ä»¥åƒä»»ä½•å…¶ä»–<code>bean</code>ä¸€æ ·éƒ¨ç½²åœ¨å®¹å™¨ä¸­ã€‚</p><p>è¯·æ³¨æ„ï¼Œåœ¨é…ç½®ç±»ä¸­ä½¿ç”¨<code>@Bean</code>å·¥å‚æ–¹æ³•å£°æ˜<code>BeanPostProcessor</code>æ—¶ï¼Œå·¥å‚æ–¹æ³•çš„è¿”å›ç±»å‹åº”è¯¥æ˜¯å®ç°ç±»æœ¬èº«ï¼Œæˆ–è€…è‡³å°‘æ˜¯<code>org.springframework.beans.factory.config.BeanPostProcessor</code>æ¥å£ï¼Œæ¸…æ¥šåœ°æŒ‡ç¤º è¯¥<code>bean</code>çš„åå¤„ç†å™¨ç‰¹æ€§ã€‚ å¦åˆ™ï¼Œåœ¨å®Œå…¨åˆ›å»ºå®ƒä¹‹å‰ï¼Œ<code>ApplicationContext</code>å°†æ— æ³•æŒ‰ç±»å‹è‡ªåŠ¨æ£€æµ‹å®ƒã€‚ ç”±äº<code>BeanPostProcessor</code>éœ€è¦å°½æ—©å®ä¾‹åŒ–ä»¥é€‚ç”¨äºä¸Šä¸‹æ–‡ä¸­å…¶ä»–<code>bean</code>çš„åˆå§‹åŒ–ï¼Œå› æ­¤è¿™ç§æ—©æœŸç±»å‹æ£€æµ‹éå¸¸é‡è¦ã€‚</p><p>ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºå¦‚ä½•åœ¨<code>ApplicationContext</code>ä¸­ç¼–å†™ï¼Œæ³¨å†Œå’Œä½¿ç”¨<code>BeanPostProcessors</code>ã€‚</p><p><code>Hello World, BeanPostProcessor-style*</code> è¿™ç¬¬ä¸€ä¸ªä¾‹å­è¯´æ˜äº†åŸºæœ¬ç”¨æ³•ã€‚è¯¥ç¤ºä¾‹æ˜¾ç¤ºäº†ä¸€ä¸ªè‡ªå®šä¹‰<code>BeanPostProcessor</code>å®ç°ï¼Œè¯¥å®ç°è°ƒç”¨æ¯ä¸ª<code>bean</code>çš„<code>toString</code>æ–¹æ³•ï¼Œå› ä¸ºå®ƒæ˜¯ç”±å®¹å™¨åˆ›å»ºçš„ï¼Œå¹¶å°†ç»“æœå­—ç¬¦ä¸²æ‰“å°åˆ°ç³»ç»Ÿæ§åˆ¶å°:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">scripting</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">BeanPostProcessor</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InstantiationTracingBeanPostProcessor</span> <span class="token keyword">implements</span> <span class="token class-name">BeanPostProcessor</span> <span class="token punctuation">{</span>

    <span class="token comment">// simply return the instantiated bean as-is</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">postProcessBeforeInitialization</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span> <span class="token comment">// we could potentially return any object reference here...</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">postProcessAfterInitialization</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Bean &#39;&quot;</span> <span class="token operator">+</span> beanName <span class="token operator">+</span> <span class="token string">&quot;&#39; created : &quot;</span> <span class="token operator">+</span> bean<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/lang<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/lang
        http://www.springframework.org/schema/lang/spring-lang.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lang:</span>groovy</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>messenger<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">script-source</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:org/springframework/scripting/groovy/Messenger.groovy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lang:</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Fiona Apple Is Just So Dreamy.<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">lang:</span>groovy</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!--
    when the above bean (messenger) is instantiated, this custom
    BeanPostProcessor implementation will output the fact to the system console
    --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scripting.InstantiationTracingBeanPostProcessor<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„<code>InstantiationTracingBeanPostProcessor</code>æ˜¯å¦‚ä½•å®šä¹‰çš„ã€‚ å®ƒç”šè‡³æ²¡æœ‰åç§°ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª<code>bean</code>ï¼Œå®ƒå¯ä»¥åƒå…¶ä»–ä»»ä½•<code>bean</code>ä¸€æ ·ä¾èµ–æ³¨å…¥ã€‚</p><p><strong>RequiredAnnotationBeanPostProcessor</strong> å°†å›è°ƒæ¥å£æˆ–æ³¨é‡Šä¸è‡ªå®šä¹‰<code>BeanPostProcessor</code>å®ç°ç»“åˆä½¿ç”¨æ˜¯æ‰©å±•Spring IoCå®¹å™¨çš„å¸¸ç”¨æ–¹æ³•ã€‚Springçš„<code>RequiredAnnotationBeanPostProcessor</code>å°±æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå®ƒæ˜¯Springå‘è¡Œç‰ˆä¸­çš„ä¸€ä¸ª<code>BeanPostProcessor</code>å®ç°ï¼Œå®ƒç¡®ä¿æ ‡è®°æœ‰ï¼ˆä»»æ„ï¼‰æ³¨é‡Šçš„<code>bean</code>çš„<code>JavaBean</code>å±æ€§å®é™…ï¼ˆé…ç½®ä¸ºï¼‰ä¾èµ–æ³¨å…¥ä¸€ä¸ªå€¼ã€‚</p><h3 id="ä½¿ç”¨beanfactorypostprocessorå®šåˆ¶é…ç½®å…ƒæ•°æ®" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨beanfactorypostprocessorå®šåˆ¶é…ç½®å…ƒæ•°æ®"><span>ä½¿ç”¨BeanFactoryPostProcessorå®šåˆ¶é…ç½®å…ƒæ•°æ®</span></a></h3><p>ä¸‹ä¸€ä¸ªæˆ‘ä»¬å°†çœ‹åˆ°çš„æ‰©å±•ç‚¹æ˜¯<code>org.springframework.beans.factory.config.BeanFactoryPostProcessor</code>ã€‚è¿™ä¸ªæ¥å£çš„è¯­ä¹‰ä¸<code>BeanPostProcessor</code>ç›¸ä¼¼ï¼Œä¸»è¦åŒºåˆ«åœ¨äºï¼š<code>BeanFactoryPostProcessor</code>åœ¨beané…ç½®å…ƒæ•°æ®ä¸Šè¿è¡Œ; ä¹Ÿå°±æ˜¯è¯´ï¼ŒSpring IoCå®¹å™¨å…è®¸<code>BeanFactoryPostProcessor</code>è¯»å–é…ç½®å…ƒæ•°æ®å¹¶åœ¨å®¹å™¨å®ä¾‹åŒ–é™¤<code>BeanFactoryPostProcessor</code>ä¹‹å¤–çš„ä»»ä½•Beanä¹‹å‰å¯¹å…¶è¿›è¡Œæ›´æ”¹ã€‚</p><p>æ‚¨å¯ä»¥é…ç½®å¤šä¸ª<code>BeanFactoryPostProcessors</code>ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥é€šè¿‡è®¾ç½®<code>order</code>å±æ€§æ¥æ§åˆ¶è¿™äº›<code>BeanFactoryPostProcessors</code>æ‰§è¡Œçš„é¡ºåºã€‚ä½†æ˜¯ï¼Œå¦‚æœ<code>BeanFactoryPostProcessor</code>å®ç°<code>Ordered</code>æ¥å£ï¼Œåˆ™åªèƒ½è®¾ç½®æ­¤å±æ€§ã€‚å¦‚æœä½ ç¼–å†™ä½ è‡ªå·±çš„<code>BeanFactoryPostProcessor</code>ï¼Œä½ åº”è¯¥è€ƒè™‘å®ç°<code>Ordered</code>æ¥å£ã€‚</p><p>å¦‚æœæ‚¨æƒ³æ›´æ”¹å®é™…çš„beanå®ä¾‹ï¼ˆå³ä»é…ç½®å…ƒæ•°æ®åˆ›å»ºçš„å¯¹è±¡ï¼‰ï¼Œåˆ™éœ€è¦ä½¿ç”¨<code>BeanPostProcessor</code>ã€‚ è™½ç„¶æŠ€æœ¯ä¸Šå¯ä»¥åœ¨<code>BeanFactoryPostProcessor</code>ä¸­ä½¿ç”¨beanå®ä¾‹ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨<code>BeanFactory.getBean</code>ï¼‰ï¼Œä½†è¿™æ ·åšä¼šå¯¼è‡´<code>bean</code>è¿‡æ—©å®ä¾‹åŒ–ï¼Œä»è€Œè¿åæ ‡å‡†å®¹å™¨ç”Ÿå‘½å‘¨æœŸã€‚ è¿™å¯èƒ½ä¼šå¯¼è‡´è´Ÿé¢å½±å“ï¼Œå¦‚ç»•è¿‡<code>bean</code>åå¤„ç†ã€‚</p><p>å¦å¤–ï¼Œ<code>BeanFactoryPostProcessors</code>çš„èŒƒå›´æ˜¯æ¯ä¸ªå®¹å™¨ã€‚è¿™åªæœ‰åœ¨ä½¿ç”¨å®¹å™¨å±‚æ¬¡ç»“æ„æ—¶æ‰æœ‰æ„ä¹‰ã€‚å¦‚æœæ‚¨åœ¨ä¸€ä¸ªå®¹å™¨ä¸­å®šä¹‰äº†ä¸€ä¸ª<code>BeanFactoryPostProcessor</code>ï¼Œå®ƒå°†åªåº”ç”¨äºè¯¥å®¹å™¨ä¸­çš„<code>bean</code>å®šä¹‰ã€‚ä¸€ä¸ªå®¹å™¨ä¸­çš„Beanå®šä¹‰å°†ä¸ä¼šç”±å¦ä¸€ä¸ªå®¹å™¨ä¸­çš„<code>BeanFactoryPostProcessors</code>è¿›è¡Œåå¤„ç†ï¼Œå³ä½¿è¿™ä¸¤ä¸ªå®¹å™¨éƒ½æ˜¯åŒä¸€å±‚æ¬¡ç»“æ„çš„ä¸€éƒ¨åˆ†ã€‚</p><p>ä¸€ä¸ªbeanå·¥å‚åå¤„ç†å™¨åœ¨<code>ApplicationContext</code>ä¸­å£°æ˜æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œä»¥ä¾¿å°†æ›´æ”¹åº”ç”¨äºå®šä¹‰å®¹å™¨çš„é…ç½®å…ƒæ•°æ®ã€‚SpringåŒ…å«è®¸å¤šé¢„å®šä¹‰çš„beanå·¥å‚åå¤„ç†å™¨ï¼Œä¾‹å¦‚<code>PropertyOverrideConfigurer</code>å’Œ<code>PropertyPlaceholderConfigurer</code>ã€‚ ä¾‹å¦‚ï¼Œè‡ªå®šä¹‰<code>BeanFactoryPostProcessor</code>ä¹Ÿå¯ç”¨äºæ³¨å†Œè‡ªå®šä¹‰å±æ€§ç¼–è¾‘å™¨ã€‚</p><p>ApplicationContextè‡ªåŠ¨æ£€æµ‹éƒ¨ç½²åˆ°å…¶ä¸­çš„å®ç°<code>BeanFactoryPostProcessor</code>æ¥å£çš„ä»»ä½•Beanã€‚ å®ƒåœ¨é€‚å½“çš„æ—¶å€™ä½¿ç”¨è¿™äº›beanä½œä¸ºbeanå·¥å‚åå¤„ç†å™¨ã€‚ æ‚¨å¯ä»¥åƒä»»ä½•å…¶ä»–beanä¸€æ ·éƒ¨ç½²è¿™äº›åå¤„ç†å™¨beanã€‚</p><p><strong>å®ä¾‹ï¼šç±»åæ›¿æ¢PropertyPlaceholderConfigurer</strong></p><p>æ‚¨å¯ä»¥ä½¿ç”¨<code>PropertyPlaceholderConfigurer</code>ï¼Œé€šè¿‡ä½¿ç”¨æ ‡å‡†çš„Javaå±æ€§æ ¼å¼åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­å°†Beanå®šä¹‰çš„å±æ€§å€¼è¿›è¡Œå¤–éƒ¨åŒ–ã€‚é€šè¿‡è¿™æ ·åšï¼Œéƒ¨ç½²åº”ç”¨ç¨‹åºçš„äººå‘˜å¯ä»¥è‡ªå®šä¹‰ç‰¹å®šäºç¯å¢ƒçš„å±æ€§ï¼Œå¦‚æ•°æ®åº“URLå’Œå¯†ç ï¼Œè€Œæ— éœ€ä¿®æ”¹å®¹å™¨ä¸»XMLå®šä¹‰æ–‡ä»¶ã€‚</p><p>è€ƒè™‘ä»¥ä¸‹åŸºäºXMLçš„é…ç½®å…ƒæ•°æ®ç‰‡æ®µï¼Œå…¶ä¸­å®šä¹‰äº†åŒ…å«å ä½ç¬¦å€¼çš„<code>DataSource</code>ã€‚ è¯¥ç¤ºä¾‹æ˜¾ç¤ºäº†ä»å¤–éƒ¨å±æ€§æ–‡ä»¶é…ç½®çš„å±æ€§ã€‚ åœ¨è¿è¡Œæ—¶ï¼Œä¸€ä¸ª<code>PropertyPlaceholderConfigurer</code>è¢«åº”ç”¨äºå°†å–ä»£<code>DataSource</code>çš„ä¸€äº›å±æ€§çš„å…ƒæ•°æ®ã€‚ è¦æ›¿æ¢çš„å€¼è¢«æŒ‡å®šä¸ºéµå¾ª<code>Ant / log4j / JSP EL</code>æ ·å¼çš„<code>$ {property-name}</code>å½¢å¼çš„å ä½ç¬¦ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.beans.factory.config.PropertyPlaceholderConfigurer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>locations<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:com/foo/jdbc.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">destroy-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>close<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.commons.dbcp.BasicDataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>driverClassName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.driverClassName}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.url}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.username}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.password}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡Spring 2.5ä¸­å¼•å…¥çš„ä¸Šä¸‹æ–‡å‘½åç©ºé—´ï¼Œå¯ä»¥ä½¿ç”¨ä¸“ç”¨çš„é…ç½®å…ƒç´ æ¥é…ç½®å±æ€§å ä½ç¬¦ã€‚ ä¸€ä¸ªæˆ–å¤šä¸ªä½ç½®å¯ä»¥ä½œä¸ºlocationå±æ€§ä¸­çš„é€—å·åˆ†éš”åˆ—è¡¨æä¾›ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:com/foo/jdbc.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>PropertyPlaceholderConfigurer</code>ä¸ä»…åœ¨æ‚¨æŒ‡å®šçš„å±æ€§æ–‡ä»¶ä¸­æŸ¥æ‰¾å±æ€§ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¹Ÿæ£€æŸ¥<code>Java</code>ç³»ç»Ÿå±æ€§ï¼Œå¦‚æœå®ƒæ— æ³•åœ¨æŒ‡å®šçš„å±æ€§æ–‡ä»¶ä¸­æ‰¾åˆ°å±æ€§ã€‚ æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨ä»¥ä¸‹ä¸‰ä¸ªæ”¯æŒçš„æ•´æ•°å€¼ä¹‹ä¸€æ¥è®¾ç½®<code>configurer</code>çš„<code>systemPropertiesMode</code>å±æ€§æ¥è‡ªå®šä¹‰æ­¤è¡Œä¸ºï¼š</p><ul><li>never ï¼ˆ0ï¼‰ï¼šä»ä¸æ£€æŸ¥ç³»ç»Ÿå±æ€§</li><li>fallback ï¼ˆ1ï¼‰ï¼šå¦‚æœä¸èƒ½åœ¨æŒ‡å®šçš„å±æ€§æ–‡ä»¶ä¸­è§£æï¼Œè¯·æ£€æŸ¥ç³»ç»Ÿå±æ€§ã€‚ è¿™æ˜¯é»˜è®¤è®¾ç½®ã€‚</li><li>overrideï¼ˆ2ï¼‰ï¼šåœ¨å°è¯•æŒ‡å®šçš„å±æ€§æ–‡ä»¶ä¹‹å‰ï¼Œé¦–å…ˆæ£€æŸ¥ç³»ç»Ÿå±æ€§ã€‚ è¿™å…è®¸ç³»ç»Ÿå±æ€§è¦†ç›–ä»»ä½•å…¶ä»–å±æ€§æºã€‚</li></ul><p>æ‚¨å¯ä»¥ä½¿ç”¨<code>PropertyPlaceholderConfigurer</code>æ¥æ›¿æ¢ç±»åï¼Œå½“æ‚¨å¿…é¡»åœ¨è¿è¡Œæ—¶é€‰æ‹©ç‰¹å®šçš„å®ç°ç±»æ—¶ï¼Œè¿™æœ‰æ—¶å¾ˆæœ‰ç”¨ã€‚ ä¾‹å¦‚ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.beans.factory.config.PropertyPlaceholderConfigurer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>locations<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>classpath:com/foo/strategy.properties<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>custom.strategy.class=com.foo.DefaultStrategy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>serviceStrategy<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${custom.strategy.class}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ— æ³•åœ¨è¿è¡Œæ—¶å°†ç±»è§£æä¸ºæœ‰æ•ˆçš„ç±»ï¼Œé‚£ä¹ˆå½“å®ƒå³å°†åˆ›å»ºæ—¶ï¼Œbeançš„è§£æå¤±è´¥ï¼Œè¿™æ˜¯åœ¨éæƒ°æ€§åˆå§‹åŒ–Beançš„<code>ApplicationContext</code>çš„<code>preInstantiateSingletons</code>é˜¶æ®µæœŸé—´ã€‚</p><p><strong>å®ä¾‹ï¼šPropertyOverrideConfigurer</strong></p><p><code>PropertyOverrideConfigurer</code>æ˜¯å¦ä¸€ä¸ªbeanå·¥å‚åå¤„ç†å™¨ï¼Œç±»ä¼¼äº<code>PropertyPlaceholderConfigurer</code>ï¼Œä½†ä¸åè€…ä¸åŒï¼ŒåŸå§‹å®šä¹‰å¯¹äºbeanå±æ€§å¯ä»¥å…·æœ‰é»˜è®¤å€¼æˆ–æ ¹æœ¬æ²¡æœ‰å€¼ã€‚ å¦‚æœé‡å†™çš„å±æ€§æ–‡ä»¶æ²¡æœ‰æŸä¸ªbeanå±æ€§çš„æ¡ç›®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„ä¸Šä¸‹æ–‡å®šä¹‰ã€‚</p><p>è¯·æ³¨æ„ï¼Œbeanå®šä¹‰å¹¶ä¸çŸ¥é“è¢«é‡å†™ï¼Œæ‰€ä»¥ä»XMLå®šä¹‰æ–‡ä»¶ä¸­ä¸ä¼šç«‹å³æ˜æ˜¾åœ°çœ‹åˆ°æ­£åœ¨ä½¿ç”¨è¦†ç›–é…ç½®å™¨ã€‚åœ¨ä¸ºåŒä¸€ä¸ªbeanå±æ€§å®šä¹‰ä¸åŒå€¼çš„å¤šä¸ªPropertyOverrideConfigurerå®ä¾‹çš„æƒ…å†µä¸‹ï¼Œç”±äºé‡è½½æœºåˆ¶ï¼Œæœ€åä¸€ä¸ªè·èƒœã€‚</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>dataSource.driverClassName=com.mysql.jdbc.Driver
dataSource.url=jdbc:mysql:mydb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç¤ºä¾‹æ–‡ä»¶å¯ä»¥ä¸å®¹å™¨å®šä¹‰ä¸€èµ·ä½¿ç”¨ï¼Œè¯¥å®¹å™¨å®šä¹‰åŒ…å«ä¸€ä¸ªåä¸ºdataSourceçš„beanï¼Œè¯¥beanå…·æœ‰driverå’Œurlå±æ€§ã€‚</p><p>åªè¦è·¯å¾„ä¸­é™¤æœ€ç»ˆå±æ€§è¢«é‡å†™çš„æ¯ä¸ªç»„ä»¶éƒ½å·²ç»éç©ºï¼ˆå¯èƒ½ç”±æ„é€ å‡½æ•°åˆå§‹åŒ–ï¼‰ï¼Œä¹Ÿæ”¯æŒå¤åˆå±æ€§åç§°ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­â€¦</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>foo.fred.bob.sammy=123
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>foo beançš„fredå±æ€§çš„bobå±æ€§çš„sammyå±æ€§è¢«è®¾ç½®ä¸ºæ ‡é‡å€¼123ã€‚ ä½¿ç”¨Spring 2.5ä¸­å¼•å…¥çš„ä¸Šä¸‹æ–‡å‘½åç©ºé—´ï¼Œå¯ä»¥ä½¿ç”¨ä¸“ç”¨é…ç½®å…ƒç´ é…ç½®å±æ€§è¦†ç›–ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-override</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:override.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨factorybeanå®šåˆ¶å®ä¾‹åŒ–é€»è¾‘" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨factorybeanå®šåˆ¶å®ä¾‹åŒ–é€»è¾‘"><span>ä½¿ç”¨FactoryBeanå®šåˆ¶å®ä¾‹åŒ–é€»è¾‘</span></a></h3><p>ä¸ºè‡ªå·±å·¥å‚çš„å¯¹è±¡å®ç°<code>org.springframework.beans.factory.FactoryBean</code>æ¥å£ã€‚</p><p><code>FactoryBean</code>æ¥å£æ˜¯Spring IoCå®¹å™¨å®ä¾‹åŒ–é€»è¾‘çš„å¯æ’å…¥ç‚¹ã€‚ å¦‚æœä½ æœ‰å¤æ‚çš„åˆå§‹åŒ–ä»£ç ï¼Œç”¨Javaå¯ä»¥æ›´å¥½åœ°è¡¨è¾¾ï¼Œè€Œä¸æ˜¯ï¼ˆå¯èƒ½ï¼‰å†—é•¿çš„XMLï¼Œä½ å¯ä»¥åˆ›å»ºè‡ªå·±çš„<code>FactoryBean</code>ï¼Œåœ¨è¯¥ç±»ä¸­å†™å…¥å¤æ‚çš„åˆå§‹åŒ–ï¼Œç„¶åå°†è‡ªå®šä¹‰çš„<code>FactoryBean</code>æ’å…¥åˆ°å®¹å™¨ä¸­ã€‚</p><p>FactoryBeanæ¥å£æä¾›ä¸‰ç§æ–¹æ³•ï¼š</p><ul><li><code>Object getObject</code>ï¼šè¿”å›æ­¤å·¥å‚åˆ›å»ºçš„å¯¹è±¡çš„å®ä¾‹ã€‚ è¯¥å®ä¾‹å¯èƒ½æ˜¯å…±äº«çš„ï¼Œå…·ä½“å–å†³äºè¯¥å·¥å‚æ˜¯è¿”å›å•ä¾‹è¿˜æ˜¯åŸå‹ã€‚</li><li><code>boolean isSingleton</code>ï¼šå¦‚æœæ­¤FactoryBeanè¿”å›å•ä¾‹ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</li><li><code>Class getObjectType</code>ï¼šè¿”å›<code>getObject</code>æ–¹æ³•è¿”å›çš„å¯¹è±¡ç±»å‹ï¼Œå¦‚æœäº‹å…ˆæœªçŸ¥ç±»å‹ï¼Œåˆ™è¿”å›nullã€‚</li></ul><p><code>FactoryBean</code>çš„æ¦‚å¿µå’Œæ¥å£ç”¨äºSpringæ¡†æ¶çš„è®¸å¤šåœ°æ–¹; <code>FactoryBean</code>æ¥å£çš„50å¤šä¸ªå®ç°ä¸Springæœ¬èº«ä¸€èµ·æä¾›ã€‚å½“ä½ éœ€è¦<code>FactoryBean</code>å®ä¾‹æœ¬èº«è€Œä¸æ˜¯å®ƒäº§ç”Ÿçš„<code>bean</code>æ—¶ï¼Œåœ¨è°ƒç”¨<code>ApplicationContext</code>çš„<code>getBean</code>æ–¹æ³•æ—¶ï¼Œç”¨<code>ï¼†</code>ç¬¦å·ã€‚å› æ­¤ï¼Œå¯¹äºå…·æœ‰<code>myBean</code>æ ‡è¯†çš„ç»™å®šFactoryBeanï¼Œåœ¨å®¹å™¨ä¸Šè°ƒç”¨<code>getBean(&quot;myBean&quot;)</code>å°†è¿”å›<code>FactoryBean</code>çš„äº§å“; è€Œè°ƒç”¨<code>getBean(&quot;ï¼†myBean&quot;)</code>åˆ™è¿”å›<code>FactoryBean</code>å®ä¾‹æœ¬èº«ã€‚</p><h2 id="åŸºäºæ³¨è§£çš„å®¹å™¨é…ç½®" tabindex="-1"><a class="header-anchor" href="#åŸºäºæ³¨è§£çš„å®¹å™¨é…ç½®"><span>åŸºäºæ³¨è§£çš„å®¹å™¨é…ç½®</span></a></h2><h3 id="required" tabindex="-1"><a class="header-anchor" href="#required"><span>Required</span></a></h3><p><code>@Required</code>æ³¨é‡Šé€‚ç”¨äºbeanå±æ€§çš„setteræ–¹æ³•ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Required</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder <span class="token operator">=</span> movieFinder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªæ³¨è§£ä¸»è¦ä½œç”¨æ˜¯æé†’å®¹å™¨åœ¨é…ç½®beançš„æ—¶å€™ï¼Œå¿…é¡»è£…é…å¿…è¦çš„å±æ€§ï¼Œå¦åˆ™åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸ã€‚ä»ç„¶å»ºè®®æ‚¨å°†æ–­è¨€æ”¾å…¥<code>bean</code>ç±»æœ¬èº«ï¼Œä¾‹å¦‚ï¼Œæ”¾å…¥<code>init</code>æ–¹æ³•ä¸­ã€‚ è¿™æ ·åšå³ä½¿åœ¨å®¹å™¨å¤–éƒ¨ä½¿ç”¨è¯¥ç±»æ—¶ä¹Ÿä¼šå¼ºåˆ¶æ‰§è¡Œæ£€æŸ¥é‚£äº›å¿…éœ€çš„å¼•ç”¨å’Œå€¼ã€‚</p><h3 id="autowired" tabindex="-1"><a class="header-anchor" href="#autowired"><span>Autowired</span></a></h3><p>æ„é€ æ–¹æ³•ä¸Šä½¿ç”¨</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieRecommender</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">CustomerPreferenceDao</span> customerPreferenceDao<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">MovieRecommender</span><span class="token punctuation">(</span><span class="token class-name">CustomerPreferenceDao</span> customerPreferenceDao<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>customerPreferenceDao <span class="token operator">=</span> customerPreferenceDao<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ä»Spring Framework 4.3å¼€å§‹ï¼Œå¦‚æœç›®æ ‡beanåªå®šä¹‰äº†ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆè¿™ç§æ„é€ å‡½æ•°ä¸Šçš„@Autowiredæ³¨é‡Šå°±ä¸å†éœ€è¦äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœæœ‰å‡ ä¸ªæ„é€ å‡½æ•°å¯ç”¨ï¼Œåˆ™å¿…é¡»è‡³å°‘æ³¨æ˜ä¸€ä¸ªæ„é€ å‡½æ•°æ¥å‘Šè¯‰å®¹å™¨ä½¿ç”¨å“ªä¸€ä¸ªã€‚</p></blockquote><p>åœ¨setteræ–¹æ³•ä¸Šä½¿ç”¨</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder <span class="token operator">=</span> movieFinder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…·æœ‰ä»»æ„åç§°æˆ–å¤šä¸ªå‚æ•°çš„æ–¹æ³•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieRecommender</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieCatalog</span> movieCatalog<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">CustomerPreferenceDao</span> customerPreferenceDao<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">prepare</span><span class="token punctuation">(</span><span class="token class-name">MovieCatalog</span> movieCatalog<span class="token punctuation">,</span>
            <span class="token class-name">CustomerPreferenceDao</span> customerPreferenceDao<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieCatalog <span class="token operator">=</span> movieCatalog<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>customerPreferenceDao <span class="token operator">=</span> customerPreferenceDao<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨ä¹Ÿå¯ä»¥å°†<code>@Autowired</code>åº”ç”¨äº<code>field</code>ï¼Œç”šè‡³å¯ä»¥å°†å…¶ä¸æ„é€ å‡½æ•°æ··åˆä½¿ç”¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieRecommender</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">CustomerPreferenceDao</span> customerPreferenceDao<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MovieCatalog</span> movieCatalog<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">MovieRecommender</span><span class="token punctuation">(</span><span class="token class-name">CustomerPreferenceDao</span> customerPreferenceDao<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>customerPreferenceDao <span class="token operator">=</span> customerPreferenceDao<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºé€šè¿‡ç±»è·¯å¾„æ‰«ææ‰¾åˆ°çš„<code>XML</code>å®šä¹‰çš„<code>bean</code>æˆ–ç»„ä»¶ç±»ï¼Œå®¹å™¨é€šå¸¸ä¼šé¢„å…ˆçŸ¥é“å…·ä½“ç±»å‹ã€‚ ä½†æ˜¯ï¼Œå¯¹äº<code>@Bean</code>å·¥å‚æ–¹æ³•ï¼Œæ‚¨éœ€è¦ç¡®ä¿å£°æ˜çš„è¿”å›è¶³å¤Ÿè¡¨è¾¾ç±»å‹ä¿¡æ¯ã€‚å¯¹äºå®ç°å¤šä¸ªæ¥å£çš„ç»„ä»¶æˆ–å¯èƒ½ç”±å…¶å®ç°ç±»å‹å¼•ç”¨çš„ç»„ä»¶ï¼Œè¯·è€ƒè™‘åœ¨å·¥å‚æ–¹æ³•ä¸­å£°æ˜æœ€å…·ä½“çš„è¿”å›ç±»å‹ï¼ˆè‡³å°‘æŒ‰ç…§æ³¨å…¥ç‚¹å¯¹beanå¼•ç”¨çš„è¦æ±‚ï¼‰ã€‚</p><p>é€šè¿‡å°†<code>@Autowired</code>æ·»åŠ åˆ°æ•°ç»„å­—æ®µæˆ–æ–¹æ³•ï¼Œå¯ä»¥ä»ApplicationContextè·å–ç‰¹å®šç±»å‹çš„æ‰€æœ‰Beanï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieRecommender</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MovieCatalog</span><span class="token punctuation">[</span><span class="token punctuation">]</span> movieCatalogs<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹é›†åˆåŒæ ·é€‚ç”¨</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieRecommender</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MovieCatalog</span><span class="token punctuation">&gt;</span></span> movieCatalogs<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieCatalogs</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MovieCatalog</span><span class="token punctuation">&gt;</span></span> movieCatalogs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieCatalogs <span class="token operator">=</span> movieCatalogs<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>å¦‚æœå¸Œæœ›æ•°ç»„æˆ–åˆ—è¡¨ä¸­çš„é¡¹ç›®æŒ‰ç‰¹å®šé¡ºåºæ’åº,æ‚¨çš„ç›®æ ‡beanå¯ä»¥å®ç°<code>org.springframework.core.Ordered</code>æ¥å£ï¼Œæˆ–è€…ä½¿ç”¨<code>@Order</code>æˆ–æ ‡å‡†<code>@Priority</code>æ³¨é‡Šã€‚ å¦åˆ™ï¼Œä»–ä»¬çš„é¡ºåºå°†éµå¾ªå®¹å™¨ä¸­ç›¸åº”ç›®æ ‡<code>bean</code>å®šä¹‰çš„æ³¨å†Œé¡ºåºã€‚</p></blockquote><p>Mapç±»å‹ä¹Ÿå¯ä»¥è‡ªåŠ¨æ³¨å…¥ã€‚ Mapå€¼å°†åŒ…å«æœŸæœ›ç±»å‹çš„æ‰€æœ‰beanï¼Œå¹¶ä¸”é”®å°†åŒ…å«ç›¸åº”çš„beanåç§°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieRecommender</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">MovieCatalog</span><span class="token punctuation">&gt;</span></span> movieCatalogs<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieCatalogs</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">MovieCatalog</span><span class="token punctuation">&gt;</span></span> movieCatalogs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieCatalogs <span class="token operator">=</span> movieCatalogs<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨æ³¨å…¥çš„beanä¸å­˜åœ¨å®¹å™¨ä¸­åˆ™ä¾èµ–æ³¨å…¥å¤±è´¥ã€‚è¯¥æ³¨è§£æ ‡æ³¨çš„æ–¹æ³•ã€å­—æ®µã€æ„é€ å‡½æ•°å¿…é¡»æ³¨å…¥ç›¸å…³ä¾èµ–é¡¹ï¼Œå¯ä»¥æ”¹å˜è¯¥è¡Œä¸ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span><span class="token punctuation">(</span>required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder <span class="token operator">=</span> movieFinder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å»ºè®®ä½¿ç”¨<code>@Required</code>æ³¨è§£æ¥æ ‡è®°<code>@Autowired</code>çš„<code>required</code>å±æ€§ã€‚<code>Autowired</code>çš„å±æ€§å¦‚æœä¸èƒ½è‡ªåŠ¨è£…é…ï¼Œåˆ™è¯¥å±æ€§å°†è¢«å¿½ç•¥ã€‚ä½†<code>@Required</code>æ›´å¼ºå¤§ï¼Œå› ä¸ºå®ƒå¼ºåˆ¶æ‰§è¡Œã€‚ å¦‚æœæ²¡æœ‰å€¼è¢«æ³¨å…¥ï¼Œåˆ™ä¼šå¼•å‘ç›¸åº”çš„å¼‚å¸¸ã€‚</p><p>æˆ–è€…ï¼Œæ‚¨å¯ä»¥é€šè¿‡Java 8çš„<code>java.util.Optional</code>è¡¨è¾¾ç‰¹å®šä¾èµ–é¡¹çš„éå¿…éœ€æ€§è´¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MovieFinder</span><span class="token punctuation">&gt;</span></span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»Spring Framework 5.0å¼€å§‹ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨<code>@Nullable</code>æ³¨é‡Šï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨<code>@Autowired</code>åœ¨ä¼—æ‰€å‘¨çŸ¥çš„å¯è§£æä¾èµ–é¡¹çš„æ¥å£ï¼š<code>BeanFactory</code>ï¼Œ<code>ApplicationContext</code>ï¼Œ<code>Environment</code>ï¼Œ<code>ResourceLoader</code>ï¼Œ<code>ApplicationEventPublisher</code>å’Œ<code>MessageSource</code>ã€‚ è¿™äº›æ¥å£åŠå…¶æ‰©å±•æ¥å£ï¼ˆå¦‚<code>ConfigurableApplicationContext</code>æˆ–<code>ResourcePatternResolver</code>ï¼‰ä¼šè‡ªåŠ¨è§£æï¼Œæ— éœ€è¿›è¡Œç‰¹æ®Šè®¾ç½®ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieRecommender</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ApplicationContext</span> context<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MovieRecommender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>@Autowired</code>ï¼Œ<code>@Inject</code>ï¼Œ<code>@Resource</code>å’Œ<code>@Value</code>æ³¨è§£ç”±Spring <code>BeanPostProcessor</code>å®ç°å¤„ç†ï¼Œè¿™æ„å‘³ç€æ‚¨ä¸èƒ½åœ¨æ‚¨è‡ªå·±çš„<code>BeanPostProcessor</code>æˆ–<code>BeanFactoryPostProcessor</code>ç±»å‹ï¼ˆå¦‚æœæœ‰ï¼‰ä¸­åº”ç”¨è¿™äº›æ³¨é‡Šã€‚ è¿™äº›ç±»å‹å¿…é¡»é€šè¿‡<code>XML</code>æˆ–ä½¿ç”¨Spring <code>@Bean</code>æ–¹æ³•å£°æ˜ã€‚</p><h3 id="primary" tabindex="-1"><a class="header-anchor" href="#primary"><span>Primary</span></a></h3><p>ç”±äºæŒ‰ç±»å‹è‡ªåŠ¨è£…é…å¯èƒ½ä¼šå¯¼è‡´å¤šä¸ªå€™é€‰äººï¼Œå› æ­¤é€šå¸¸éœ€è¦å¯¹é€‰æ‹©è¿‡ç¨‹æœ‰æ›´å¤šçš„æ§åˆ¶æƒã€‚ ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨Springçš„<code>@Primary</code>æ³¨è§£ã€‚ <code>@Primary</code>è¡¨ç¤ºå½“å¤šä¸ªbeanå¯ä»¥è¢«è‡ªåŠ¨è£…é…æˆå•å€¼ä¾èµ–é¡¹æ—¶ï¼Œåº”è¯¥ç»™äºˆä¸€ä¸ªç‰¹å®šçš„beanä¼˜å…ˆã€‚ å¦‚æœå€™é€‰äººä¸­åªæœ‰ä¸€ä¸ª<code>primary</code> beanï¼Œå®ƒå°†æ˜¯è‡ªåŠ¨è£…é…çš„å€¼ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieConfiguration</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@Primary</span>
    <span class="token keyword">public</span> <span class="token class-name">MovieCatalog</span> <span class="token function">firstMovieCatalog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">MovieCatalog</span> <span class="token function">secondMovieCatalog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieRecommender</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MovieCatalog</span> movieCatalog<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="qualifiers" tabindex="-1"><a class="header-anchor" href="#qualifiers"><span>Qualifiers</span></a></h3><p>æ‚¨å¯ä»¥å°†<code>qualifiers</code>ä¸ç‰¹å®šå‚æ•°ç›¸å…³è”ï¼Œç¼©å°åŒ¹é…ç±»å‹çš„é›†åˆï¼Œä»¥ä¾¿ä¸ºæ¯ä¸ªå‚æ•°é€‰æ‹©ç‰¹å®šçš„bean</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieRecommender</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">MovieCatalog</span> movieCatalog<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>@Qualifier</code>æ³¨è§£ä¹Ÿå¯ä»¥åœ¨å•ç‹¬çš„æ„é€ å‡½æ•°å‚æ•°æˆ–æ–¹æ³•å‚æ•°ä¸­æŒ‡å®šï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieRecommender</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieCatalog</span> movieCatalog<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">CustomerPreferenceDao</span> customerPreferenceDao<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">prepare</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">)</span><span class="token class-name">MovieCatalog</span> movieCatalog<span class="token punctuation">,</span>
            <span class="token class-name">CustomerPreferenceDao</span> customerPreferenceDao<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieCatalog <span class="token operator">=</span> movieCatalog<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>customerPreferenceDao <span class="token operator">=</span> customerPreferenceDao<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨æ³›å‹ä½œä¸ºè‡ªåŠ¨è£…é…é™å®šç¬¦" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ³›å‹ä½œä¸ºè‡ªåŠ¨è£…é…é™å®šç¬¦"><span>ä½¿ç”¨æ³›å‹ä½œä¸ºè‡ªåŠ¨è£…é…é™å®šç¬¦</span></a></h3><p>é™¤äº†<code>@Qualifier</code>æ³¨é‡Šä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨Javaé€šç”¨ç±»å‹ä½œä¸ºéšå¼çš„é™å®šæ¡ä»¶ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æœ‰ä»¥ä¸‹é…ç½®ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfiguration</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">StringStore</span> <span class="token function">stringStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">StringStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">IntegerStore</span> <span class="token function">integerStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">IntegerStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‡è®¾ä¸Šé¢çš„Beanå®ç°äº†ä¸€ä¸ªé€šç”¨æ¥å£ï¼Œå³<code>Store &lt;String&gt;</code>å’ŒStore <code>&lt;Integer&gt;</code>ï¼Œæ‚¨å¯ä»¥<code>@Autowire</code> Storeæ¥å£å¹¶ä¸”æ³›å‹å°†ç”¨ä½œé™å®šç¬¦ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">Store</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> s1<span class="token punctuation">;</span> <span class="token comment">// &lt;String&gt; qualifier, injects the stringStore bean</span>

<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">Store</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> s2<span class="token punctuation">;</span> <span class="token comment">// &lt;Integer&gt; qualifier, injects the integerStore bean</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡ªåŠ¨è£…é…åˆ—è¡¨ï¼ŒMapå’ŒListæ—¶ä¹Ÿé€‚ç”¨é€šç”¨é™å®šç¬¦ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// åªè¦å…·æœ‰&lt;Integer&gt;æ³›å‹ï¼Œå°±å¯ä»¥æ³¨å…¥æ‰€æœ‰Store Bean</span>
<span class="token comment">// Store&lt;String&gt; ä¸ä¼šå‡ºç°åœ¨åˆ—è¡¨ä¸­</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Store</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> s<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœ<code>@Qualifier</code>æ³¨è§£ä¸­æ²¡æœ‰æŒ‡å®šé™å®šåç§°,<code>spring</code>ä¼šæŒ‡å®š<code>bean</code>çš„idä½œä¸ºé™å®šåç§°.éœ€è¦æ³¨æ„çš„æ˜¯,<code>@Autowired</code>æ³¨è§£æ˜¯å…ˆåŒ¹é…æ‰€æœ‰çš„ç±»å‹,ç„¶åå†æ ¹æ® <code>@Qualifier</code>é€‰å®šå…·ä½“çš„<code>bean</code>çš„,ä¸è¦ä»¥ä¸ºæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡é™å®šåå°±å¯ä»¥è‡ªåŠ¨æ³¨å…¥.</p><p><code>@Qualifier</code>æ³¨è§£ä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨é›†åˆä¸Š,è¿™ç§æƒ…å†µä¸‹,æ‰€æœ‰åŒ¹é…çš„beanä¼šè¢«æ³¨å…¥.</p><p>æ³¨å…¥ç‚¹ä¸Šçš„<code>@Qualifier</code>æ³¨è§£ä¸æ˜¯å¿…é¡»çš„,springåœ¨æ³¨å…¥çš„æ—¶å€™å¦‚æœå‘ç°æœ‰å¾ˆå¤šåŒ¹é…é¡¹,ä¼šä½¿ç”¨å‚æ•°çš„åç§°ä½œä¸ºé™å®šå€¼.</p><p>JSR-250 <code>@Resource</code>æ³¨è§£æ˜¯å®Œå…¨æ ¹æ®é™å®šåæ¥åŒ¹é…çš„,ä¸ç®¡æ³¨å…¥çš„ç±»å‹æ˜¯å¦å’Œéœ€è¦çš„ä¸€è‡´.</p><p><code>@Autowired</code>é€‚ç”¨äºå­—æ®µï¼Œæ„é€ å‡½æ•°å’Œå¤šå‚æ•°æ–¹æ³•ï¼Œå…è®¸åœ¨å‚æ•°çº§åˆ«ç¼©å°é™å®šèŒƒå›´ã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<code>@Resource</code>ä»…æ”¯æŒ<code>field</code>å’Œå…·æœ‰å•ä¸ªå‚æ•°çš„<code>setter</code>æ–¹æ³•ã€‚ å› æ­¤ï¼Œå¦‚æœæ³¨å°„ç›®æ ‡æ˜¯æ„é€ å‡½æ•°æˆ–å¤šå‚æ•°æ–¹æ³•ï¼Œåˆ™åº”è¯¥ä½¿ç”¨<code>@Qualifier</code>ã€‚</p><p>æ‚¨å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰é™å®šç¬¦æ³¨è§£ã€‚ å¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">FIELD</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">PARAMETER</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Qualifier</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Genre</span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢çš„ä»£ç å‘Šè¯‰ä½ å¦‚ä½•ä½¿ç”¨:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieRecommender</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token annotation punctuation">@Genre</span><span class="token punctuation">(</span><span class="token string">&quot;Action&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">MovieCatalog</span> actionCatalog<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieCatalog</span> comedyCatalog<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setComedyCatalog</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Genre</span><span class="token punctuation">(</span><span class="token string">&quot;Comedy&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MovieCatalog</span> comedyCatalog<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>comedyCatalog <span class="token operator">=</span> comedyCatalog<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨customautowireconfigurer" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨customautowireconfigurer"><span>ä½¿ç”¨CustomAutowireConfigurer</span></a></h3><p><code>CustomAutowireConfigurer</code>æ˜¯ä¸€ä¸ª<code>BeanFactoryPostProcessor</code>ï¼Œå®ƒå…è®¸æ‚¨æ³¨å†Œè‡ªå·±çš„è‡ªå®šä¹‰é™å®šç¬¦æ³¨é‡Šç±»å‹ï¼Œå³ä½¿å®ƒä»¬æ²¡æœ‰ä½¿ç”¨Springçš„<code>@Qualifier</code>è¿›è¡Œæ³¨é‡Šã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºå¦‚ä½•ä½¿ç”¨<code>CustomAutowireConfigurer</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">&quot;customAutowireConfigurer&quot;</span>
        <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;org.springframework.beans.factory.annotation.CustomAutowireConfigurer&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;customQualifierTypes&quot;</span><span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>set<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>value<span class="token punctuation">&gt;</span></span><span class="token class-name"><span class="token namespace">example<span class="token punctuation">.</span></span>CustomQualifier</span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>set<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>AutowireCandidateResolver</code>é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¡®å®š<code>autowire</code>å€™é€‰è€…ï¼š</p><ul><li>æ¯ä¸ªbeanå®šä¹‰çš„autowire-candidateå€¼ . <code>&lt;beans /&gt;</code>å…ƒç´ ä¸Šå¯ç”¨çš„ä»»ä½•<code>default-autowire</code>å€™é€‰æ¨¡å¼ .</li><li>å­˜åœ¨<code>@Qualifier</code>æ³¨é‡Šä»¥åŠä½¿ç”¨<code>CustomAutowireConfigurer</code>æ³¨å†Œçš„ä»»ä½•è‡ªå®šä¹‰æ³¨é‡Š</li></ul><p>å½“å¤šä¸ªbeanæœ‰èµ„æ ¼ä½œä¸ºautowireå€™é€‰è€…æ—¶ï¼Œ<code>primary</code>çš„ç¡®å®šå¦‚ä¸‹ï¼šå¦‚æœå€™é€‰è€…ä¸­åªæœ‰ä¸€ä¸ªbeanå®šä¹‰çš„<code>primary</code>å±æ€§è®¾ç½®ä¸ºtrueï¼Œåˆ™é€‰æ‹©å®ƒã€‚</p><h3 id="ä½¿ç”¨-resourceæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-resourceæ³¨è§£"><span>ä½¿ç”¨@Resourceæ³¨è§£</span></a></h3><p><code>@Resource</code>é‡‡ç”¨nameå±æ€§ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpringå°†è¯¥å€¼è§£é‡Šä¸ºè¦æ³¨å…¥çš„beanåç§°ã€‚ æ¢å¥è¯è¯´ï¼Œå®ƒéµå¾ªæŒ‰åç§°è¯­ä¹‰ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;myMovieFinder&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder <span class="token operator">=</span> movieFinder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæœªæ˜ç¡®æŒ‡å®šåç§°ï¼Œåˆ™é»˜è®¤åç§°æ˜¯ä»å­—æ®µåç§°æˆ–setteræ–¹æ³•æ´¾ç”Ÿçš„ã€‚ å¦‚æœæ˜¯å­—æ®µï¼Œåˆ™é‡‡ç”¨å±æ€§åç§°ã€‚ åœ¨setteræ–¹æ³•çš„æƒ…å†µä¸‹ï¼Œå®ƒé‡‡ç”¨beanå±æ€§åç§°ã€‚</p><p><code>@Resource</code>å…ˆæ ¹æ®åç§°åŒ¹é…,åŒ¹é…ä¸åˆ°å†æ ¹æ®ç±»å‹é€‰æ‹©ã€‚</p><h3 id="ä½¿ç”¨-postconstructå’Œ-predestroy" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-postconstructå’Œ-predestroy"><span>ä½¿ç”¨@PostConstructå’Œ@PreDestroy</span></a></h3><p><code>CommonAnnotationBeanPostProcessor</code>ä¸ä»…è¯†åˆ«<code>@Resource</code>æ³¨é‡Šï¼Œè¿˜è¯†åˆ«JSR-250ç”Ÿå‘½å‘¨æœŸæ³¨é‡Šï¼š<code>javax.annotation.PostConstruct</code>å’Œ<code>javax.annotation.PreDestroy</code>ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CachingMovieLister</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@PostConstruct</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">populateMovieCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// populates the movie cache upon initialization...</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PreDestroy</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clearMovieCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// clears the movie cache upon destruction...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç±»è·¯å¾„æ‰«æå’Œç»„ä»¶ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#ç±»è·¯å¾„æ‰«æå’Œç»„ä»¶ç®¡ç†"><span>ç±»è·¯å¾„æ‰«æå’Œç»„ä»¶ç®¡ç†</span></a></h2><h3 id="component" tabindex="-1"><a class="header-anchor" href="#component"><span>@Component</span></a></h3><p><code>@Component</code> æ˜¯ä»»ä½•Springç®¡ç†ç»„ä»¶çš„é€šç”¨æ„é€ å‹ã€‚ <code>@Repository</code> ï¼Œ<code> @Service</code> å’Œ<code> @Controller</code> æ˜¯ <code>@Component</code>çš„ç‰¹ä¾‹åŒ–,ä½œç”¨æ˜¯ä¸€æ ·çš„,ä¹‹æ‰€ä»¥è¿™ä¹ˆåš,æ˜¯ä¸ºäº†æ›´å¥½çš„åŒºåˆ†ç»„ä»¶.</p><h3 id="ä½¿ç”¨å…ƒæ³¨è§£å’Œæ³¨è§£ç»„åˆ" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨å…ƒæ³¨è§£å’Œæ³¨è§£ç»„åˆ"><span>ä½¿ç”¨å…ƒæ³¨è§£å’Œæ³¨è§£ç»„åˆ</span></a></h3><p>Springæä¾›çš„è®¸å¤šæ³¨è§£éƒ½å¯ä»¥åœ¨æ‚¨è‡ªå·±çš„ä»£ç ä¸­ç”¨ä½œå…ƒæ³¨è§£ã€‚ å…ƒæ³¨è§£æ˜¯å¯ä»¥åº”ç”¨äºå¦ä¸€ä¸ªæ³¨è§£çš„æ³¨è§£ã€‚ ä¾‹å¦‚ï¼Œå‰é¢æåˆ°çš„<code>@Service</code>æ³¨è§£æ˜¯ä½¿ç”¨<code>@Component</code>è¿›è¡Œå…ƒæ³¨è§£çš„ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Service</span> <span class="token punctuation">{</span>

    <span class="token comment">// ....</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨è¿˜å¯ä»¥åˆ›å»ºç»„åˆæ³¨é‡Šã€‚ ä¾‹å¦‚ï¼ŒSpring MVCçš„<code>@RestController</code>æ³¨é‡Šç”±<code>@Controller</code>å’Œ<code>@ResponseBody</code>ç»„æˆã€‚</p><p>æ­¤å¤–ï¼Œç»„åˆæ³¨è§£å¯ä»¥é€‰æ‹©ä»å…ƒæ³¨è§£é‡æ–°å£°æ˜å±æ€§ä»¥å…è®¸è‡ªå®šä¹‰ã€‚ å½“æ‚¨åªæƒ³å…¬å¼€å…ƒæ³¨è§£å±æ€§çš„å­é›†æ—¶ï¼Œè¿™å¯èƒ½ç‰¹åˆ«æœ‰ç”¨ã€‚ ä¾‹å¦‚ï¼ŒSpringçš„<code>@SessionScope</code>æ³¨é‡Šå°†èŒƒå›´åç§°ç¡¬ç¼–ç åˆ°<code>session</code>ï¼Œä½†ä»å…è®¸è‡ªå®šä¹‰<code>proxyMode</code>ã€‚ ä»¥ä¸‹æ¸…å•æ˜¾ç¤ºäº†<code>SessionScope</code>æ‰¹æ³¨çš„å®šä¹‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Scope</span><span class="token punctuation">(</span><span class="token class-name">WebApplicationContext</span><span class="token punctuation">.</span><span class="token constant">SCOPE_SESSION</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SessionScope</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * Alias for <span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">Scope</span><span class="token punctuation">#</span><span class="token field">proxyMode</span></span><span class="token punctuation">}</span>.
     * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Defaults to <span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">ScopedProxyMode</span><span class="token punctuation">#</span><span class="token field">TARGET_CLASS</span></span><span class="token punctuation">}</span>.
     */</span>
    <span class="token annotation punctuation">@AliasFor</span><span class="token punctuation">(</span>annotation <span class="token operator">=</span> <span class="token class-name">Scope</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token class-name">ScopedProxyMode</span> <span class="token function">proxyMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token class-name">ScopedProxyMode</span><span class="token punctuation">.</span><span class="token constant">TARGET_CLASS</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è‡ªåŠ¨æ£€æµ‹ç±»å¹¶æ³¨å†Œæˆbean" tabindex="-1"><a class="header-anchor" href="#è‡ªåŠ¨æ£€æµ‹ç±»å¹¶æ³¨å†Œæˆbean"><span>è‡ªåŠ¨æ£€æµ‹ç±»å¹¶æ³¨å†ŒæˆBean</span></a></h3><p>springå¯ä»¥è‡ªåŠ¨æ£€æµ‹è¢«è¿™äº›æ³¨è§£æ‰¹æ³¨çš„ç±»,å¹¶æ³¨å†Œæˆå®¹å™¨ç®¡ç†çš„bean,ä¾‹å¦‚:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">SimpleMovieLister</span><span class="token punctuation">(</span><span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder <span class="token operator">=</span> movieFinder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JpaMovieFinder</span> <span class="token keyword">implements</span> <span class="token class-name">MovieFinder</span> <span class="token punctuation">{</span>
    <span class="token comment">// implementation elided for clarity</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦è‡ªåŠ¨æ£€æµ‹è¿™äº›ç±»å¹¶æ³¨å†Œç›¸åº”çš„beanï¼Œéœ€è¦å°†<code>@ComponentScan</code>æ·»åŠ åˆ°<code>@Configuration</code>ç±»ï¼Œå…¶ä¸­<code>basePackages</code>å±æ€§æŒ‡å®šæ‰«æçš„å¼—åŒ…ã€‚ ï¼ˆé€—å·æˆ–åˆ†å·æˆ–ç©ºæ ¼åˆ†éš”åˆ—è¡¨ã€‚ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">&quot;org.example&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span>  <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤å¤–ï¼Œä½¿ç”¨<code>component-scan</code>å…ƒç´ æ—¶ï¼Œå°†éšå¼åŒ…å«<code>AutowiredAnnotationBeanPostProcessor</code>å’Œ<code>CommonAnnotationBeanPostProcessor</code>ã€‚</p><h3 id="ä½¿ç”¨è¿‡æ»¤å™¨è‡ªå®šä¹‰æ‰«æ" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨è¿‡æ»¤å™¨è‡ªå®šä¹‰æ‰«æ"><span>ä½¿ç”¨è¿‡æ»¤å™¨è‡ªå®šä¹‰æ‰«æ</span></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨<code>@Component</code>ï¼Œ<code>@Repository</code>ï¼Œ<code>@Service</code>ï¼Œ<code>@Controller</code>æ³¨é‡Šçš„ç±»æˆ–è€…åŸºäºä¸Šé¢çš„æ³¨è§£æ‰©å±•çš„æ³¨è§£ä¼šè¢«æ‰«æç„¶åæ³¨å†Œæˆ<code>Bean</code>ã€‚ ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥é€šè¿‡åº”ç”¨è‡ªå®šä¹‰ç­›é€‰å™¨æ¥ä¿®æ”¹å’Œæ‰©å±•æ­¤è¡Œä¸ºã€‚<code>@ComponentScan</code>æ³¨é‡Šçš„<code>includeFilters</code>æˆ–<code>excludeFilters</code>å‚æ•°æ¥åŒ…å«å’Œæ’é™¤. æ¯ä¸ª<code>filter</code>å…ƒç´ éƒ½éœ€è¦<code>type</code>å’Œ<code>expression</code>å±æ€§ã€‚ ä¸‹è¡¨ä»‹ç»äº†ç­›é€‰é€‰é¡¹ï¼š</p><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç¤ºä¾‹è¡¨è¾¾å¼</th><th style="text-align:left;">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left;">annotation (default)</td><td style="text-align:left;">org.example.SomeAnnotation</td><td style="text-align:left;">å‡ºç°åœ¨ç›®æ ‡ç±»ä¸Šçš„æ³¨è§£</td></tr><tr><td style="text-align:left;">assignable</td><td style="text-align:left;">org.example.SomeClass</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">aspectj</td><td style="text-align:left;">org.example..*Service+</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">regex</td><td style="text-align:left;">org.example.Default.*</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">custom</td><td style="text-align:left;">org.example.MyTypeFilter</td><td style="text-align:left;"></td></tr></tbody></table><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">&quot;org.example&quot;</span><span class="token punctuation">,</span>
        includeFilters <span class="token operator">=</span> <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">REGEX</span><span class="token punctuation">,</span> pattern <span class="token operator">=</span> <span class="token string">&quot;.*Stub.*Repository&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        excludeFilters <span class="token operator">=</span> <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span><span class="token class-name">Repository</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åœ¨ç»„ä»¶ä¸­å®šä¹‰beanå…ƒæ•°æ®" tabindex="-1"><a class="header-anchor" href="#åœ¨ç»„ä»¶ä¸­å®šä¹‰beanå…ƒæ•°æ®"><span>åœ¨ç»„ä»¶ä¸­å®šä¹‰Beanå…ƒæ•°æ®</span></a></h3><p>Springç»„ä»¶è¿˜å¯ä»¥å‘å®¹å™¨æä¾›<code>bean</code>å®šä¹‰å…ƒæ•°æ®ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨<code>@Bean</code>æ³¨é‡Šæ¥æ‰§è¡Œæ­¤æ“ä½œã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FactoryMethodComponent</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;public&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">TestBean</span> <span class="token function">publicInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TestBean</span><span class="token punctuation">(</span><span class="token string">&quot;publicInstance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Component method implementation omitted</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FactoryMethodComponent</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;public&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">TestBean</span> <span class="token function">publicInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TestBean</span><span class="token punctuation">(</span><span class="token string">&quot;publicInstance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// use of a custom qualifier and autowiring of method parameters</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">protected</span> <span class="token class-name">TestBean</span> <span class="token function">protectedInstance</span><span class="token punctuation">(</span>
            <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;public&quot;</span><span class="token punctuation">)</span> <span class="token class-name">TestBean</span> spouse<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;#{privateInstance.age}&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> country<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TestBean</span> tb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestBean</span><span class="token punctuation">(</span><span class="token string">&quot;protectedInstance&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tb<span class="token punctuation">.</span><span class="token function">setSpouse</span><span class="token punctuation">(</span>spouse<span class="token punctuation">)</span><span class="token punctuation">;</span>
        tb<span class="token punctuation">.</span><span class="token function">setCountry</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> tb<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">private</span> <span class="token class-name">TestBean</span> <span class="token function">privateInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TestBean</span><span class="token punctuation">(</span><span class="token string">&quot;privateInstance&quot;</span><span class="token punctuation">,</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@RequestScope</span>
    <span class="token keyword">public</span> <span class="token class-name">TestBean</span> <span class="token function">requestScopedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TestBean</span><span class="token punctuation">(</span><span class="token string">&quot;requestScopedInstance&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è¢«æ‰«æåˆ°çš„beançš„å‘½åè§„èŒƒ" tabindex="-1"><a class="header-anchor" href="#è¢«æ‰«æåˆ°çš„beançš„å‘½åè§„èŒƒ"><span>è¢«æ‰«æåˆ°çš„Beançš„å‘½åè§„èŒƒ</span></a></h3><p>å½“ç»„ä»¶è¢«æ‰«æåˆ°å,æ³¨å†Œåˆ°beanå®¹å™¨ä¸­çš„åç§°ç”±<code>BeanNameGenerator </code>ç­–ç•¥æä¾›æ”¯æŒ,é»˜è®¤æƒ…å†µä¸‹,<code>@Component</code>, <code>@Repository</code>, <code>@Service</code>å’Œ <code>@Controller</code>æ³¨è§£éƒ½å—æ­¤è§„èŒƒçº¦æŸ.æˆ‘ä»¬é€šè¿‡åˆ—å­æ¥åšè¯´æ˜:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieFinderImpl</span> <span class="token keyword">implements</span> <span class="token class-name">MovieFinder</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”Ÿæˆçš„<code>bean</code>åç§°æ˜¯ç±»ååç§°,ä½†æ˜¯é¦–å­—æ¯å°å†™,ä¾‹å¦‚ä¸Šé¢çš„ç±»ç”Ÿæˆçš„<code>bean</code>åç§°æ˜¯<code>movieFinderImpl</code></p><p>æˆ‘ä»¬å¯ä»¥åœ¨æ³¨è§£ä¸Šè‡ªå®šä¹‰è¯¥åç§°,ä¾‹å¦‚:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span><span class="token punctuation">(</span><span class="token string">&quot;myMovieLister&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ‚¨ä¸æƒ³ä¾èµ–é»˜è®¤çš„beanå‘½åç­–ç•¥ï¼Œåˆ™å¯ä»¥æä¾›è‡ªå®šä¹‰beanå‘½åç­–ç•¥ã€‚ é¦–å…ˆï¼Œå®ç°<code>BeanNameGenerator</code>æ¥å£ï¼Œå¹¶ç¡®ä¿åŒ…å«é»˜è®¤çš„æ— å‚æ•°æ„é€ å‡½æ•°ã€‚ ç„¶åï¼Œåœ¨é…ç½®æ‰«æç¨‹åºæ—¶æä¾›å®Œå…¨é™å®šçš„ç±»åï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ³¨é‡Šå’Œbeanå®šä¹‰æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">&quot;org.example&quot;</span><span class="token punctuation">,</span> nameGenerator <span class="token operator">=</span> <span class="token class-name">MyNameGenerator</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯,å¦‚æœä¸¤ä¸ªç±»çš„åç§°ç›¸åŒ, springå®¹å™¨åœ¨æ³¨å…¥çš„æ—¶å€™å°±ä¼šå‡ºé”™,ä½ å¯ä»¥é€šè¿‡æ³¨è§£åˆ†åˆ«ç»™ä¸¤ä¸ªç±»æŒ‡å®šä¸åŒçš„beanåç§°æ¥é¿å…</p></blockquote><h3 id="ç»™è‡ªåŠ¨æ‰«æçš„æ³¨è§£æŒ‡å®šscope" tabindex="-1"><a class="header-anchor" href="#ç»™è‡ªåŠ¨æ‰«æçš„æ³¨è§£æŒ‡å®šscope"><span>ç»™è‡ªåŠ¨æ‰«æçš„æ³¨è§£æŒ‡å®šscope</span></a></h3><p>ä¸Springç®¡ç†çš„ç»„ä»¶ä¸€æ ·ï¼Œè‡ªåŠ¨æ£€æµ‹ç»„ä»¶çš„é»˜è®¤å’Œæœ€å¸¸è§çš„èŒƒå›´æ˜¯ <code>singleton</code>ã€‚ ä½†æ˜¯ï¼Œæœ‰æ—¶æ‚¨éœ€è¦ä¸€ä¸ªå¯ç”±<code>@Scope</code>æ³¨è§£æŒ‡å®šçš„ä¸åŒèŒƒå›´ã€‚ æ‚¨å¯ä»¥åœ¨æ³¨é‡Šä¸­æä¾›èŒƒå›´çš„åç§°ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Scope</span><span class="token punctuation">(</span><span class="token string">&quot;prototype&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieFinderImpl</span> <span class="token keyword">implements</span> <span class="token class-name">MovieFinder</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦ä¸ºèŒƒå›´è§£ææä¾›è‡ªå®šä¹‰ç­–ç•¥è€Œä¸æ˜¯ä¾èµ–åŸºäºæ³¨é‡Šçš„æ–¹æ³•ï¼Œå¯ä»¥å®ç°<code>ScopeMetadataResolver</code>æ¥å£ã€‚ è¯·ç¡®ä¿åŒ…å«é»˜è®¤çš„æ— å‚æ•°æ„é€ å‡½æ•°ã€‚ ç„¶åï¼Œæ‚¨å¯ä»¥åœ¨é…ç½®æ‰«æç¨‹åºæ—¶æä¾›å®Œå…¨é™å®šçš„ç±»åï¼Œå› ä¸ºä»¥ä¸‹æ³¨é‡Šå’Œbeanå®šä¹‰ç¤ºä¾‹æ˜¾ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">&quot;org.example&quot;</span><span class="token punctuation">,</span> scopeResolver <span class="token operator">=</span> <span class="token class-name">MyScopeResolver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨æŸäº›éå•ä¾‹ä½œç”¨åŸŸæ—¶ï¼Œå¯èƒ½éœ€è¦ä¸ºä½œç”¨åŸŸå¯¹è±¡ç”Ÿæˆä»£ç†ã€‚ <code>component-scan</code>å…ƒç´ ä¸Šæä¾›äº†<code>scoped-proxy</code>å±æ€§ã€‚ ä¸‰ä¸ªå¯èƒ½çš„å€¼æ˜¯ï¼š<code>no</code>ï¼Œ<code>interfaces</code>å’Œ<code>targetClass</code>ã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹é…ç½®æ˜¯æ ‡å‡†çš„JDKåŠ¨æ€ä»£ç†ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">&quot;org.example&quot;</span><span class="token punctuation">,</span> scopedProxy <span class="token operator">=</span> <span class="token class-name">ScopedProxyMode</span><span class="token punctuation">.</span><span class="token constant">INTERFACES</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç»™è‡ªåŠ¨æ‰«æçš„beanæä¾›qualifier" tabindex="-1"><a class="header-anchor" href="#ç»™è‡ªåŠ¨æ‰«æçš„beanæä¾›qualifier"><span>ç»™è‡ªåŠ¨æ‰«æçš„beanæä¾›Qualifier</span></a></h3><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;Action&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ActionMovieCatalog</span> <span class="token keyword">implements</span> <span class="token class-name">MovieCatalog</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Genre</span><span class="token punctuation">(</span><span class="token string">&quot;Action&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ActionMovieCatalog</span> <span class="token keyword">implements</span> <span class="token class-name">MovieCatalog</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Offline</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CachingMovieCatalog</span> <span class="token keyword">implements</span> <span class="token class-name">MovieCatalog</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç»„ä»¶ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#ç»„ä»¶ç´¢å¼•"><span>ç»„ä»¶ç´¢å¼•</span></a></h3><p>è™½ç„¶ç±»è·¯å¾„æ‰«æé€Ÿåº¦éå¸¸å¿«ï¼Œä½†å¯ä»¥é€šè¿‡åœ¨ç¼–è¯‘æ—¶åˆ›å»ºå€™é€‰çš„é™æ€åˆ—è¡¨æ¥æé«˜å¤§å‹åº”ç”¨ç¨‹åºçš„å¯åŠ¨æ€§èƒ½ã€‚ åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ä½œä¸ºç»„ä»¶æ‰«æç›®æ ‡çš„æ¨¡å—éƒ½å¿…é¡»ä½¿ç”¨æ­¤æœºåˆ¶ã€‚</p><p>ä½¿ç”¨è¯¥ç‰¹æ€§,éœ€è¦æ·»åŠ ä¾èµ–:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>dependencies <span class="token punctuation">{</span>
    annotationProcessor <span class="token string">&quot;org.springframework:spring-context-indexer:5.1.9.RELEASE&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯¥è¿‡ç¨‹ç”Ÿæˆçš„ç´¢å¼•æ–‡ä»¶,åŒ…å«åœ¨jaræ–‡ä»¶ä¸­çš„<code>META-INF/spring.components</code>æ–‡ä»¶ã€‚</p><p>åœ¨ç±»è·¯å¾„ä¸Šæ‰¾åˆ°<code>META-INF/spring.components</code>æ—¶ï¼Œå°†è‡ªåŠ¨å¯ç”¨ç´¢å¼•ã€‚ å¦‚æœç´¢å¼•éƒ¨åˆ†å¯ç”¨äºæŸäº›åº“ï¼ˆæˆ–ç”¨ä¾‹ï¼‰ä½†æ— æ³•ä¸ºæ•´ä¸ªåº”ç”¨ç¨‹åºæ„å»ºï¼Œåˆ™å¯ä»¥é€šè¿‡å°†<code>spring.index.ignore</code>è®¾ç½®<code>true</code>,å›é€€åˆ°å¸¸è§„ç±»è·¯å¾„.</p><h2 id="ä½¿ç”¨jsr-330æ ‡å‡†æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨jsr-330æ ‡å‡†æ³¨è§£"><span>ä½¿ç”¨JSR 330æ ‡å‡†æ³¨è§£</span></a></h2><p>è¦ä½¿ç”¨è¿™äº›æ³¨è§£,éœ€è¦å…ˆå¼•å…¥jaråŒ…:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>javax<span class="token punctuation">.</span>inject<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>javax<span class="token punctuation">.</span>inject<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨-injectå’Œ-namedè¿›è¡Œä¾èµ–æ³¨å…¥" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-injectå’Œ-namedè¿›è¡Œä¾èµ–æ³¨å…¥"><span>ä½¿ç”¨@Injectå’Œ@Namedè¿›è¡Œä¾èµ–æ³¨å…¥</span></a></h3><p>é™¤äº†ä½¿ç”¨<code>@Autowired</code>,ä½ è¿˜å¯ä»¥ä½¿ç”¨<code>@javax.inject.Inject</code>è¿›è¡Œä¾èµ–æ³¨å…¥,ä¾‹å¦‚:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>inject<span class="token punctuation">.</span></span><span class="token class-name">Inject</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder <span class="token operator">=</span> movieFinder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">listMovies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder<span class="token punctuation">.</span><span class="token function">findMovies</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å¯ä»¥ä½¿ç”¨<code>@Inject</code>åœ¨å­—æ®µçº§åˆ«,æ–¹æ³•çº§åˆ«,æ„é€ å‚æ•°çº§åˆ«.æ­¤å¤–ï¼Œæ‚¨å¯ä»¥å°†æ³¨å…¥ç‚¹å£°æ˜ä¸º<code>Provider</code>ï¼Œå…è®¸æŒ‰éœ€è®¿é—®è¾ƒçŸ­èŒƒå›´çš„<code>bean</code>æˆ–é€šè¿‡<code>Provider.get</code>è°ƒç”¨å¯¹å…¶ä»–beançš„å»¶è¿Ÿè®¿é—®ã€‚ ä»¥ä¸‹ç¤ºä¾‹æä¾›äº†ä¸Šè¿°ç¤ºä¾‹çš„å˜ä½“ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>inject<span class="token punctuation">.</span></span><span class="token class-name">Inject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>inject<span class="token punctuation">.</span></span><span class="token class-name">Provider</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Provider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MovieFinder</span><span class="token punctuation">&gt;</span></span> movieFinder<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token class-name">Provider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MovieFinder</span><span class="token punctuation">&gt;</span></span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder <span class="token operator">=</span> movieFinder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">listMovies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findMovies</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ æƒ³ä¸ºæ³¨å…¥çš„ä¾èµ–æŒ‡å®šé™å®šåç§°,ä½ åº”è¯¥ä½¿ç”¨<code>@Name</code>æ³¨è§£,ä¾‹å¦‚:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>inject<span class="token punctuation">.</span></span><span class="token class-name">Inject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>inject<span class="token punctuation">.</span></span><span class="token class-name">Named</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Named</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder <span class="token operator">=</span> movieFinder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸<code>@Autowired</code>ä¸€æ ·ï¼Œ<code>@Inject</code>ä¹Ÿå¯ä»¥ä¸<code>java.util.Optional</code>æˆ–<code>@Nullable</code>ä¸€èµ·ä½¿ç”¨ã€‚ è¿™åœ¨è¿™é‡Œæ›´é€‚ç”¨ï¼Œå› ä¸º<code>@Inject</code>æ²¡æœ‰<code>requied</code>çš„å±æ€§ã€‚ ä»¥ä¸‹ä¸€å¯¹ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>@Inject</code>å’Œ<code>@Nullable</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MovieFinder</span><span class="token punctuation">&gt;</span></span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="named-and-managedbean" tabindex="-1"><a class="header-anchor" href="#named-and-managedbean"><span><code>@Named</code> and <code>@ManagedBean</code>:</span></a></h3><p>ç­‰ä»·äº<code>@Component</code>æ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>inject<span class="token punctuation">.</span></span><span class="token class-name">Inject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>inject<span class="token punctuation">.</span></span><span class="token class-name">Named</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Named</span><span class="token punctuation">(</span><span class="token string">&quot;movieListener&quot;</span><span class="token punctuation">)</span>  <span class="token comment">// @ManagedBean(&quot;movieListener&quot;) could be used as well</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder <span class="token operator">=</span> movieFinder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸æŒ‡å®šç»„ä»¶åç§°çš„æƒ…å†µä¸‹ä½¿ç”¨<code>@Component</code>æ˜¯å¾ˆå¸¸è§çš„ã€‚ <code>@Named</code>å¯ä»¥ä»¥ç±»ä¼¼çš„æ–¹å¼ä½¿ç”¨ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>inject<span class="token punctuation">.</span></span><span class="token class-name">Inject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>inject<span class="token punctuation">.</span></span><span class="token class-name">Named</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Named</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleMovieLister</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMovieFinder</span><span class="token punctuation">(</span><span class="token class-name">MovieFinder</span> movieFinder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>movieFinder <span class="token operator">=</span> movieFinder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨<code>@Named</code>æˆ–<code>@ManagedBean</code>æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸ä½¿ç”¨Springæ³¨é‡Šæ—¶å®Œå…¨ç›¸åŒçš„æ–¹å¼ä½¿ç”¨ç»„ä»¶æ‰«æï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">&quot;org.example&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span>  <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="jsr-330æ³¨è§£çš„å±€é™æ€§" tabindex="-1"><a class="header-anchor" href="#jsr-330æ³¨è§£çš„å±€é™æ€§"><span>JSR-330æ³¨è§£çš„å±€é™æ€§</span></a></h3><table><thead><tr><th style="text-align:left;">springæ³¨è§£</th><th>jdkæ³¨è§£</th><th style="text-align:left;">å±€é™</th></tr></thead><tbody><tr><td style="text-align:left;">@Autowired</td><td>@Inject</td><td style="text-align:left;">@Injectæ³¨è§£æ²¡æœ‰requiredå±æ€§,å¯ä»¥é€šè¿‡ä½¿ç”¨java8çš„Optionalä»£æ›¿</td></tr><tr><td style="text-align:left;">@Component</td><td>@Named / @ManagedBean</td><td style="text-align:left;">ä¸èƒ½ç”¨äºæ³¨è§£ç»„åˆ</td></tr><tr><td style="text-align:left;">@Scope(&quot;singleton&quot;)</td><td>@Singleton</td><td style="text-align:left;">JSR303é»˜è®¤çš„scopeæ˜¯prototype,ä¸ºäº†ä¸springä¿æŒä¸€è‡´,springåº”ç”¨ä¸­é»˜è®¤æ˜¯å•ä¾‹</td></tr><tr><td style="text-align:left;">@Qualifier</td><td>@Qualifier / @Named</td><td style="text-align:left;">javax.inject.Qualifieråªæ˜¯æ„å»ºè‡ªå®šä¹‰é™å®šç¬¦çš„å…ƒæ³¨é‡Šã€‚ å…·ä½“å­—ç¬¦ä¸²é™å®šç¬¦ï¼ˆå¦‚Springçš„å¸¦æœ‰å€¼çš„@Qualifierï¼‰å¯ä»¥é€šè¿‡javax.inject.Namedå…³è”ã€‚</td></tr><tr><td style="text-align:left;">@Value</td><td>-</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">@Required</td><td>-</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">@Lazy</td><td>-</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">ObjectFactory</td><td>Provider</td><td style="text-align:left;">javax.inject.Provideræ˜¯Springçš„ObjectFactoryçš„ç›´æ¥æ›¿ä»£å“ï¼Œåªæœ‰æ›´çŸ­çš„getï¼ˆï¼‰æ–¹æ³•åç§°ã€‚ å®ƒä¹Ÿå¯ä»¥ä¸Springçš„@Autowiredç»“åˆä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä¸éæ³¨é‡Šçš„æ„é€ å‡½æ•°å’Œsetteræ–¹æ³•ç»“åˆä½¿ç”¨ã€‚</td></tr></tbody></table><h2 id="åŸºäºjavaä»£ç çš„å®¹å™¨é…ç½®" tabindex="-1"><a class="header-anchor" href="#åŸºäºjavaä»£ç çš„å®¹å™¨é…ç½®"><span>åŸºäºjavaä»£ç çš„å®¹å™¨é…ç½®</span></a></h2><h3 id="beanå’Œ-configuration" tabindex="-1"><a class="header-anchor" href="#beanå’Œ-configuration"><span>@Beanå’Œ@Configuration</span></a></h3><p><code>@Bean</code>æ³¨è§£çš„æ–¹æ³•ä¸»è¦ç”¨æ¥æ„å»ºspringå®¹å™¨ç®¡ç†çš„<code>bean</code>,å¯ä»¥åœ¨è¯¥æ–¹æ³•å†…é…ç½®bean.è¢«beanæ³¨é‡Šçš„æ–¹æ³•æ‰€åœ¨çš„ç±»å¯ä»¥è¢«<code>@Component</code>æ³¨è§£,ä½†æ˜¯ä¸€èˆ¬æ˜¯è¢«<code>@Configuration</code>æ³¨è§£.</p><p><code>@Configuration</code>æ³¨è§£æ¥ç”¨æ¥è¡¨æ˜è¯¥ç±»æ˜¯é…ç½®ç±»,æ­¤å¤–ï¼Œ<code>@Configuration</code>ç±»å…è®¸é€šè¿‡è°ƒç”¨åŒä¸€ä¸ªç±»ä¸­çš„å…¶ä»–<code>@Bean</code>æ–¹æ³•æ¥å®šä¹‰beané—´ä¾èµ–å…³ç³»ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">MyService</span> <span class="token function">myService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Full @Configuration vs â€œliteâ€ @Bean mode?</strong></p><p>å¦‚æœ<code>@Bean</code>æ³¨è§£çš„æ–¹æ³•æ‰€åœ¨ç±»æ²¡æœ‰è¢«<code>@Configuration</code>æ³¨è§£,è¢«ç§°ä¸º <code>liteæ¨¡å¼</code>, ä¾‹å¦‚å£°æ˜åœ¨<code>@Component</code>æ³¨è§£çš„ç±».è¿™ç§æ¨¡å¼ä¸‹,ä¸èƒ½ä½¿ç”¨<code>@Bean</code>æ³¨è§£çš„æ–¹æ³•ä½œä¸ºä¾èµ–ã€‚</p><p>åœ¨å¸¸è§çš„åœºæ™¯ä¸­ï¼Œ<code>@Bean</code>æ–¹æ³•å°†åœ¨<code>@Configuration</code>ç±»ä¸­å£°æ˜ï¼Œç¡®ä¿å§‹ç»ˆä½¿ç”¨â€œfullâ€æ¨¡å¼ï¼Œå¹¶å› æ­¤å°†äº¤å‰æ–¹æ³•å¼•ç”¨é‡å®šå‘åˆ°å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚ è¿™å¯ä»¥é˜²æ­¢é€šè¿‡å¸¸è§„Javaè°ƒç”¨æ„å¤–åœ°è°ƒç”¨ç›¸åŒçš„@Beanæ–¹æ³•ï¼Œè¿™æœ‰åŠ©äºå‡å°‘åœ¨â€œliteâ€æ¨¡å¼ä¸‹æ“ä½œæ—¶éš¾ä»¥è·Ÿè¸ªçš„ç»†å¾®é”™è¯¯ã€‚</p><h3 id="ä½¿ç”¨annotationconfigapplicationcontextå®ä¾‹åŒ–å®¹å™¨" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨annotationconfigapplicationcontextå®ä¾‹åŒ–å®¹å™¨"><span>ä½¿ç”¨AnnotationConfigApplicationContextå®ä¾‹åŒ–å®¹å™¨</span></a></h3><p>è¿™ä¸ªå¤šåŠŸèƒ½çš„<code>ApplicationContext</code>å®ç°ä¸ä»…èƒ½å¤Ÿæ¥å—<code>@Configuration</code>ç±»ä½œä¸ºè¾“å…¥ï¼Œè¿˜èƒ½æ¥å—ä½¿ç”¨JSR-330å…ƒæ•°æ®æ³¨è§£å’Œ<code>@Component</code>æ³¨è§£çš„ç±»ã€‚</p><p>å½“<code>@Configuration</code>ç±»ä½œä¸ºè¾“å…¥æä¾›æ—¶ï¼Œ<code>@Consfiguration</code>ç±»æœ¬èº«è¢«æ³¨å†Œä¸ºbeanå®šä¹‰ï¼Œå¹¶ä¸”ç±»ä¸­æ‰€æœ‰å£°æ˜çš„<code>@Bean</code>æ–¹æ³•ä¹Ÿè¢«æ³¨å†Œä¸º<code>bean</code>å®šä¹‰ã€‚</p><p>å½“æä¾›<code>@Component</code>å’ŒJSR-330ç±»æ—¶ï¼Œå®ƒä»¬è¢«æ³¨å†Œä¸ºbeanå®šä¹‰ï¼Œå¹¶ä¸”å‡è®¾è¯¥ç±»çš„å®ä¾‹éœ€è¦ä¾èµ–æ³¨å…¥ã€‚</p><h4 id="ç®€å•çš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç®€å•çš„ä½¿ç”¨"><span>ç®€å•çš„ä½¿ç”¨</span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">AppConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">MyService</span> myService <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">MyService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myService<span class="token punctuation">.</span><span class="token function">doStuff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚å‰æ‰€è¿°ï¼Œ<code>AnnotationConfigApplicationContext</code>ä¸é™äºä½¿ç”¨<code>@Configuration</code>ç±»ã€‚ ä»»ä½•<code>@Component</code>æˆ–JSR-330å¸¦æ³¨é‡Šçš„ç±»éƒ½å¯ä»¥ä½œä¸ºè¾“å…¥æä¾›ç»™æ„é€ å‡½æ•°ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">MyServiceImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Dependency1</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Dependency2</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">MyService</span> myService <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">MyService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myService<span class="token punctuation">.</span><span class="token function">doStuff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨register-class-æ„å»ºå®¹å™¨" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨register-class-æ„å»ºå®¹å™¨"><span>ä½¿ç”¨register(Class&lt;?&gt;â€¦)æ„å»ºå®¹å™¨</span></a></h4><p>æ‚¨å¯ä»¥ä½¿ç”¨no-argæ„é€ å‡½æ•°å®ä¾‹åŒ–<code>AnnotationConfigApplicationContext</code>ï¼Œç„¶åä½¿ç”¨<code>register</code>æ–¹æ³•å¯¹å…¶è¿›è¡Œé…ç½®ã€‚ åœ¨ä»¥ç¼–ç¨‹æ–¹å¼æ„å»º<code>AnnotationConfigApplicationContext</code>æ—¶ï¼Œæ­¤æ–¹æ³•ç‰¹åˆ«æœ‰ç”¨ã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AnnotationConfigApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">AppConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">OtherConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">AdditionalConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">MyService</span> myService <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">MyService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myService<span class="token punctuation">.</span><span class="token function">doStuff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨scan-string-å¯ç”¨ç»„ä»¶æ‰«æ" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨scan-string-å¯ç”¨ç»„ä»¶æ‰«æ"><span>ä½¿ç”¨scan(Stringâ€¦)å¯ç”¨ç»„ä»¶æ‰«æ</span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AnnotationConfigApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span><span class="token string">&quot;com.acme&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">MyService</span> myService <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">MyService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨annotationconfigwebapplicationcontextå¼€å¯webæ”¯æŒ" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨annotationconfigwebapplicationcontextå¼€å¯webæ”¯æŒ"><span>ä½¿ç”¨AnnotationConfigWebApplicationContextå¼€å¯webæ”¯æŒ</span></a></h4><p><code>AnnotationConfigWebApplicationContext</code>æä¾›äº†å¯¹webçš„æ”¯æŒ,é…ç½®Spring <code>ContextLoaderListener </code>servletä¾¦å¬å™¨ï¼ŒSpring MVC <code>DispatcherServlet</code>ç­‰æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ­¤å®ç°ã€‚ ä»¥ä¸‹web.xmlä»£ç æ®µé…ç½®å…¸å‹çš„Spring MVC Webåº”ç”¨ç¨‹åºï¼ˆè¯·æ³¨æ„<code>contextClass ``context-param</code>å’Œ<code>init-param</code>çš„ä½¿ç”¨ï¼‰ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Configure ContextLoaderListener to use AnnotationConfigWebApplicationContext
        instead of the default XmlWebApplicationContext --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context-param</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>contextClass<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>
            org.springframework.web.context.support.AnnotationConfigWebApplicationContext
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context-param</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Configuration locations must consist of one or more comma- or space-delimited
        fully-qualified @Configuration classes. Fully-qualified packages may also be
        specified for component-scanning --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context-param</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>contextConfigLocation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>com.acme.AppConfig<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context-param</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Bootstrap the root application context as usual using ContextLoaderListener --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener-class</span><span class="token punctuation">&gt;</span></span>org.springframework.web.context.ContextLoaderListener<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener-class</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Declare a Spring MVC DispatcherServlet as usual --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>dispatcher<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>org.springframework.web.servlet.DispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- Configure DispatcherServlet to use AnnotationConfigWebApplicationContext
            instead of the default XmlWebApplicationContext --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>contextClass<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>
                org.springframework.web.context.support.AnnotationConfigWebApplicationContext
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- Again, config locations must consist of one or more comma- or space-delimited
            and fully-qualified @Configuration classes --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>contextConfigLocation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>com.acme.web.MvcConfig<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- map all requests for /app/* to the dispatcher servlet --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>dispatcher<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/app/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨-beanæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-beanæ³¨è§£"><span>ä½¿ç”¨@Beanæ³¨è§£</span></a></h3><h4 id="å£°æ˜bean" tabindex="-1"><a class="header-anchor" href="#å£°æ˜bean"><span>å£°æ˜bean</span></a></h4><p>è¦å£°æ˜<code>bean</code>ï¼Œå¯ä»¥ä½¿ç”¨<code>@Bean</code>æ‰¹æ³¨å¯¹æ–¹æ³•è¿›è¡Œæ‰¹æ³¨ã€‚ æ–¹æ³•çš„è¿”å›å€¼æ˜¯æ³¨å†Œ<code>bean</code>çš„ç±»å‹ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>bean</code>åç§°ä¸æ–¹æ³•åç§°ç›¸åŒã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†<code>@Bean</code>æ–¹æ³•å£°æ˜ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TransferServiceImpl</span> <span class="token function">transferService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TransferServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="beanä¾èµ–" tabindex="-1"><a class="header-anchor" href="#beanä¾èµ–"><span>beanä¾èµ–</span></a></h4><p><code>@Bean-annotated</code>æ–¹æ³•å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„å‚æ•°æ¥æè¿°æ„å»ºè¯¥beanæ‰€éœ€çš„ä¾èµ–é¡¹ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬çš„<code>TransferService</code>éœ€è¦<code>AccountRepository</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–¹æ³•å‚æ•°æ¥å®ç°è¯¥ä¾èµ–å…³ç³»ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TransferService</span> <span class="token function">transferService</span><span class="token punctuation">(</span><span class="token class-name">AccountRepository</span> accountRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TransferServiceImpl</span><span class="token punctuation">(</span>accountRepository<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç”Ÿå‘½å‘¨æœŸå›è°ƒ" tabindex="-1"><a class="header-anchor" href="#ç”Ÿå‘½å‘¨æœŸå›è°ƒ"><span>ç”Ÿå‘½å‘¨æœŸå›è°ƒ</span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanOne</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// initialization logic</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanTwo</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// destruction logic</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>initMethod <span class="token operator">=</span> <span class="token string">&quot;init&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">BeanOne</span> <span class="token function">beanOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BeanOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>destroyMethod <span class="token operator">=</span> <span class="token string">&quot;cleanup&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">BeanTwo</span> <span class="token function">beanTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BeanTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºå‰é¢æ³¨é‡Šä¸­ä¸Šé¢ç¤ºä¾‹ä¸­çš„<code>BeanOne</code>ï¼Œåœ¨æ„é€ æœŸé—´ç›´æ¥è°ƒç”¨<code>init</code>æ–¹æ³•åŒæ ·æœ‰æ•ˆï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">BeanOne</span> <span class="token function">beanOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BeanOne</span> beanOne <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        beanOne<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> beanOne<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æŒ‡å®šbeançš„scope" tabindex="-1"><a class="header-anchor" href="#æŒ‡å®šbeançš„scope"><span>æŒ‡å®šbeançš„scope</span></a></h4><p>é»˜è®¤èŒƒå›´æ˜¯å•ä¾‹ï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨<code>@Scope</code>æ‰¹æ³¨è¦†ç›–å®ƒï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfiguration</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@Scope</span><span class="token punctuation">(</span><span class="token string">&quot;prototype&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Encryptor</span> <span class="token function">encryptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨<code>@Scope</code>ä¸Šçš„<code>proxyMode</code>å±æ€§å¯ä»¥è®¾ç½®ä»£ç†æ¨¡å¼ã€‚ é»˜è®¤å€¼ä¸ºæ— ä»£ç†ï¼ˆ<code>ScopedProxyMode.NO</code>ï¼‰ï¼Œä½†æ‚¨å¯ä»¥æŒ‡å®š<code>ScopedProxyMode.TARGET_CLASS</code>æˆ–<code>ScopedProxyMode.INTERFACES</code>ã€‚</p><h4 id="è‡ªå®šä¹‰beançš„åç§°" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰beançš„åç§°"><span>è‡ªå®šä¹‰beançš„åç§°</span></a></h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé…ç½®ç±»ä½¿ç”¨<code>@Bean</code>æ–¹æ³•çš„åç§°ä½œä¸ºç»“æœbeançš„åç§°ã€‚ ä½†æ˜¯ï¼Œå¯ä»¥ä½¿ç”¨nameå±æ€§è¦†ç›–æ­¤åŠŸèƒ½ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;myThing&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Thing</span> <span class="token function">thing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Thing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="beanåˆ«å" tabindex="-1"><a class="header-anchor" href="#beanåˆ«å"><span>beanåˆ«å</span></a></h4><p>æ­£å¦‚Naming Beansä¸­æ‰€è®¨è®ºçš„ï¼Œæœ‰æ—¶éœ€è¦ä¸ºå•ä¸ªbeanæä¾›å¤šä¸ªåç§°ï¼Œä¹Ÿç§°ä¸ºbeanåˆ«åã€‚<code> @Bean</code>æ‰¹æ³¨çš„<code>name</code>å±æ€§ä¸ºæ­¤æ¥å—<code>String</code>æ•°ç»„ã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºå¦‚ä½•ä¸ºbeanè®¾ç½®å¤šä¸ªåˆ«åï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;dataSource&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;subsystemA-dataSource&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;subsystemB-dataSource&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// instantiate, configure and return DataSource bean...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="bean-æè¿°" tabindex="-1"><a class="header-anchor" href="#bean-æè¿°"><span>Bean æè¿°</span></a></h4><p>æœ‰æ—¶ï¼Œæä¾›æ›´è¯¦ç»†çš„beanæ–‡æœ¬æè¿°ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚ å½“beanï¼ˆå¯èƒ½é€šè¿‡JMXï¼‰è¿›è¡Œç›‘è§†æ—¶ï¼Œè¿™å¯èƒ½ç‰¹åˆ«æœ‰ç”¨ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@Description</span><span class="token punctuation">(</span><span class="token string">&quot;Provides a basic example of a bean&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Thing</span> <span class="token function">thing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Thing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨-configurationæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-configurationæ³¨è§£"><span>ä½¿ç”¨@Configurationæ³¨è§£</span></a></h3><h4 id="beanä¾èµ–-1" tabindex="-1"><a class="header-anchor" href="#beanä¾èµ–-1"><span>beanä¾èµ–</span></a></h4><p>å½“beanå½¼æ­¤ä¾èµ–æ—¶ï¼Œè¡¨è¾¾è¯¥ä¾èµ–å…³ç³»å°±åƒè®©ä¸€ä¸ªbeanæ–¹æ³•è°ƒç”¨å¦ä¸€ä¸ªbeanä¸€æ ·ç®€å•ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">BeanOne</span> <span class="token function">beanOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BeanOne</span><span class="token punctuation">(</span><span class="token function">beanTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">BeanTwo</span> <span class="token function">beanTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BeanTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="lookup-method-injection" tabindex="-1"><a class="header-anchor" href="#lookup-method-injection"><span>Lookup Method Injection</span></a></h4><p>Lookup Method Injectionæ˜¯ä¸€é¡¹å¾ˆå°‘ä½¿ç”¨çš„é«˜çº§åŠŸèƒ½,ä¸€èˆ¬ç”¨äºä¸€ä¸ªå•ä¾‹beanä¾èµ–å¤šä¾‹bean.æˆ‘ä»¬æ¥çœ‹ä½¿ç”¨ç¤ºä¾‹:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">CommandManager</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token class-name">Object</span> commandState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// grab a new instance of the appropriate Command interface</span>
        <span class="token class-name">Command</span> command <span class="token operator">=</span> <span class="token function">createCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// set the state on the (hopefully brand new) Command instance</span>
        command<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>commandState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> command<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// okay... but where is the implementation of this method?</span>
    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token class-name">Command</span> <span class="token function">createCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä½¿ç”¨Javaé…ç½®ï¼Œæ‚¨å¯ä»¥åˆ›å»º<code>CommandManager</code>çš„å­ç±»ï¼Œå…¶ä¸­æŠ½è±¡çš„<code>createCommand</code>æ–¹æ³•è¢«è¦†ç›–ï¼Œä»¥ä¾¿æŸ¥æ‰¾æ–°çš„ï¼ˆåŸå‹ï¼‰å‘½ä»¤å¯¹è±¡ã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@Scope</span><span class="token punctuation">(</span><span class="token string">&quot;prototype&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">AsyncCommand</span> <span class="token function">asyncCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AsyncCommand</span> command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AsyncCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// inject dependencies here as required</span>
    <span class="token keyword">return</span> command<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">CommandManager</span> <span class="token function">commandManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// return new anonymous implementation of CommandManager with createCommand()</span>
    <span class="token comment">// overridden to return a new prototype Command object</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommandManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">protected</span> <span class="token class-name">Command</span> <span class="token function">createCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">asyncCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼Œå…¶ä¸­æ˜¾ç¤ºäº†ä¸€ä¸ª@Beanæ³¨é‡Šçš„æ–¹æ³•è¢«è°ƒç”¨ä¸¤æ¬¡ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Bean</span>
	<span class="token keyword">public</span> <span class="token class-name">ClientService</span> <span class="token function">clientService1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">ClientServiceImpl</span> clientService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClientServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		clientService<span class="token punctuation">.</span><span class="token function">setClientDao</span><span class="token punctuation">(</span><span class="token function">clientDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> clientService<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Bean</span>
	<span class="token keyword">public</span> <span class="token class-name">ClientService</span> <span class="token function">clientService2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">ClientServiceImpl</span> clientService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClientServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		clientService<span class="token punctuation">.</span><span class="token function">setClientDao</span><span class="token punctuation">(</span><span class="token function">clientDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> clientService<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Bean</span>
	<span class="token keyword">public</span> <span class="token class-name">ClientDao</span> <span class="token function">clientDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ClientDaoImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨<code>clientService1</code>å’Œ<code>clientService2</code>ä¸­åˆ†åˆ«è°ƒç”¨äº†ä¸€æ¬¡<code>clientDao</code>ã€‚ç”±äºæ­¤æ–¹æ³•åˆ›å»º<code>ClientDaoImpl</code>çš„ä¸€ä¸ªæ–°å®ä¾‹å¹¶è¿”å›å®ƒï¼Œå› æ­¤é€šå¸¸éœ€è¦ä¸¤ä¸ªå®ä¾‹ï¼ˆæ¯ä¸ªæœåŠ¡ä¸€ä¸ªï¼‰ã€‚è¿™è‚¯å®šä¼šæœ‰é—®é¢˜ï¼šåœ¨Springä¸­ï¼Œå®ä¾‹åŒ–çš„beané»˜è®¤æœ‰ä¸€ä¸ªsingletonä½œç”¨åŸŸã€‚è¿™å°±æ˜¯ç¥å¥‡ä¹‹å¤„ï¼šæ‰€æœ‰<code>@Configuration</code>ç±»åœ¨å¯åŠ¨æ—¶éƒ½ä½¿ç”¨<code>CGLIB</code>è¿›è¡Œå­ç±»åŒ–ã€‚åœ¨å­ç±»ä¸­ï¼Œå­æ–¹æ³•åœ¨è°ƒç”¨çˆ¶æ–¹æ³•å¹¶åˆ›å»ºæ–°å®ä¾‹ä¹‹å‰ï¼Œé¦–å…ˆæ£€æŸ¥å®¹å™¨ä¸­æ˜¯å¦æœ‰ä»»ä½•ç¼“å­˜ï¼ˆä½œç”¨åŸŸï¼‰çš„beanã€‚</p><blockquote><p>æ²¡æœ‰å¿…è¦å°†<code>CGLIB</code>æ·»åŠ åˆ°ç±»è·¯å¾„ä¸­ï¼Œå› ä¸º<code>CGLIB</code>ç±»åœ¨<code>org.springframework.CGLIB</code>åŒ…ä¸‹ï¼Œå¹¶ç›´æ¥åŒ…å«åœ¨<code>spring-core.jar</code> ä¸­ã€‚</p></blockquote><p>ç”±äº<code>CGLIB</code>åœ¨å¯åŠ¨æ—¶åŠ¨æ€æ·»åŠ åŠŸèƒ½ï¼Œå› æ­¤å­˜åœ¨ä¸€äº›é™åˆ¶ã€‚ç‰¹åˆ«æ˜¯ï¼Œé…ç½®ç±»ä¸èƒ½æ˜¯<code>final</code>ç±»ã€‚ä½†æ˜¯ï¼Œé…ç½®ç±»ä¸Šå…è®¸ä½¿ç”¨ä»»ä½•æ„é€ å‡½æ•°ï¼ŒåŒ…æ‹¬ä½¿ç”¨<code>@Autowired</code>æˆ–å•ä¸ªéé»˜è®¤æ„é€ å‡½æ•°å£°æ˜è¿›è¡Œé»˜è®¤æ³¨å…¥ã€‚</p><p>å¦‚æœæ‚¨å¸Œæœ›é¿å…ä»»ä½•<code>CGLIB</code>å¼ºåŠ çš„é™åˆ¶ï¼Œè¯·è€ƒè™‘åœ¨é<code>@Configuration</code>ç±»ä¸Šå£°æ˜æ‚¨çš„<code>@Bean</code>æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œæ”¹ä¸ºåœ¨æ™®é€šçš„<code>@Component</code>ç±»ä¸Šï¼‰ï¼Œæˆ–è€…ç”¨<code>@Configuration(proxyBeanMethods=false)</code>æ³¨é‡Šæ‚¨çš„é…ç½®ç±»ã€‚<code>@Bean</code>æ–¹æ³•ä¹‹é—´çš„è·¨æ–¹æ³•è°ƒç”¨ä¸ä¼šè¢«æ‹¦æˆªï¼Œå› æ­¤æ‚¨å¿…é¡»å®Œå…¨ä¾èµ–äºæ„é€ å‡½æ•°æˆ–æ–¹æ³•çº§åˆ«çš„ä¾èµ–æ³¨å…¥ã€‚</p><h3 id="ç»„åˆä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç»„åˆä½¿ç”¨"><span>ç»„åˆä½¿ç”¨</span></a></h3><h4 id="ä½¿ç”¨-importæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-importæ³¨è§£"><span>ä½¿ç”¨@Importæ³¨è§£</span></a></h4><p>å°±åƒåœ¨Spring XMLæ–‡ä»¶ä¸­ä½¿ç”¨<code>&lt;import /&gt;</code>å…ƒç´ æ¥å¸®åŠ©æ¨¡å—åŒ–é…ç½®ä¸€æ ·ï¼Œ<code>@Immort</code>æ³¨é‡Šå…è®¸ä»å¦ä¸€ä¸ªé…ç½®ç±»åŠ è½½<code>@Bean</code>å®šä¹‰ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigA</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">A</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">ConfigA</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigB</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">B</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œåœ¨å®ä¾‹åŒ–ä¸Šä¸‹æ–‡æ—¶ï¼Œä¸éœ€è¦åŒæ—¶æŒ‡å®šConfigA.classå’ŒConfigB.classï¼Œåªéœ€è¦æ˜¾å¼æä¾›ConfigBï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">ConfigB</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// now both beans A and B will be available...</span>
    <span class="token class-name">A</span> a <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">A</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">B</span> b <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">B</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ä»Spring Framework 4.2å¼€å§‹ï¼Œ<code>@Immort</code>è¿˜æ”¯æŒå¼•ç”¨å¸¸è§„ç»„ä»¶ç±»ï¼Œç±»ä¼¼äº<code>AnnotationConfigApplicationContext.register</code>æ–¹æ³•ã€‚ å¦‚æœè¦é¿å…ç»„ä»¶æ‰«æï¼Œè¿™ä¸€ç‚¹ç‰¹åˆ«æœ‰ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›é…ç½®ç±»ä½œä¸ºæ˜ç¡®å®šä¹‰æ‰€æœ‰ç»„ä»¶çš„å…¥å£ç‚¹ã€‚</p></blockquote><p>å‰é¢çš„ä¾‹å­æœ‰æ•ˆï¼Œä½†å¾ˆç®€å•ã€‚ åœ¨å¤§å¤šæ•°å®é™…æƒ…å†µä¸­ï¼Œbeanè·¨é…ç½®ç±»å½¼æ­¤ä¾èµ–ã€‚ ä½¿ç”¨XMLæ—¶ï¼Œè¿™ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºä¸æ¶‰åŠç¼–è¯‘å™¨ï¼Œæ‚¨å¯ä»¥å£°æ˜<code>ref =&quot;someBean&quot;</code>ã€‚ ä½¿ç”¨<code>@Configuration</code>ç±»æ—¶ï¼ŒJavaç¼–è¯‘å™¨ä¼šå¯¹é…ç½®æ¨¡å‹æ–½åŠ çº¦æŸï¼Œå› ä¸ºå¯¹å…¶ä»–<code>bean</code>çš„å¼•ç”¨å¿…é¡»æ˜¯æœ‰æ•ˆçš„<code>Java</code>è¯­æ³•ã€‚</p><p>å¹¸è¿çš„æ˜¯ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ã€‚ æ­£å¦‚æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡çš„ï¼Œ<code>@Bean</code>æ–¹æ³•å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„å‚æ•°æ¥æè¿°beançš„ä¾èµ–å…³ç³»ã€‚ è€ƒè™‘ä»¥ä¸‹æ›´å¤šçœŸå®åœºæ™¯ï¼Œå…¶ä¸­åŒ…å«å‡ ä¸ª<code>@Configuration</code>ç±»ï¼Œæ¯ä¸ªç±»éƒ½ä¾èµ–äºåœ¨å…¶ä»–ç±»ä¸­å£°æ˜çš„beanï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TransferService</span> <span class="token function">transferService</span><span class="token punctuation">(</span><span class="token class-name">AccountRepository</span> accountRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TransferServiceImpl</span><span class="token punctuation">(</span>accountRepository<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RepositoryConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">AccountRepository</span> <span class="token function">accountRepository</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JdbcAccountRepository</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ServiceConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">RepositoryConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SystemTestConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// return new DataSource</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">SystemTestConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// everything wires up across configuration classes...</span>
    <span class="token class-name">TransferService</span> transferService <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">TransferService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    transferService<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span><span class="token number">100.00</span><span class="token punctuation">,</span> <span class="token string">&quot;A123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿˜æœ‰å¦ä¸€ç§æ–¹æ³•å¯ä»¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœã€‚ è¯·è®°ä½ï¼Œ<code>@Configuration</code>ç±»æœ€ç»ˆåªæ˜¯å®¹å™¨ä¸­çš„å¦ä¸€ä¸ªbeanï¼šè¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥åˆ©ç”¨<code>@Autowired</code>å’Œ<code>@Value</code>æ³¨å…¥ä»¥åŠä¸ä»»ä½•å…¶ä»–beanç›¸åŒçš„å…¶ä»–åŠŸèƒ½ã€‚å¦‚ä¸‹é¢çš„ä¾‹å­:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AccountRepository</span> accountRepository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TransferService</span> <span class="token function">transferService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TransferServiceImpl</span><span class="token punctuation">(</span>accountRepository<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RepositoryConfig</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">RepositoryConfig</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dataSource <span class="token operator">=</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">AccountRepository</span> <span class="token function">accountRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JdbcAccountRepository</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ServiceConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">RepositoryConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SystemTestConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// return new DataSource</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">SystemTestConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// everything wires up across configuration classes...</span>
    <span class="token class-name">TransferService</span> transferService <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">TransferService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    transferService<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span><span class="token number">100.00</span><span class="token punctuation">,</span> <span class="token string">&quot;A123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å‰é¢çš„åœºæ™¯ä¸­ï¼Œä½¿ç”¨<code>@Autowired</code>å¯ä»¥å¾ˆå¥½åœ°å·¥ä½œå¹¶æä¾›æ‰€éœ€çš„æ¨¡å—åŒ–ï¼Œä½†ç¡®å®šå£°æ˜è‡ªåŠ¨è£…é…çš„beanå®šä¹‰çš„ç¡®åˆ‡ä½ç½®ä»ç„¶æœ‰äº›æ¨¡æ£±ä¸¤å¯ã€‚ ä¾‹å¦‚ï¼Œä½œä¸ºä¸€åæŸ¥çœ‹<code>ServiceConfig</code>çš„å¼€å‘äººå‘˜ï¼Œæ‚¨å¦‚ä½•ç¡®åˆ‡åœ°çŸ¥é“<code>@Autowired AccountRepository </code>beançš„å£°æ˜ä½ç½®ï¼Ÿ</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RepositoryConfig</span> repositoryConfig<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TransferService</span> <span class="token function">transferService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// navigate &#39;through&#39; the config class to the @Bean method!</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TransferServiceImpl</span><span class="token punctuation">(</span>repositoryConfig<span class="token punctuation">.</span><span class="token function">accountRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å‰é¢çš„æƒ…å†µä¸­ï¼Œå®šä¹‰<code>AccountRepository</code>æ˜¯å®Œå…¨æ˜ç¡®çš„ã€‚ ä½†æ˜¯ï¼Œ<code>ServiceConfig</code>ç°åœ¨ä¸<code>RepositoryConfig</code>ç´§å¯†è€¦åˆã€‚ é€šè¿‡ä½¿ç”¨åŸºäºæ¥å£çš„æˆ–åŸºäºç±»çš„æŠ½è±¡<code>@Configuration</code>ç±»ï¼Œå¯ä»¥åœ¨æŸç§ç¨‹åº¦ä¸Šå‡è½»è¿™ç§ç´§å¯†è€¦åˆã€‚ è¯·è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServiceConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RepositoryConfig</span> repositoryConfig<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TransferService</span> <span class="token function">transferService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TransferServiceImpl</span><span class="token punctuation">(</span>repositoryConfig<span class="token punctuation">.</span><span class="token function">accountRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">RepositoryConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">AccountRepository</span> <span class="token function">accountRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultRepositoryConfig</span> <span class="token keyword">implements</span> <span class="token class-name">RepositoryConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">AccountRepository</span> <span class="token function">accountRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JdbcAccountRepository</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ServiceConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">DefaultRepositoryConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">// import the concrete config!</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SystemTestConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// return DataSource</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">SystemTestConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">TransferService</span> transferService <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">TransferService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    transferService<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span><span class="token number">100.00</span><span class="token punctuation">,</span> <span class="token string">&quot;A123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æœ‰æ¡ä»¶åœ°åŒ…å«-configurationç±»æˆ–-beanæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æœ‰æ¡ä»¶åœ°åŒ…å«-configurationç±»æˆ–-beanæ–¹æ³•"><span>æœ‰æ¡ä»¶åœ°åŒ…å«@Configurationç±»æˆ–@Beanæ–¹æ³•</span></a></h4><p>æœ‰çš„æ—¶å€™ï¼Œæœ‰æ¡ä»¶åœ°å¯ç”¨æˆ–ç¦ç”¨å®Œæ•´çš„<code>@Configuration</code>ç±»ç”šè‡³å•ä¸ª<code>@Bean</code>æ–¹æ³•é€šå¸¸å¾ˆæœ‰ç”¨ã€‚ ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯ï¼Œä½¿ç”¨<code>@Profile</code>æ³¨é‡Šæ¥æ¿€æ´»beanã€‚</p><p><code>@Profile</code>æ³¨é‡Šå®é™…ä¸Šæ˜¯é€šè¿‡ä½¿ç”¨æ›´çµæ´»çš„æ³¨é‡Š<code>@Conditional</code>å®ç°çš„ã€‚ <code>@Conditional</code>æ³¨é‡Šè¡¨ç¤ºåœ¨æ³¨å†Œ<code>@Bean</code>ä¹‹å‰åº”è¯¥å‚è€ƒç‰¹å®š<code>org.springframework.context.annotation.Condition</code>çš„å®ç°ã€‚</p><p><code>Condition</code>æ¥å£çš„å®ç°æä¾›äº†ä¸€ä¸ªè¿”å›<code>true</code>æˆ–<code>false</code>çš„<code>matches</code>æ–¹æ³•ã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹åˆ—è¡¨æ˜¾ç¤ºäº†ç”¨äº<code>@Profile</code>çš„å®é™…<code>Condition</code>å®ç°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">matches</span><span class="token punctuation">(</span><span class="token class-name">ConditionContext</span> context<span class="token punctuation">,</span> <span class="token class-name">AnnotatedTypeMetadata</span> metadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Read the @Profile annotation attributes</span>
        <span class="token class-name">MultiValueMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> attrs <span class="token operator">=</span> metadata<span class="token punctuation">.</span><span class="token function">getAllAnnotationAttributes</span><span class="token punctuation">(</span><span class="token class-name">Profile</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>attrs <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> value <span class="token operator">:</span> attrs<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">acceptsProfiles</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="é…ç½®æ–¹å¼æ··åˆä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#é…ç½®æ–¹å¼æ··åˆä½¿ç”¨"><span>é…ç½®æ–¹å¼æ··åˆä½¿ç”¨</span></a></h4><h5 id="xmlä¸ºä¸»-å…¼ç”¨-configuration-é…ç½®çš„ç±»" tabindex="-1"><a class="header-anchor" href="#xmlä¸ºä¸»-å…¼ç”¨-configuration-é…ç½®çš„ç±»"><span>xmlä¸ºä¸»,å…¼ç”¨@Configuration é…ç½®çš„ç±»</span></a></h5><p><strong>å°†@Configurationç±»å£°æ˜ä¸ºæ™®é€šçš„Spring <code>&lt;bean /&gt;</code>å…ƒç´ </strong></p><p>è¯·è®°ä½ï¼Œ<code>@Configuration</code>ç±»æœ€ç»ˆæ˜¯å®¹å™¨ä¸­çš„beanå®šä¹‰ã€‚ åœ¨æœ¬ç³»åˆ—ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º<code>AppConfig</code>çš„<code>@Configuration</code>ç±»ï¼Œå¹¶å°†å…¶ä½œä¸º<code>&lt;bean /&gt;</code>å®šä¹‰åŒ…å«åœ¨<code>system-test-config.xml</code>ä¸­ã€‚ ç”±äº<code>&lt;contextï¼šannotation-config /&gt;</code>å·²æ‰“å¼€ï¼Œå®¹å™¨ä¼šè¯†åˆ«<code>@Configuration</code>æ‰¹æ³¨å¹¶æ­£ç¡®å¤„ç†<code>AppConfig</code>ä¸­å£°æ˜çš„<code>@Bean</code>æ–¹æ³•ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">AccountRepository</span> <span class="token function">accountRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JdbcAccountRepository</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TransferService</span> <span class="token function">transferService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TransferService</span><span class="token punctuation">(</span><span class="token function">accountRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- enable processing of annotations such as @Autowired and @Configuration --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>annotation-config</span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:/com/acme/jdbc.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.acme.AppConfig<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.jdbc.datasource.DriverManagerDataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.url}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.username}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.password}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:/com/acme/system-test-config.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">TransferService</span> transferService <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">TransferService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä½¿ç”¨<code>&lt;contextï¼šcomponent-scan /&gt;</code>æ¥è·å–@Configurationç±»</strong></p><p>å› ä¸º<code>@Configuration</code>æ˜¯ä½¿ç”¨<code>@Component</code>è¿›è¡Œå…ƒæ³¨é‡Šçš„ï¼Œæ‰€ä»¥<code>@Configuration-annotated</code>ç±»è‡ªåŠ¨æˆä¸ºç»„ä»¶æ‰«æçš„å€™é€‰è€…ã€‚ ä½¿ç”¨ä¸å‰ä¸€ä¸ªç¤ºä¾‹ä¸­æè¿°çš„ç›¸åŒçš„æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°å®šä¹‰<code>system-test-config.xml</code>ä»¥åˆ©ç”¨ç»„ä»¶æ‰«æã€‚ è¯·æ³¨æ„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ˜¾å¼å£°æ˜<code>&lt;contextï¼šannotation-config /&gt;</code>ï¼Œå› ä¸º<code>&lt;contextï¼šcomponent-scan /&gt;</code>å¯ç”¨ç›¸åŒçš„åŠŸèƒ½:</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- picks up and registers AppConfig as a bean definition --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.acme<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:/com/acme/jdbc.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.jdbc.datasource.DriverManagerDataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.url}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.username}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.password}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>@Configurationä¸ºä¸»,å…¼ç”¨XML</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ImportResource</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:/com/acme/properties-config.xml&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${jdbc.url}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${jdbc.username}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${jdbc.password}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DriverManagerDataSource</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:/com/acme/jdbc.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">AppConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">TransferService</span> transferService <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">TransferService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç¯å¢ƒæŠ½è±¡" tabindex="-1"><a class="header-anchor" href="#ç¯å¢ƒæŠ½è±¡"><span>ç¯å¢ƒæŠ½è±¡</span></a></h2><p><code>Environment</code>æ¥å£æ˜¯é›†æˆåœ¨å®¹å™¨ä¸­çš„æŠ½è±¡ï¼Œå®ƒæ¨¡æ‹Ÿäº†åº”ç”¨ç¨‹åºç¯å¢ƒçš„ä¸¤ä¸ªå…³é”®æ–¹é¢ï¼šé…ç½®æ–‡ä»¶å’Œå±æ€§ã€‚</p><h3 id="ä½¿ç”¨-profile" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-profile"><span>ä½¿ç”¨@Profile</span></a></h3><p><code>@Profile</code>æ³¨é‡Šå…è®¸æ‚¨æŒ‡ç¤ºå½“ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šçš„é…ç½®æ–‡ä»¶å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œç»„ä»¶ç¬¦åˆæ³¨å†Œæ¡ä»¶ã€‚ ä½¿ç”¨å‰é¢çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é‡å†™<code>dataSource</code>é…ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;development&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StandaloneDataConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">EmbeddedDatabaseBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">EmbeddedDatabaseType</span><span class="token punctuation">.</span><span class="token constant">HSQL</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:com/bank/config/sql/schema.sql&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:com/bank/config/sql/test-data.sql&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;production&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JndiDataConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>destroyMethod<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Context</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InitialContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">DataSource</span><span class="token punctuation">)</span> ctx<span class="token punctuation">.</span><span class="token function">lookup</span><span class="token punctuation">(</span><span class="token string">&quot;java:comp/env/jdbc/datasource&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>valueæ”¯æŒè¡¨è¾¾å¼:</p><ol><li><code>!</code>: A logical â€œnotâ€ of the profile</li><li><code>&amp;</code>: A logical â€œandâ€ of the profiles</li><li><code>|</code>: A logical â€œorâ€ of the profiles</li></ol><p>å¦‚æœä½¿ç”¨<code>@Profile</code>æ ‡è®°<code>@Configuration</code>ç±»ï¼Œåˆ™é™¤éä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šçš„é…ç½®æ–‡ä»¶å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œå¦åˆ™å°†ç»•è¿‡ä¸è¯¥ç±»å…³è”çš„æ‰€æœ‰<code>@Bean</code>æ–¹æ³•å’Œ<code>@Import</code>æ³¨é‡Šã€‚ å¦‚æœä½¿ç”¨<code>@Profile({&quot;p1&quot;ï¼Œ&quot;p2&quot;})</code>æ ‡è®°<code>@Component</code>æˆ–<code>@Configuration</code>ç±»ï¼Œåˆ™é™¤éå·²æ¿€æ´»é…ç½®æ–‡ä»¶<code>p1</code>æˆ–<code>p2</code>ï¼Œå¦åˆ™ä¸ä¼šæ³¨å†Œæˆ–å¤„ç†è¯¥ç±»ã€‚ å¦‚æœç»™å®šçš„é…ç½®æ–‡ä»¶ä»¥<code>NOT</code>è¿ç®—ç¬¦ï¼ˆ<code>ï¼</code>ï¼‰ä½œä¸ºå‰ç¼€ï¼Œåˆ™ä»…åœ¨é…ç½®æ–‡ä»¶æœªæ¿€æ´»æ—¶æ‰æ³¨å†Œå¸¦æ³¨é‡Šçš„å…ƒç´ ã€‚ ä¾‹å¦‚ï¼Œç»™å®š<code>@Profile({&quot;p1&quot;ï¼Œ&quot;ï¼p2&quot;})</code>ï¼Œå¦‚æœé…ç½®æ–‡ä»¶â€œp1â€å¤„äºæ´»åŠ¨çŠ¶æ€æˆ–é…ç½®æ–‡ä»¶â€œp2â€æœªæ¿€æ´»ï¼Œåˆ™ä¼šè¿›è¡Œæ³¨å†Œã€‚</p><p>@Profileæ˜¯ä¸€ä¸ªå…ƒæ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;production&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Production</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>prifleä¹Ÿå¯ä»¥è¢«å£°æ˜åœ¨æ–¹æ³•çº§åˆ«:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;dataSource&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;development&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">standaloneDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">EmbeddedDatabaseBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">EmbeddedDatabaseType</span><span class="token punctuation">.</span><span class="token constant">HSQL</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:com/bank/config/sql/schema.sql&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:com/bank/config/sql/test-data.sql&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;dataSource&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;production&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">jndiDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Context</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InitialContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">DataSource</span><span class="token punctuation">)</span> ctx<span class="token punctuation">.</span><span class="token function">lookup</span><span class="token punctuation">(</span><span class="token string">&quot;java:comp/env/jdbc/datasource&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ¿€æ´»profile" tabindex="-1"><a class="header-anchor" href="#æ¿€æ´»profile"><span>æ¿€æ´»Profile</span></a></h4><p>æ¿€æ´»é…ç½®æ–‡ä»¶å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®Œæˆï¼Œä½†æœ€ç›´æ¥çš„æ–¹æ³•æ˜¯ä»¥ç¼–ç¨‹æ–¹å¼å¯¹å¯é€šè¿‡<code>ApplicationContext</code>æä¾›çš„<code>Environment </code>APIè¿›è¡Œæ“ä½œã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">AnnotationConfigApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setActiveProfiles</span><span class="token punctuation">(</span><span class="token string">&quot;development&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">SomeConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">StandaloneDataConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">JndiDataConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥é€šè¿‡<code>spring.profiles.active</code>å±æ€§å£°æ˜æ€§åœ°æ¿€æ´»é…ç½®æ–‡ä»¶ï¼Œè¯¥å±æ€§å¯ä»¥é€šè¿‡ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼ŒJVMç³»ç»Ÿå±æ€§ï¼Œweb.xmlä¸­çš„servletä¸Šä¸‹æ–‡å‚æ•°æˆ–ç”šè‡³ä½œä¸ºJNDIä¸­çš„æ¡ç›®æ¥æŒ‡å®šã€‚ åœ¨é›†æˆæµ‹è¯•ä¸­ï¼Œå¯ä»¥ä½¿ç”¨spring-testæ¨¡å—ä¸­çš„<code>@ActiveProfiles</code>æ‰¹æ³¨å£°æ˜æ¿€æ´»é…ç½®æ–‡ä»¶ï¼ˆè¯·å‚é˜…å…·æœ‰ç¯å¢ƒé…ç½®æ–‡ä»¶çš„ä¸Šä¸‹æ–‡é…ç½®ï¼‰ã€‚</p><p>è¯·æ³¨æ„ï¼Œé…ç½®æ–‡ä»¶ä¸æ˜¯â€œeither-orâ€å‘½é¢˜ã€‚ æ‚¨å¯ä»¥ä¸€æ¬¡æ¿€æ´»å¤šä¸ªé…ç½®æ–‡ä»¶ã€‚ ä»¥ç¼–ç¨‹æ–¹å¼ï¼Œæ‚¨å¯ä»¥ä¸º<code>setActiveProfiles</code>æ–¹æ³•æä¾›å¤šä¸ªé…ç½®æ–‡ä»¶åç§°ï¼Œè¯¥æ–¹æ³•æ¥å—<code>String â€¦ varargs</code>ã€‚ ä»¥ä¸‹ç¤ºä¾‹æ¿€æ´»å¤šä¸ªé…ç½®æ–‡ä»¶ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code>ctx<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setActiveProfiles</span><span class="token punctuation">(</span><span class="token string">&quot;profile1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;profile2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>spring.profiles.active</code>å±æ€§æ¥å—ä»¥é€—å·åˆ†éš”çš„åˆ—è¡¨:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token parameter variable">-Dspring.profiles.active</span><span class="token operator">=</span><span class="token string">&quot;profile1,profile2&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="é»˜è®¤profile" tabindex="-1"><a class="header-anchor" href="#é»˜è®¤profile"><span>é»˜è®¤Profile</span></a></h4><p>è¡¨ç¤ºé»˜è®¤å¯ç”¨çš„é…ç½®æ–‡ä»¶ã€‚ è¯·è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultDataConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">EmbeddedDatabaseBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">EmbeddedDatabaseType</span><span class="token punctuation">.</span><span class="token constant">HSQL</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addScript</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:com/bank/config/sql/schema.sql&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ²¡æœ‰æ¿€æ´»é…ç½®æ–‡ä»¶ï¼Œåˆ™åˆ›å»º<code>dataSource</code>ã€‚ æ‚¨å¯ä»¥å°†æ­¤è§†ä¸ºä¸€ç§ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªbeanæä¾›é»˜è®¤å®šä¹‰çš„æ–¹æ³•ã€‚ å¦‚æœå¯ç”¨äº†ä»»ä½•é…ç½®æ–‡ä»¶ï¼Œåˆ™é»˜è®¤é…ç½®æ–‡ä»¶ä¸é€‚ç”¨ã€‚</p><p>æ‚¨å¯ä»¥ä½¿ç”¨ç¯å¢ƒä¸Šçš„<code>setDefaultProfiles</code>æˆ–å£°æ˜æ€§åœ°ä½¿ç”¨<code>spring.profiles.default</code>å±æ€§æ›´æ”¹é»˜è®¤é…ç½®æ–‡ä»¶çš„åç§°ã€‚</p><h3 id="propertysource-æŠ½è±¡" tabindex="-1"><a class="header-anchor" href="#propertysource-æŠ½è±¡"><span>PropertySource æŠ½è±¡</span></a></h3><p>Springçš„<code>Environment</code>æŠ½è±¡é€šè¿‡å¯é…ç½®çš„å±æ€§æºå±‚æ¬¡ç»“æ„æä¾›æœç´¢æ“ä½œã€‚ è¯·è€ƒè™‘ä»¥ä¸‹åˆ—è¡¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GenericApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Environment</span> env <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">boolean</span> containsMyProperty <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">containsProperty</span><span class="token punctuation">(</span><span class="token string">&quot;my-property&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Does my environment contain the &#39;my-property&#39; property? &quot;</span> <span class="token operator">+</span> containsMyProperty<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å‰é¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸€ç§å‘Springè¯¢é—®my-propertyå±æ€§æ˜¯å¦ä¸ºå½“å‰ç¯å¢ƒå®šä¹‰çš„é«˜çº§æ–¹æ³•ã€‚ è¦å›ç­”æ­¤é—®é¢˜ï¼Œ<code>Environment</code>å¯¹è±¡ä¼šå¯¹ä¸€ç»„<code>PropertySource</code>å¯¹è±¡æ‰§è¡Œæœç´¢ã€‚ <code>PropertySource</code>æ˜¯å¯¹ä»»ä½•é”®å€¼å¯¹æºçš„ç®€å•æŠ½è±¡ï¼ŒSpringçš„<code>StandardEnvironment</code>é…ç½®æœ‰ä¸¤ä¸ª<code>PropertySource</code>å¯¹è±¡ - ä¸€ä¸ªè¡¨ç¤ºJVMç³»ç»Ÿå±æ€§é›†(<code>System.getProperties()</code>)ï¼Œå¦ä¸€ä¸ªè¡¨ç¤ºç³»ç»Ÿç¯å¢ƒå˜é‡é›†ï¼ˆ<code>System.getenv()</code>ï¼‰ã€‚</p><p>å…·ä½“åœ°è¯´ï¼Œå½“æ‚¨ä½¿ç”¨<code>StandardEnvironment</code>æ—¶ï¼Œå¦‚æœåœ¨è¿è¡Œæ—¶å­˜åœ¨my-propertyç³»ç»Ÿå±æ€§æˆ–my-propertyç¯å¢ƒå˜é‡ï¼Œåˆ™å¯¹env.containsPropertyï¼ˆâ€œmy-propertyâ€ï¼‰çš„è°ƒç”¨å°†è¿”å›trueã€‚</p><p>æ‰§è¡Œçš„æœç´¢æ˜¯åˆ†å±‚çš„ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œç³»ç»Ÿå±æ€§ä¼˜å…ˆäºç¯å¢ƒå˜é‡ã€‚ å› æ­¤ï¼Œå¦‚æœåœ¨è°ƒç”¨env.getPropertyï¼ˆâ€œmy-propertyâ€ï¼‰æœŸé—´ç¢°å·§åœ¨ä¸¤ä¸ªä½ç½®éƒ½è®¾ç½®äº†my-propertyå±æ€§ï¼Œåˆ™ç³»ç»Ÿå±æ€§å€¼â€œwinsâ€å¹¶è¿”å›ã€‚ è¯·æ³¨æ„ï¼Œå±æ€§å€¼ä¸ä¼šåˆå¹¶ï¼Œè€Œæ˜¯ç”±å‰é¢çš„æ¡ç›®å®Œå…¨è¦†ç›–ã€‚</p><p>å¯¹äºå¸¸è§çš„<code>StandardServletEnvironment</code>ï¼Œå®Œæ•´å±‚æ¬¡ç»“æ„å¦‚ä¸‹ï¼Œä¼˜å…ˆçº§ä»é«˜å¾€ä¸‹ï¼š</p><ol><li>ServletConfigå‚æ•°ï¼ˆå¦‚æœé€‚ç”¨ - ä¾‹å¦‚ï¼Œåœ¨DispatcherServletä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹ï¼‰</li><li>ServletContextå‚æ•°ï¼ˆweb.xml context-paramæ¡ç›®ï¼‰</li><li>JNDIç¯å¢ƒå˜é‡ï¼ˆjavaï¼šcomp / env / entriesï¼‰</li><li>JVMç³»ç»Ÿå±æ€§ï¼ˆ-Då‘½ä»¤è¡Œå‚æ•°ï¼‰</li><li>JVMç³»ç»Ÿç¯å¢ƒï¼ˆæ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡ï¼‰</li></ol><p>æœ€é‡è¦çš„æ˜¯ï¼Œæ•´ä¸ªæœºåˆ¶æ˜¯å¯é…ç½®çš„ã€‚ æ‚¨å¯èƒ½å¸Œæœ›å°†è‡ªå®šä¹‰çš„å±æ€§æºé›†æˆåˆ°æ­¤æœç´¢ä¸­ã€‚ ä¸ºæ­¤ï¼Œè¯·å®ç°å¹¶å®ä¾‹åŒ–æ‚¨è‡ªå·±çš„<code>PropertySource</code>ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°å½“å‰<code>Environment</code>çš„<code>PropertySource</code>é›†åˆä¸­ã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">ConfigurableApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GenericApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">MutablePropertySources</span> sources <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPropertySources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sources<span class="token punctuation">.</span><span class="token function">addFirst</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyPropertySource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>MyPropertySource</code>åœ¨æœç´¢ä¸­æ·»åŠ äº†æœ€é«˜ä¼˜å…ˆçº§ã€‚ å¦‚æœå®ƒåŒ…å«<code>my-property</code>å±æ€§ï¼Œåˆ™æ£€æµ‹å¹¶è¿”å›è¯¥å±æ€§ï¼Œä»¥æ”¯æŒä»»ä½•å…¶ä»–<code>PropertySource</code>ä¸­çš„ä»»ä½•<code>my-property</code>å±æ€§ã€‚ <code>MutablePropertySources </code>APIå…¬å¼€äº†è®¸å¤šæ–¹æ³•ï¼Œå…è®¸ç²¾ç¡®æ“ä½œå±æ€§æºé›†ã€‚</p><h3 id="ä½¿ç”¨-propertysource" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-propertysource"><span>ä½¿ç”¨@PropertySource</span></a></h3><p><code>@PropertySource</code>æ³¨é‡Šæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„å£°æ˜å¼æœºåˆ¶ï¼Œç”¨äºå‘Springçš„ç¯å¢ƒæ·»åŠ <code>PropertySource</code>ã€‚</p><p>ç»™å®šä¸€ä¸ªåä¸º<code>app.properties</code>çš„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«é”®å€¼å¯¹<code>testbean.name = myTestBean</code>ï¼Œä»¥ä¸‹<code>@Configuration</code>ç±»ä½¿ç”¨<code>@PropertySource</code>ï¼Œä»¥ä¾¿è°ƒç”¨<code>testBean.getName</code>è¿”å›<code>myTestBean</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@PropertySource</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:/com/myco/app.properties&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">Environment</span> env<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TestBean</span> <span class="token function">testBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TestBean</span> testBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        testBean<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;testbean.name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> testBean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>@PropertySource</code>èµ„æºä½ç½®ä¸­å­˜åœ¨çš„ä»»ä½•<code>$ {â€¦}</code>å ä½ç¬¦å°†æ ¹æ®å·²é’ˆå¯¹ç¯å¢ƒæ³¨å†Œçš„å±æ€§æºé›†è¿›è¡Œè§£æï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@PropertySource</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:/com/${my.placeholder:default/path}/app.properties&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">Environment</span> env<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TestBean</span> <span class="token function">testBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TestBean</span> testBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        testBean<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;testbean.name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> testBean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‡è®¾<code>my.placeholder</code>å­˜åœ¨äºå·²æ³¨å†Œçš„å…¶ä¸­ä¸€ä¸ªå±æ€§æºä¸­ï¼ˆä¾‹å¦‚ï¼Œç³»ç»Ÿå±æ€§æˆ–ç¯å¢ƒå˜é‡ï¼‰ï¼Œåˆ™å ä½ç¬¦å°†è§£æä¸ºç›¸åº”çš„å€¼ã€‚ å¦‚æœä¸æ˜¯ï¼Œåˆ™<code>/path</code>ç”¨ä½œé»˜è®¤å€¼ã€‚ å¦‚æœæœªæŒ‡å®šç¼ºçœå€¼ä¸”æ— æ³•è§£æå±æ€§ï¼Œåˆ™æŠ›å‡º<code>IllegalArgumentException</code>ã€‚</p><h2 id="æ³¨å†Œloadtimeweaver" tabindex="-1"><a class="header-anchor" href="#æ³¨å†Œloadtimeweaver"><span>æ³¨å†ŒLoadTimeWeaver</span></a></h2><p>Springä½¿ç”¨LoadTimeWeaveråœ¨å°†ç±»åŠ è½½åˆ°Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰æ—¶åŠ¨æ€è½¬æ¢ç±»ã€‚è¦å¯ç”¨åŠ è½½æ—¶ç»‡å…¥ï¼Œå¯ä»¥å°†@EnableLoadTimeWeavingæ·»åŠ åˆ°å…¶ä¸­ä¸€ä¸ª@Configurationç±»ä¸­ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableLoadTimeWeaving</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>xmlé…ç½®æ–¹å¼:</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>load-time-weaver</span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸€æ—¦ä¸º<code>ApplicationContext</code>é…ç½®ï¼Œè¯¥<code>ApplicationContext</code>ä¸­çš„ä»»ä½•beanéƒ½å¯ä»¥å®ç°<code>LoadTimeWeaverAware</code>ï¼Œä»è€Œæ¥æ”¶å¯¹load-time weaverå®ä¾‹çš„å¼•ç”¨ã€‚ è¿™ä¸Springçš„JPAæ”¯æŒç»“åˆä½¿ç”¨ç‰¹åˆ«æœ‰ç”¨ï¼Œå…¶ä¸­JPAç±»è½¬æ¢å¯èƒ½éœ€è¦åŠ è½½æ—¶ç»‡å…¥ã€‚ æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<code>LocalContainerEntityManagerFactoryBean </code>javadocã€‚ æœ‰å…³AspectJåŠ è½½æ—¶ç»‡å…¥çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…Spring Frameworkä¸­ä½¿ç”¨AspectJçš„åŠ è½½æ—¶ç¼–ç»‡ã€‚</p><h2 id="applicationcontextçš„é™„åŠ åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#applicationcontextçš„é™„åŠ åŠŸèƒ½"><span>ApplicationContextçš„é™„åŠ åŠŸèƒ½</span></a></h2><p>æ­£å¦‚åœ¨ç« èŠ‚ä»‹ç»ä¸­è®¨è®ºçš„é‚£æ ·ï¼Œ<code>org.springframework.beans.factory</code>åŒ…æä¾›äº†ç”¨äºç®¡ç†å’Œæ“ä½œbeançš„åŸºæœ¬åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä»¥ç¼–ç¨‹çš„æ–¹å¼ã€‚<code>org.springframework.context</code>åŒ…æ·»åŠ äº†<code>ApplicationContext</code>æ¥å£ï¼Œè¯¥æ¥å£æ‰©å±•äº†<code>BeanFactory</code>æ¥å£ï¼Œè¿˜æ‰©å±•å…¶ä»–æ¥å£ä»¥æä¾›æ›´å¤šåº”ç”¨ç¨‹åºæ¡†æ¶å¯¼å‘é£æ ¼çš„é™„åŠ åŠŸèƒ½ã€‚è®¸å¤šäººä»¥å®Œå…¨å£°æ˜çš„æ–¹å¼ä½¿ç”¨<code>ApplicationContext</code>ï¼Œç”šè‡³æ²¡æœ‰ä»¥ç¼–ç¨‹æ–¹å¼åˆ›å»ºå®ƒï¼Œè€Œæ˜¯ä¾èµ–æ”¯æŒç±»ï¼ˆå¦‚<code>ContextLoader</code>ï¼‰è‡ªåŠ¨å®ä¾‹åŒ–<code>ApplicationContext</code>ï¼Œä½œä¸ºJava EE Webåº”ç”¨ç¨‹åºæ­£å¸¸å¯åŠ¨è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚</p><p>ä¸ºäº†ä»¥æ›´åŠ é¢å‘æ¡†æ¶çš„é£æ ¼å¢å¼ºBeanFactoryåŠŸèƒ½ï¼Œä¸Šä¸‹æ–‡åŒ…è¿˜æä¾›äº†ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>é€šè¿‡<code>MessageSource</code>æ¥å£ä»¥i18né£æ ¼è®¿é—®æ¶ˆæ¯ã€‚</li><li>é€šè¿‡<code>ResourceLoader</code>æ¥å£è®¿é—®èµ„æºï¼Œå¦‚URLå’Œæ–‡ä»¶ã€‚</li><li>é€šè¿‡ä½¿ç”¨<code>ApplicationEventPublisher</code>æ¥å£å°†äº‹ä»¶å‘å¸ƒåˆ°å®ç°<code>ApplicationListener</code>æ¥å£çš„beanã€‚</li><li>åŠ è½½å¤šä¸ªï¼ˆåˆ†å±‚ï¼‰ä¸Šä¸‹æ–‡ï¼Œå…è®¸æ¯ä¸ªä¸Šä¸‹æ–‡é€šè¿‡<code>HierarchicalBeanFactory</code>æ¥å£é›†ä¸­åœ¨ä¸€ä¸ªç‰¹å®šå±‚ä¸Šï¼Œä¾‹å¦‚åº”ç”¨ç¨‹åºçš„Webå±‚ã€‚</li></ul><h3 id="ä½¿ç”¨messagesourceè¿›è¡Œå›½é™…åŒ–" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨messagesourceè¿›è¡Œå›½é™…åŒ–"><span>ä½¿ç”¨MessageSourceè¿›è¡Œå›½é™…åŒ–</span></a></h3><p><code>ApplicationContext</code>æ¥å£æ‰©å±•äº†ä¸€ä¸ªåä¸º<code>MessageSource</code>çš„æ¥å£ï¼Œå› æ­¤æä¾›äº†å›½é™…åŒ–ï¼ˆi18nï¼‰åŠŸèƒ½ã€‚Springè¿˜æä¾›æ¥å£<code>HierarchicalMessageSource</code>ï¼Œå®ƒå¯ä»¥åˆ†å±‚è§£ææ¶ˆæ¯ã€‚ è¿™äº›æ¥å£ä¸€èµ·ä¸ºSpringæ¶ˆæ¯è§£ææä¾›äº†åŸºç¡€ã€‚ è¿™äº›æ¥å£ä¸Šå®šä¹‰çš„æ–¹æ³•åŒ…æ‹¬ï¼š</p><ul><li><code>String getMessage(String code, Object[] args, String default, Locale loc)</code>:ç”¨äºä»<code>MessageSource</code>ä¸­æ£€ç´¢æ¶ˆæ¯çš„åŸºæœ¬æ–¹æ³•ã€‚å¦‚æœæœªæ‰¾åˆ°æŒ‡å®šè¯­è¨€ç¯å¢ƒçš„æ¶ˆæ¯ï¼Œåˆ™ä½¿ç”¨é»˜è®¤æ¶ˆæ¯ã€‚ä½¿ç”¨æ ‡å‡†åº“æä¾›çš„<code>MessageFormat</code>åŠŸèƒ½ï¼Œä¼ å…¥çš„ä»»ä½•å‚æ•°éƒ½å°†æˆä¸ºæ›¿æ¢å€¼ã€‚</li><li><code>String getMessage(String code, Object[] args, Locale loc)</code>:ä¸å‰é¢çš„æ–¹æ³•åŸºæœ¬ç›¸åŒï¼Œä½†æœ‰ä¸€ç‚¹ä¸åŒï¼šä¸èƒ½æŒ‡å®šé»˜è®¤æ¶ˆæ¯;å¦‚æœæ¶ˆæ¯æ— æ³•æ‰¾åˆ°ï¼Œåˆ™æŠ›å‡ºNoSuchMessageExceptionã€‚</li><li><code>String getMessage(MessageSourceResolvable resolvable, Locale locale)</code>:å‰é¢æ–¹æ³•ä¸­ä½¿ç”¨çš„æ‰€æœ‰å±æ€§ä¹Ÿéƒ½åŒ…å«åœ¨ä¸€ä¸ªåä¸ºMessageSourceResolvableçš„ç±»ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•ã€‚</li></ul><p>å½“åŠ è½½ä¸€ä¸ª<code>ApplicationContext</code>æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æœç´¢åœ¨ä¸Šä¸‹æ–‡ä¸­å®šä¹‰çš„<code>MessageSource </code>beanã€‚ è¯¥beanå¿…é¡»å…·æœ‰åç§°<code>messageSource</code>ã€‚ å¦‚æœæ‰¾åˆ°è¿™æ ·çš„ä¸€ä¸ªbeanï¼Œæ‰€æœ‰å¯¹å‰é¢æ–¹æ³•çš„è°ƒç”¨éƒ½è¢«å§”æ‰˜ç»™<code>MessageSource</code>ã€‚å¦‚æœæ‰¾ä¸åˆ°<code>MessageSource</code>ï¼Œåˆ™<code>ApplicationContext</code>å°†å°è¯•æŸ¥æ‰¾åŒ…å«å…·æœ‰ç›¸åŒåç§°çš„beançš„çˆ¶ä»£ã€‚ å¦‚æœæœ‰ï¼Œå®ƒå°†ä½¿ç”¨è¯¥Beanä½œä¸º<code>MessageSource</code>ã€‚å¦‚æœApplicationContextæ‰¾ä¸åˆ°ä»»ä½•<code>MessageSource</code>ï¼Œåˆ™ä¼šå®ä¾‹åŒ–ä¸€ä¸ªç©ºçš„<code>DelegatingMessageSource</code>ï¼Œä»¥ä¾¿èƒ½å¤Ÿæ¥å—å¯¹ä¸Šé¢å®šä¹‰çš„æ–¹æ³•çš„è°ƒç”¨ã€‚</p><p>Springæä¾›äº†ä¸¤ä¸ª<code>MessageSource</code>å®ç°ï¼Œ<code>ResourceBundleMessageSource</code>å’Œ<code>StaticMessageSource</code>ã€‚ ä¸¤è€…éƒ½å®ç°<code>HierarchicalMessageSource</code>ä»¥è¿›è¡ŒåµŒå¥—æ¶ˆæ¯ä¼ é€’ã€‚ <code>StaticMessageSource</code>å¾ˆå°‘ä½¿ç”¨ï¼Œä½†æä¾›äº†ç¼–ç¨‹æ–¹å¼å°†æ¶ˆæ¯æ·»åŠ åˆ°æºä»£ç ä¸­ã€‚ ä»¥ä¸‹ç¤ºä¾‹ä¸­æ˜¾ç¤ºäº†<code>ResourceBundleMessageSource</code>ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>messageSource<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.context.support.ResourceBundleMessageSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>basenames<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>format<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>exceptions<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>windows<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡è®¾ä½ åœ¨ä½ çš„ç±»è·¯å¾„ä¸­å®šä¹‰äº†ä¸‰ä¸ªåä¸º<code>format</code>ï¼Œ<code>exceptions</code>å’Œ<code>windows</code>çš„èµ„æºåŒ…ã€‚ ä»»ä½•è§£ææ¶ˆæ¯çš„è¯·æ±‚éƒ½å°†ä»¥é€šè¿‡<code>ResourceBundles</code>è§£ææ¶ˆæ¯çš„JDKæ ‡å‡†æ–¹å¼è¿›è¡Œå¤„ç†ã€‚ å‡ºäºç¤ºä¾‹çš„ç›®çš„ï¼Œå‡è®¾ä¸Šè¿°ä¸¤ä¸ªèµ„æºåŒ…æ–‡ä»¶çš„å†…å®¹æ˜¯â€¦â€¦</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code># in format.properties
message=Alligators rock!
# in exceptions.properties
argument.required=The {0} argument is required.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹ä¸€ä¸ªç¤ºä¾‹ä¸­æ˜¾ç¤ºäº†æ‰§è¡Œ<code>MessageSource</code>åŠŸèƒ½çš„ç¨‹åºã€‚ è¯·è®°ä½ï¼Œæ‰€æœ‰<code>ApplicationContext</code>å®ç°ä¹Ÿéƒ½æ˜¯<code>MessageSource</code>å®ç°ï¼Œå› æ­¤å¯ä»¥è½¬æ¢ä¸º<code>MessageSource</code>æ¥å£ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">MessageSource</span> resources <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;beans.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> message <span class="token operator">=</span> resources<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;Default&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ä¸Šè¿°ç¨‹åºäº§ç”Ÿçš„è¾“å‡ºå°†æ˜¯â€¦</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>Alligators rock!
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ€»è€Œè¨€ä¹‹ï¼Œ<code>MessageSource</code>è¢«å®šä¹‰åœ¨åä¸º<code>beans.xml</code>çš„æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶å­˜åœ¨äºæ‚¨çš„ç±»è·¯å¾„çš„æ ¹ç›®å½•ä¸­ã€‚ <code>messageSource </code>beanå®šä¹‰é€šè¿‡å…¶åŸºæœ¬åç§°å±æ€§å¼•ç”¨è®¸å¤šèµ„æºåŒ…ã€‚åœ¨åˆ—è¡¨ä¸­ä¼ é€’ç»™åŸºæœ¬åç§°å±æ€§çš„ä¸‰ä¸ªæ–‡ä»¶ä½œä¸ºæ–‡ä»¶å­˜åœ¨äºç±»è·¯å¾„çš„æ ¹ç›®å½•ä¸­ï¼Œåˆ†åˆ«ç§°ä¸º<code>format.properties</code>ï¼Œ<code>exceptions.properties</code>å’Œ<code>windows.properties</code>ã€‚</p><p>ä¸‹ä¸€ä¸ªç¤ºä¾‹æ˜¾ç¤ºä¼ é€’ç»™æ¶ˆæ¯æŸ¥æ‰¾çš„å‚æ•°; è¿™äº›å‚æ•°å°†è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶æ’å…¥æŸ¥æ‰¾æ¶ˆæ¯ä¸­çš„å ä½ç¬¦ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- this MessageSource is being used in a web application --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>messageSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.context.support.ResourceBundleMessageSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>basename<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>exceptions<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- lets inject the above MessageSource into this POJO --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>example<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.foo.Example<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>messages<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>messageSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">MessageSource</span> messages<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMessages</span><span class="token punctuation">(</span><span class="token class-name">MessageSource</span> messages<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>messages <span class="token operator">=</span> messages<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>messages<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token string">&quot;argument.required&quot;</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">Object</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token string">&quot;userDao&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;Required&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è°ƒç”¨<code>execute</code>æ–¹æ³•çš„ç»“æœè¾“å‡ºå°†æ˜¯â€¦</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>The userDao argument is required.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å…³äºå›½é™…åŒ–ï¼ˆi18nï¼‰ï¼ŒSpringçš„å„ç§<code>MessageSource</code>å®ç°éµå¾ªä¸æ ‡å‡†JDK <code>ResourceBundle</code>ç›¸åŒçš„åŒºåŸŸè®¾ç½®è§£æå’Œå›é€€è§„åˆ™ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œç»§ç»­å‰é¢å®šä¹‰çš„<code>messageSource</code>ç¤ºä¾‹ï¼Œå¦‚æœè¦æ ¹æ®è‹±å¼ï¼ˆen-GBï¼‰è¯­è¨€ç¯å¢ƒè§£ææ¶ˆæ¯ï¼Œåˆ™éœ€è¦åˆ†åˆ«åˆ›å»ºåä¸º<code>format_en_GB.properties</code>ï¼Œ<code>exceptions_en_GB.properties</code>å’Œ<code>windows_en_GB.properties</code>çš„æ–‡ä»¶ã€‚</p><p>é€šå¸¸ï¼Œlocale è®¾ç½®è§£æç”±åº”ç”¨ç¨‹åºçš„å‘¨å›´ç¯å¢ƒç®¡ç†ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œï¼ˆè‹±å›½ï¼‰æ¶ˆæ¯å°†è¢«è§£æçš„åœ°åŒºæ˜¯æ‰‹åŠ¨æŒ‡å®šçš„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code># in exceptions_en_GB<span class="token punctuation">.</span>properties
argument<span class="token punctuation">.</span>required<span class="token operator">=</span><span class="token class-name">Ebagum</span> lad<span class="token punctuation">,</span> the <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span> argument is required<span class="token punctuation">,</span> <span class="token class-name">I</span> say<span class="token punctuation">,</span> required<span class="token punctuation">.</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">MessageSource</span> resources <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;beans.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> message <span class="token operator">=</span> resources<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token string">&quot;argument.required&quot;</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">Object</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token string">&quot;userDao&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;Required&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token constant">UK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ä¸Šè¿°ç¨‹åºè¿è¡Œå¾—åˆ°çš„è¾“å‡ºå°†æ˜¯â€¦</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>Ebagum lad, the &#39;userDao&#39; argument is required, I say, required.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨<code>MessageSourceAware</code>æ¥å£è·å–å¯¹å·²å®šä¹‰çš„ä»»ä½•<code>MessageSource</code>çš„å¼•ç”¨ã€‚åœ¨åˆ›å»ºå’Œé…ç½®beanæ—¶ï¼Œåœ¨å®ç°<code>MessageSourceAware</code>æ¥å£çš„<code>ApplicationContext</code>ä¸­å®šä¹‰çš„ä»»ä½•beanéƒ½ä¼šæ³¨å…¥åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„<code>MessageSource</code>ã€‚</p><blockquote><p>ä½œä¸ºResourceBundleMessageSourceçš„æ›¿ä»£æ–¹æ³•ï¼ŒSpringæä¾›äº†ä¸€ä¸ªReloadableResourceBundleMessageSourceç±»ã€‚è¯¥å˜ä½“æ”¯æŒç›¸åŒçš„åŒ…æ–‡ä»¶æ ¼å¼ï¼Œä½†æ¯”æ ‡å‡†çš„åŸºäºJDKçš„ResourceBundleMessageSourceå®ç°æ›´çµæ´»ã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒå…è®¸ä»ä»»ä½•Springèµ„æºä½ç½®ï¼ˆè€Œä¸ä»…ä»…æ˜¯ä»ç±»è·¯å¾„ï¼‰è¯»å–æ–‡ä»¶ï¼Œå¹¶æ”¯æŒçƒ­é‡è½½bundleå±æ€§æ–‡ä»¶ï¼ˆåŒæ—¶æœ‰æ•ˆåœ°ç¼“å­˜å®ƒä»¬ï¼‰ã€‚ æŸ¥çœ‹ReloadableResourceBundleMessageSource javadocè·å–è¯¦ç»†ä¿¡æ¯ã€‚</p></blockquote><h3 id="æ ‡å‡†å’Œè‡ªå®šä¹‰äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#æ ‡å‡†å’Œè‡ªå®šä¹‰äº‹ä»¶"><span>æ ‡å‡†å’Œè‡ªå®šä¹‰äº‹ä»¶</span></a></h3><p><code>ApplicationContext</code>ä¸­çš„äº‹ä»¶å¤„ç†é€šè¿‡<code>ApplicationEvent</code>ç±»å’Œ<code>ApplicationListener</code>æ¥å£æä¾›ã€‚å¦‚æœå°†å®ç°<code>ApplicationListener</code>æ¥å£çš„beanéƒ¨ç½²åˆ°ä¸Šä¸‹æ–‡ä¸­ï¼Œåˆ™æ¯æ¬¡å°†<code>ApplicationEvent</code>å‘å¸ƒåˆ°<code>ApplicationContext</code>æ—¶ï¼Œéƒ½ä¼šé€šçŸ¥è¯¥Beanã€‚ å®è´¨ä¸Šï¼Œè¿™æ˜¯æ ‡å‡†<code>Observer</code>è®¾è®¡æ¨¡å¼ã€‚</p><p>Springæä¾›äº†ä»¥ä¸‹æ ‡å‡†äº‹ä»¶ï¼š</p><table><thead><tr><th style="text-align:left;">Event</th><th>æè¿°</th></tr></thead><tbody><tr><td style="text-align:left;">ContextRefreshedEvent</td><td>åœ¨åˆå§‹åŒ–æˆ–åˆ·æ–°ApplicationContextæ—¶è§¦å‘ï¼Œä¾‹å¦‚ï¼Œåœ¨ConfigurableApplicationContextæ¥å£ä¸Šä½¿ç”¨refreshï¼ˆï¼‰æ–¹æ³•ã€‚è¿™é‡Œçš„â€œåˆå§‹åŒ–â€æ„å‘³ç€æ‰€æœ‰çš„Beanéƒ½è¢«åŠ è½½ï¼Œæ£€æµ‹å¹¶æ¿€æ´»åå¤„ç†å™¨Beanï¼Œå•ä¾‹è¢«é¢„å…ˆå®ä¾‹åŒ–ï¼Œå¹¶ä¸”ApplicationContextå¯¹è±¡å·²å‡†å¤‡å¥½ä½¿ç”¨ã€‚åªè¦ä¸Šä¸‹æ–‡æ²¡æœ‰å…³é—­ï¼Œåªè¦æ‰€é€‰çš„ApplicationContextå®é™…ä¸Šæ”¯æŒè¿™ç§â€œçƒ­â€åˆ·æ–°ï¼Œå°±å¯ä»¥å¤šæ¬¡è§¦å‘åˆ·æ–°ã€‚ä¾‹å¦‚ï¼ŒXmlWebApplicationContextæ”¯æŒçƒ­åˆ·æ–°ï¼Œä½†GenericApplicationContextä¸æ”¯æŒã€‚</td></tr><tr><td style="text-align:left;">ContextStartedEvent</td><td>åœ¨ApplicationContextå¯åŠ¨æ—¶è§¦å‘ï¼Œä¾‹å¦‚ï¼Œåœ¨ConfigurableApplicationContextæ¥å£ä¸Šä½¿ç”¨startï¼ˆï¼‰æ–¹æ³•ã€‚â€œstartedâ€æ„å‘³ç€æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸbeanéƒ½ä¼šæ”¶åˆ°æ˜ç¡®çš„å¯åŠ¨ä¿¡å·ï¼Œé€šå¸¸è¿™ä¸ªä¿¡å·ç”¨äºåœ¨æ˜¾å¼åœæ­¢åé‡æ–°å¯åŠ¨beanï¼Œä½†ä¹Ÿå¯èƒ½ç”¨äºå¯åŠ¨å°šæœªé…ç½®ä¸ºè‡ªåŠ¨å¯åŠ¨çš„ç»„ä»¶ï¼Œä¾‹å¦‚ï¼Œ å°šæœªå¼€å§‹åˆå§‹åŒ–ã€‚</td></tr><tr><td style="text-align:left;">ContextStoppedEvent</td><td>åœ¨ApplicationContextåœæ­¢æ—¶å‘å¸ƒï¼Œåœ¨ConfigurableApplicationContextæ¥å£ä¸Šä½¿ç”¨stopï¼ˆï¼‰æ–¹æ³•ã€‚è¿™é‡Œâ€œåœæ­¢â€æ„å‘³ç€æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸbeanéƒ½ä¼šæ”¶åˆ°æ˜ç¡®çš„åœæ­¢ä¿¡å·ã€‚ åœæ­¢çš„ä¸Šä¸‹æ–‡å¯ä»¥é€šè¿‡startï¼ˆï¼‰è°ƒç”¨é‡æ–°å¯åŠ¨ã€‚</td></tr><tr><td style="text-align:left;">ContextClosedEvent</td><td>åœ¨ApplicationContextå…³é—­æ—¶å‘å¸ƒï¼Œåœ¨ConfigurableApplicationContextæ¥å£ä¸Šä½¿ç”¨closeï¼ˆï¼‰æ–¹æ³•ã€‚è¿™é‡Œçš„â€œclosedâ€æ„å‘³ç€æ‰€æœ‰çš„å•ä¾‹beanè¢«é”€æ¯ã€‚ å°é—­çš„ç¯å¢ƒè¾¾åˆ°å…¶ç”Ÿå‘½çš„å°½å¤´; å®ƒä¸èƒ½è¢«åˆ·æ–°æˆ–é‡æ–°å¯åŠ¨ã€‚</td></tr><tr><td style="text-align:left;">RequestHandledEvent</td><td>ä¸€ä¸ªç‰¹å®šäºwebçš„äº‹ä»¶ï¼Œå‘ŠçŸ¥æ‰€æœ‰bean------HTTPè¯·æ±‚å·²è¢«æœåŠ¡ã€‚æ­¤äº‹ä»¶åœ¨è¯·æ±‚å®Œæˆåå‘å¸ƒã€‚è¯¥äº‹ä»¶ä»…é€‚ç”¨äºä½¿ç”¨Springçš„DispatcherServletçš„Webåº”ç”¨ç¨‹åºã€‚</td></tr></tbody></table><p>æ‚¨è¿˜å¯ä»¥åˆ›å»ºå’Œå‘å¸ƒè‡ªå·±çš„è‡ªå®šä¹‰äº‹ä»¶ã€‚ è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†ä¸€ä¸ªæ‰©å±•Springçš„ApplicationEventåŸºç±»çš„ç®€å•ç±»ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlackListEvent</span> <span class="token keyword">extends</span> <span class="token class-name">ApplicationEvent</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> address<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> test<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">BlackListEvent</span><span class="token punctuation">(</span><span class="token class-name">Object</span> source<span class="token punctuation">,</span> <span class="token class-name">String</span> address<span class="token punctuation">,</span> <span class="token class-name">String</span> test<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> address<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>test <span class="token operator">=</span> test<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// accessor and other methods...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦å‘å¸ƒè‡ªå®šä¹‰<code>ApplicationEvent</code>ï¼Œè¯·åœ¨<code>ApplicationEventPublisher</code>ä¸Šè°ƒç”¨<code>publishEvent</code>æ–¹æ³•ã€‚é€šå¸¸è¿™æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå®ç°<code>ApplicationEventPublisherAware</code>å¹¶å°†å…¶æ³¨å†Œä¸ºSpring beançš„ç±»æ¥å®Œæˆçš„ã€‚ ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†è¿™æ ·ä¸€ä¸ªç±»ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmailService</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationEventPublisherAware</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> blackList<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">ApplicationEventPublisher</span> publisher<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBlackList</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> blackList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>blackList <span class="token operator">=</span> blackList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setApplicationEventPublisher</span><span class="token punctuation">(</span><span class="token class-name">ApplicationEventPublisher</span> publisher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>publisher <span class="token operator">=</span> publisher<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendEmail</span><span class="token punctuation">(</span><span class="token class-name">String</span> address<span class="token punctuation">,</span> <span class="token class-name">String</span> text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>blackList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">BlackListEvent</span> event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BlackListEvent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> address<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
            publisher<span class="token punctuation">.</span><span class="token function">publishEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// send email...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨é…ç½®æ—¶ï¼Œ<code>Spring</code>å®¹å™¨å°†æ£€æµ‹åˆ°è¯¥<code>EmailService</code>å®ç°äº†<code>ApplicationEventPublisherAware</code>ï¼Œå¹¶å°†è‡ªåŠ¨è°ƒç”¨<code>setApplicationEventPublisher</code>ã€‚ å®é™…ä¸Šï¼Œä¼ å…¥çš„å‚æ•°å°†æ˜¯Springå®¹å™¨æœ¬èº«; æ‚¨åªéœ€é€šè¿‡å…¶<code>ApplicationEventPublisher</code>æ¥å£ä¸åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡è¿›è¡Œäº¤äº’ã€‚</p><p>è¦æ¥æ”¶è‡ªå®šä¹‰<code>ApplicationEvent</code>ï¼Œè¯·åˆ›å»ºä¸€ä¸ªå®ç°<code>ApplicationListener</code>çš„ç±»å¹¶å°†å…¶æ³¨å†Œä¸ºSpring beanã€‚ ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†è¿™æ ·ä¸€ä¸ªç±»ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlackListNotifier</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BlackListEvent</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> notificationAddress<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNotificationAddress</span><span class="token punctuation">(</span><span class="token class-name">String</span> notificationAddress<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>notificationAddress <span class="token operator">=</span> notificationAddress<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onApplicationEvent</span><span class="token punctuation">(</span><span class="token class-name">BlackListEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// notify appropriate parties via notificationAddress...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œ<code>ApplicationListener</code>é€šå¸¸ä½¿ç”¨æ‚¨çš„è‡ªå®šä¹‰äº‹ä»¶<code>BlackListEvent</code>çš„ç±»å‹è¿›è¡Œå‚æ•°åŒ–ã€‚è¿™æ„å‘³ç€<code>onApplicationEvent</code>æ–¹æ³•å¯ä»¥ä¿æŒç±»å‹å®‰å…¨ï¼Œé¿å…ä»»ä½•å‘ä¸‹è½¬æ¢ã€‚æ‚¨å¯ä»¥æ ¹æ®éœ€è¦æ³¨å†Œè®¸å¤šäº‹ä»¶ä¾¦å¬å™¨ï¼Œä½†è¯·æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹äº‹ä»¶ä¾¦å¬å™¨ä¼šåŒæ­¥æ¥æ”¶äº‹ä»¶ã€‚è¿™æ„å‘³ç€<code>publishEvent</code>æ–¹æ³•ä¼šé˜»å¡ï¼Œç›´åˆ°æ‰€æœ‰ä¾¦å¬å™¨å®Œæˆå¤„ç†äº‹ä»¶ã€‚è¿™ç§åŒæ­¥å’Œå•çº¿ç¨‹æ–¹æ³•çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œå½“ä¾¦å¬å™¨æ¥æ”¶åˆ°äº‹ä»¶æ—¶ï¼Œå¦‚æœäº‹åŠ¡ä¸Šä¸‹æ–‡å¯ç”¨ï¼Œå®ƒå°†åœ¨å‘å¸ƒè€…çš„äº‹åŠ¡ä¸Šä¸‹æ–‡å†…éƒ¨è¿è¡Œã€‚å¦‚æœéœ€è¦å¦ä¸€ä¸ªäº‹ä»¶å‘å¸ƒç­–ç•¥ï¼Œè¯·å‚è€ƒSpringçš„<code>ApplicationEventMulticaster</code>æ¥å£çš„javadocã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†ç”¨äºæ³¨å†Œå’Œé…ç½®ä¸Šè¿°æ¯ä¸ªç±»çš„beanå®šä¹‰ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>emailService<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>example.EmailService<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blackList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>known.spammer@example.org<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>known.hacker@example.org<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>john.doe@example.org<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blackListNotifier<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>example.BlackListNotifier<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>notificationAddress<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blacklist@example.org<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç»¼åˆèµ·æ¥ï¼Œå½“è°ƒç”¨<code>emailService </code>beançš„<code>sendEmail</code>æ–¹æ³•æ—¶ï¼Œå¦‚æœæœ‰ä»»ä½•åº”è¢«åˆ—å…¥é»‘åå•çš„ç”µå­é‚®ä»¶ï¼Œåˆ™ä¼šå‘å¸ƒ<code>BlackListEvent</code>ç±»å‹çš„è‡ªå®šä¹‰äº‹ä»¶ã€‚ <code>blackListNotifier </code>beanè¢«æ³¨å†Œä¸ºä¸€ä¸ª<code>ApplicationListener</code>ï¼Œå¹¶å› æ­¤æ¥æ”¶åˆ°<code>BlackListEvent</code>ï¼Œæ­¤æ—¶å®ƒå¯ä»¥é€šçŸ¥ç›¸å…³æ–¹ã€‚</p><blockquote><p>Springçš„äº‹ä»¶æœºåˆ¶è¢«è®¾è®¡ä¸ºåœ¨åŒä¸€ä¸ªåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­çš„Spring beanä¹‹é—´è¿›è¡Œç®€å•çš„é€šä¿¡ã€‚ ç„¶è€Œï¼Œå¯¹äºæ›´å¤æ‚çš„ä¼ä¸šé›†æˆéœ€æ±‚ï¼Œå•ç‹¬ç»´æŠ¤çš„Spring Integrationé¡¹ç›®ä¸ºæ„å»ºè½»é‡çº§ï¼Œé¢å‘æ¨¡å¼çš„äº‹ä»¶é©±åŠ¨æ¶æ„æä¾›å®Œå…¨æ”¯æŒï¼Œè¯¥æ¶æ„åŸºäºç€åçš„Springç¼–ç¨‹æ¨¡å‹ã€‚</p></blockquote><h4 id="åŸºäºæ³¨é‡Šçš„äº‹ä»¶ç›‘å¬å™¨" tabindex="-1"><a class="header-anchor" href="#åŸºäºæ³¨é‡Šçš„äº‹ä»¶ç›‘å¬å™¨"><span>åŸºäºæ³¨é‡Šçš„äº‹ä»¶ç›‘å¬å™¨</span></a></h4><p>ä»Spring 4.2å¼€å§‹ï¼Œäº‹ä»¶ç›‘å¬å™¨å¯ä»¥é€šè¿‡<code>EventListener</code>æ³¨è§£åœ¨æ‰˜ç®¡beançš„ä»»ä½•å…¬å…±æ–¹æ³•ä¸Šæ³¨å†Œã€‚ <code>BlackListNotifier</code>å¯ä»¥è¢«é‡å†™å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlackListNotifier</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> notificationAddress<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNotificationAddress</span><span class="token punctuation">(</span><span class="token class-name">String</span> notificationAddress<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>notificationAddress <span class="token operator">=</span> notificationAddress<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@EventListener</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">processBlackListEvent</span><span class="token punctuation">(</span><span class="token class-name">BlackListEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// notify appropriate parties via notificationAddress...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­£å¦‚æ‚¨åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼Œæ–¹æ³•ç­¾åå†æ¬¡å£°æ˜å®ƒç›‘å¬çš„äº‹ä»¶ç±»å‹ï¼Œä½†æ˜¯è¿™æ¬¡ä½¿ç”¨çµæ´»çš„åç§°å¹¶ä¸”æ²¡æœ‰å®ç°ç‰¹å®šçš„ç›‘å¬å™¨æ¥å£ã€‚äº‹ä»¶ç±»å‹ä¹Ÿå¯ä»¥é€šè¿‡æ³›å‹è¿›è¡Œç¼©å°,åªè¦å®é™…äº‹ä»¶ç±»å‹åœ¨å…¶å®ç°å±‚æ¬¡ç»“æ„ä¸­è§£ææ³›å‹å‚æ•°.</p><p>å¦‚æœä½ çš„æ–¹æ³•åº”è¯¥ç›‘å¬å‡ ä¸ªäº‹ä»¶ï¼Œæˆ–è€…æ–¹æ³•ä¸Šæ ¹æœ¬æ²¡æœ‰å‚æ•°ï¼Œäº‹ä»¶ç±»å‹ä¹Ÿå¯ä»¥åœ¨æ³¨é‡Šæœ¬èº«ä¸ŠæŒ‡å®šï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@EventListener</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ContextStartedEvent</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">ContextRefreshedEvent</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleContextStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹Ÿå¯ä»¥é€šè¿‡æ³¨é‡Šçš„<code>condition</code>å±æ€§æ·»åŠ é¢å¤–çš„è¿è¡Œæ—¶è¿‡æ»¤ï¼Œè¯¥å±æ€§å®šä¹‰äº†ä¸€ä¸ªSpELè¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼åº”åŒ¹é…ä»¥å®é™…è°ƒç”¨ç‰¹å®šäº‹ä»¶çš„æ–¹æ³•ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœäº‹ä»¶çš„æµ‹è¯•å±æ€§ç­‰äºfooï¼Œæˆ‘ä»¬çš„é€šçŸ¥å™¨å¯ä»¥è¢«é‡å†™ä¸ºä»…è¢«è°ƒç”¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@EventListener</span><span class="token punctuation">(</span>condition <span class="token operator">=</span> <span class="token string">&quot;#blEvent.test == &#39;foo&#39;&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">processBlackListEvent</span><span class="token punctuation">(</span><span class="token class-name">BlackListEvent</span> blEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// notify appropriate parties via notificationAddress...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯ä¸ªSpELè¡¨è¾¾å¼å†æ¬¡è¯„ä¼°ä¸€ä¸ªä¸“ç”¨ä¸Šä¸‹æ–‡ã€‚ ä¸‹è¡¨åˆ—å‡ºäº†å¯ç”¨äºä¸Šä¸‹æ–‡çš„é¡¹ç›®ï¼Œä»¥ä¾¿å¯ä»¥å°†å®ƒä»¬ç”¨äºæ¡ä»¶äº‹ä»¶å¤„ç†ï¼š</p><table><thead><tr><th>Name</th><th>Location</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td>Event</td><td>root object</td><td>å®é™…çš„ApplicationEvent</td><td><code>#root.event</code></td></tr><tr><td>Arguments array</td><td>root object</td><td>ç”¨äºè°ƒç”¨ç›®æ ‡çš„å‚æ•°ï¼ˆå¦‚æ•°ç»„ï¼‰</td><td><code>#root.args[0]</code></td></tr><tr><td>Argument name</td><td>evaluation context</td><td>ä»»ä½•æ–¹æ³•å‚æ•°çš„åç§°ã€‚ å¦‚æœç”±äºæŸäº›åŸå› åç§°ä¸å¯ç”¨ï¼ˆä¾‹å¦‚ï¼Œæ²¡æœ‰è°ƒè¯•ä¿¡æ¯ï¼‰ï¼Œåˆ™å‚æ•°åç§°ä¹Ÿå¯åœ¨<code>#a &lt;#arg&gt;</code>ä¸‹ä½¿ç”¨ï¼Œå…¶ä¸­<code>#arg</code>ä»£è¡¨å‚æ•°ç´¢å¼•ï¼ˆä»0å¼€å§‹ï¼‰</td><td><code>#blEvent</code> or <code>#a0</code> (one can also use<code> #p0</code> or <code>#p&lt;#arg&gt;</code> notation as an alias).</td></tr></tbody></table><p>è¯·æ³¨æ„ï¼Œ<code>ï¼ƒroot.event</code>å…è®¸æ‚¨è®¿é—®åŸºç¡€äº‹ä»¶ï¼Œå³ä½¿æ‚¨çš„æ–¹æ³•ç­¾åå®é™…ä¸Šå¼•ç”¨äº†å·²å‘å¸ƒçš„ä»»æ„å¯¹è±¡ã€‚</p><p>å¦‚æœæ‚¨éœ€è¦å‘å¸ƒä¸€ä¸ªäº‹ä»¶ä½œä¸ºå¤„ç†å¦ä¸€ä¸ªäº‹ä»¶çš„ç»“æœï¼Œåªéœ€æ›´æ”¹æ–¹æ³•ç­¾åä»¥è¿”å›åº”è¯¥å‘å¸ƒçš„äº‹ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@EventListener</span>
<span class="token keyword">public</span> <span class="token class-name">ListUpdateEvent</span> <span class="token function">handleBlackListEvent</span><span class="token punctuation">(</span><span class="token class-name">BlackListEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// notify appropriate parties via notificationAddress and</span>
    <span class="token comment">// then publish a ListUpdateEvent...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªæ–°æ–¹æ³•å°†ä¸ºæ¯ä¸ªç”±ä¸Šè¿°æ–¹æ³•å¤„ç†çš„<code>BlackListEvent</code>å‘å¸ƒä¸€ä¸ªæ–°çš„<code>ListUpdateEvent</code>ã€‚ å¦‚æœæ‚¨éœ€è¦å‘å¸ƒå¤šä¸ªäº‹ä»¶ï¼Œåˆ™åªéœ€è¿”å›ä¸€ç»„äº‹ä»¶ã€‚</p><h4 id="å¼‚æ­¥ç›‘å¬å™¨" tabindex="-1"><a class="header-anchor" href="#å¼‚æ­¥ç›‘å¬å™¨"><span>å¼‚æ­¥ç›‘å¬å™¨</span></a></h4><p>å¦‚æœæ‚¨å¸Œæœ›ç‰¹å®šçš„ä¾¦å¬å™¨å¼‚æ­¥å¤„ç†äº‹ä»¶ï¼Œåªéœ€é‡ç”¨å¸¸è§„çš„<code>@Async</code>æ”¯æŒå³å¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@EventListener</span>
<span class="token annotation punctuation">@Async</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">processBlackListEvent</span><span class="token punctuation">(</span><span class="token class-name">BlackListEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// BlackListEvent is processed in a separate thread</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨å¼‚æ­¥äº‹ä»¶æ—¶è¯·æ³¨æ„ä»¥ä¸‹é™åˆ¶ï¼š</p><ul><li>å¦‚æœäº‹ä»¶ä¾¦å¬å™¨æŠ›å‡ºå¼‚å¸¸ï¼Œå®ƒå°†ä¸ä¼šä¼ æ’­ç»™è°ƒç”¨è€…ï¼Œè¯·æ£€æŸ¥<code>AsyncUncaughtExceptionHandler</code>ä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</li><li>è¿™ç§äº‹ä»¶ç›‘å¬å™¨ä¸èƒ½å‘é€å›å¤ã€‚ å¦‚æœæ‚¨éœ€è¦å‘é€å¦ä¸€ä¸ªäº‹ä»¶ä½œä¸ºå¤„ç†ç»“æœï¼Œè¯·æ³¨å…¥<code>ApplicationEventPublisher</code>ä»¥æ‰‹åŠ¨å‘é€äº‹ä»¶ã€‚</li></ul><h4 id="ç›‘å¬å™¨çš„é¡ºåº" tabindex="-1"><a class="header-anchor" href="#ç›‘å¬å™¨çš„é¡ºåº"><span>ç›‘å¬å™¨çš„é¡ºåº</span></a></h4><p>å¦‚æœéœ€è¦åœ¨å¦ä¸€ä¸ªä¾¦å¬å™¨ä¹‹å‰è°ƒç”¨ä¾¦å¬å™¨ï¼Œåªéœ€å°†<code>@Order</code>æ³¨é‡Šæ·»åŠ åˆ°æ–¹æ³•å£°æ˜ä¸­å³å¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@EventListener</span>
<span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">processBlackListEvent</span><span class="token punctuation">(</span><span class="token class-name">BlackListEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// notify appropriate parties via notificationAddress...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ³›å‹äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#æ³›å‹äº‹ä»¶"><span>æ³›å‹äº‹ä»¶</span></a></h4><p>æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨æ³›å‹æ¥è¿›ä¸€æ­¥å®šä¹‰äº‹ä»¶çš„ç»“æ„ã€‚ è€ƒè™‘ä¸€ä¸ª<code>EntityCreatedEvent &lt;T&gt;</code>ï¼Œå…¶ä¸­<code>T</code>æ˜¯åˆ›å»ºçš„å®é™…å®ä½“çš„ç±»å‹ã€‚ æ‚¨å¯ä»¥åˆ›å»ºä»¥ä¸‹ä¾¦å¬å™¨å®šä¹‰ä»¥ä»…æ¥æ”¶<code>Person</code>çš„<code>EntityCreatedEvent</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@EventListener</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onPersonCreated</span><span class="token punctuation">(</span><span class="token class-name">EntityCreatedEvent</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±äºç±»å‹æ“¦é™¤ï¼Œåªæœ‰å½“è¢«è§¦å‘çš„äº‹ä»¶è§£å†³äº†äº‹ä»¶ä¾¦å¬å™¨è¿‡æ»¤çš„æ³›å‹å‚æ•°æ—¶ï¼ˆè¿™ä¸ç±»<code>PersonCreatedEvent </code>extends <code>EntityCreatedEvent &lt;Person&gt;</code> {â€¦}ï¼‰ç±»ä¼¼ï¼Œæ‰ä¼šèµ·ä½œç”¨ã€‚</p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœæ‰€æœ‰äº‹ä»¶éƒ½éµå¾ªç›¸åŒçš„ç»“æ„ï¼ˆè¿™åº”è¯¥æ˜¯ä¸Šè¿°äº‹ä»¶çš„æƒ…å†µï¼‰ï¼Œåˆ™è¿™å¯èƒ½å˜å¾—éå¸¸ä¹å‘³ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥å®ç°<code>ResolvableTypeProvider</code>ä»¥å¼•å¯¼æ¡†æ¶è¶…å‡ºè¿è¡Œæ—¶ç¯å¢ƒæ‰€æä¾›çš„èŒƒå›´ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EntityCreatedEvent</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span>
        <span class="token keyword">extends</span> <span class="token class-name">ApplicationEvent</span> <span class="token keyword">implements</span> <span class="token class-name">ResolvableTypeProvider</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">EntityCreatedEvent</span><span class="token punctuation">(</span><span class="token class-name">T</span> entity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ResolvableType</span> <span class="token function">getResolvableType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">ResolvableType</span><span class="token punctuation">.</span><span class="token function">forClassWithGenerics</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">ResolvableType</span><span class="token punctuation">.</span><span class="token function">forInstance</span><span class="token punctuation">(</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ–¹ä¾¿åœ°è®¿é—®ä½çº§èµ„æº" tabindex="-1"><a class="header-anchor" href="#æ–¹ä¾¿åœ°è®¿é—®ä½çº§èµ„æº"><span>æ–¹ä¾¿åœ°è®¿é—®ä½çº§èµ„æº</span></a></h3><p>ä¸ºäº†æœ€ä½³ä½¿ç”¨å’Œç†è§£åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ï¼Œç”¨æˆ·é€šå¸¸åº”è¯¥ç†Ÿæ‚‰Springçš„èµ„æºæŠ½è±¡ã€‚</p><p>åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ª<code>ResourceLoader</code>ï¼Œå¯ç”¨äºåŠ è½½èµ„æºã€‚èµ„æºæœ¬è´¨ä¸Šæ˜¯JDKç±»<code>java.net.URL</code>çš„åŠŸèƒ½æ›´ä¸°å¯Œçš„ç‰ˆæœ¬ï¼Œå®é™…ä¸Šï¼Œ<code>Resource</code>çš„å®ç°åœ¨é€‚å½“çš„æƒ…å†µä¸‹åŒ…è£…äº†<code>java.net.URL</code>çš„å®ä¾‹ã€‚<code>Resource </code>å¯ä»¥é€æ˜æ–¹å¼ä»å‡ ä¹ä»»ä½•ä½ç½®è·å–ä½çº§èµ„æºï¼ŒåŒ…æ‹¬ä»ç±»è·¯å¾„ï¼Œæ–‡ä»¶ç³»ç»Ÿä½ç½®ï¼Œä»»ä½•å¯ç”¨æ ‡å‡†URLæè¿°çš„ä½ç½®ä»¥åŠå…¶ä»–å˜ä½“ã€‚ å¦‚æœèµ„æºä½ç½®å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ²¡æœ‰ä»»ä½•ç‰¹æ®Šå‰ç¼€çš„ç®€å•è·¯å¾„ï¼Œé‚£ä¹ˆè¿™äº›èµ„æºæ¥è‡ªç‰¹å®šä¸”é€‚åˆå®é™…åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ç±»å‹.</p><p>æ‚¨å¯ä»¥é…ç½®ä¸€ä¸ªéƒ¨ç½²åˆ°åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­çš„beanæ¥å®ç°ç‰¹æ®Šçš„å›è°ƒæ¥å£<code>ResourceLoaderAware</code>ï¼Œè¯¥æ¥å£å°†åœ¨åˆå§‹åŒ–æ—¶è‡ªåŠ¨å›è°ƒï¼ŒåŒæ—¶åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡æœ¬èº«ä½œä¸º<code>ResourceLoader</code>ä¼ å…¥ã€‚æ‚¨è¿˜å¯ä»¥å…¬å¼€ç”¨äºè®¿é—®é™æ€èµ„æºçš„<code>Resource</code>ç±»å‹çš„å±æ€§;å®ƒä»¬å°†åƒå…¶ä»–ä»»ä½•å±æ€§ä¸€æ ·è¢«æ³¨å…¥åˆ°å®ƒä¸­ã€‚æ‚¨å¯ä»¥å°†è¿™äº›èµ„æºå±æ€§æŒ‡å®šä¸ºç®€å•çš„Stringè·¯å¾„ï¼Œå¹¶ä¾èµ–ç”±ä¸Šä¸‹æ–‡è‡ªåŠ¨æ³¨å†Œçš„ç‰¹æ®ŠJavaBean <code>PropertyEditor</code>ï¼Œä»¥ä¾¿åœ¨éƒ¨ç½²Beanæ—¶å°†è¿™äº›æ–‡æœ¬å­—ç¬¦ä¸²è½¬æ¢ä¸ºå®é™…çš„<code>Resource</code>å¯¹è±¡ã€‚</p><p>æä¾›ç»™<code>ApplicationContext</code>æ„é€ å‡½æ•°çš„ä½ç½®è·¯å¾„æˆ–è·¯å¾„å®é™…ä¸Šæ˜¯èµ„æºå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ä»¥ç®€å•å½¢å¼é€‚å½“åœ°å¤„ç†ç‰¹å®šçš„ä¸Šä¸‹æ–‡å®ç°ã€‚<code>ClassPathXmlApplicationContext</code>å°†ç®€å•çš„ä½ç½®è·¯å¾„è§†ä¸ºç±»è·¯å¾„ä½ç½®ã€‚ æ‚¨è¿˜å¯ä»¥ä½¿ç”¨å¸¦æœ‰ç‰¹æ®Šå‰ç¼€çš„ä½ç½®è·¯å¾„ï¼ˆèµ„æºå­—ç¬¦ä¸²ï¼‰æ¥å¼ºåˆ¶ä»ç±»è·¯å¾„æˆ–URLä¸­åŠ è½½å®šä¹‰ï¼Œè€Œä¸ç®¡å®é™…çš„ä¸Šä¸‹æ–‡ç±»å‹å¦‚ä½•ã€‚</p><h3 id="æ–¹ä¾¿çš„webåº”ç”¨ç¨‹åºapplicationcontextå®ä¾‹åŒ–" tabindex="-1"><a class="header-anchor" href="#æ–¹ä¾¿çš„webåº”ç”¨ç¨‹åºapplicationcontextå®ä¾‹åŒ–"><span>æ–¹ä¾¿çš„Webåº”ç”¨ç¨‹åºApplicationContextå®ä¾‹åŒ–</span></a></h3><p>æ‚¨å¯ä»¥ä½¿ç”¨ä¾‹å¦‚<code>ContextLoader</code>ä»¥å£°æ˜æ–¹å¼åˆ›å»º<code>ApplicationContext</code>å®ä¾‹ã€‚å½“ç„¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨<code>ApplicationContext</code>å®ç°ä¹‹ä¸€ä»¥ç¼–ç¨‹æ–¹å¼åˆ›å»º<code>ApplicationContext</code>å®ä¾‹ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨<code>ContextLoaderListener</code>æ³¨å†Œä¸€ä¸ª<code>ApplicationContext</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context-param</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>contextConfigLocation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>/WEB-INF/daoContext.xml /WEB-INF/applicationContext.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context-param</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener-class</span><span class="token punctuation">&gt;</span></span>org.springframework.web.context.ContextLoaderListener<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç›‘å¬å™¨æ£€æŸ¥<code>contextConfigLocation</code>å‚æ•°ã€‚ å¦‚æœè¯¥å‚æ•°ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆä¾¦å¬å™¨å°†é»˜è®¤ä½¿ç”¨<code>/WEB-INF/applicationContext.xml</code>.å½“å‚æ•°ç¡®å®å­˜åœ¨æ—¶ï¼Œä¾¦å¬å™¨ä½¿ç”¨é¢„å®šä¹‰çš„åˆ†éš”ç¬¦ï¼ˆé€—å·ï¼Œåˆ†å·å’Œç©ºç™½ï¼‰æ¥åˆ†éš”å­—ç¬¦ä¸²ï¼Œå¹¶å°†è¿™äº›å€¼ç”¨ä½œåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡å°†è¢«æœç´¢çš„ä½ç½®ã€‚ ä¹Ÿæ”¯æŒAnté£æ ¼çš„è·¯å¾„æ¨¡å¼ã€‚ç¤ºä¾‹æ˜¯<code>/WEB-INF/**Context.xml</code>ï¼Œç”¨äºåç§°ä»¥â€œContext.xmlâ€ç»“å°¾ï¼Œé©»ç•™åœ¨â€œWEB-INFâ€ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä»¥åŠ<code>/WEB-INF/***/*Context.xml </code>è¿™äº›æ–‡ä»¶ä½äºâ€œWEB-INFâ€çš„ä»»ä½•å­ç›®å½•ä¸­ã€‚</p><h3 id="å°†spring-applicationcontextéƒ¨ç½²ä¸ºjava-ee-raræ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#å°†spring-applicationcontextéƒ¨ç½²ä¸ºjava-ee-raræ–‡ä»¶"><span>å°†Spring ApplicationContextéƒ¨ç½²ä¸ºJava EE RARæ–‡ä»¶</span></a></h3><p>å¯ä»¥å°†Spring <code>ApplicationContext</code>éƒ¨ç½²ä¸ºRARæ–‡ä»¶ï¼Œå°†ä¸Šä¸‹æ–‡åŠå…¶æ‰€æœ‰å¿…éœ€çš„beanç±»å’Œåº“JARå°è£…åˆ°Java EE RARéƒ¨ç½²å•å…ƒä¸­ã€‚è¿™ç›¸å½“äºå¼•å¯¼äº†ä¸€ä¸ªç‹¬ç«‹çš„<code>ApplicationContext</code>ï¼Œå®ƒåªæ˜¯åœ¨Java EEç¯å¢ƒä¸­æ‰˜ç®¡ï¼Œèƒ½å¤Ÿè®¿é—®Java EEæœåŠ¡å™¨è®¾æ–½ã€‚RARéƒ¨ç½²æ˜¯éƒ¨ç½²æ— å¤´WARæ–‡ä»¶çš„åœºæ™¯ä¸­æ›´è‡ªç„¶çš„é€‰æ‹©ï¼Œå®é™…ä¸Šï¼ŒWARæ–‡ä»¶æ²¡æœ‰ä»»ä½•HTTPå…¥å£ç‚¹ï¼Œä»…ç”¨äºåœ¨Java EEç¯å¢ƒä¸­å¼•å¯¼Spring <code>ApplicationContext</code>ã€‚</p><p>RARéƒ¨ç½²éå¸¸é€‚åˆä¸éœ€è¦HTTPå…¥å£ç‚¹ä½†ä»…åŒ…å«æ¶ˆæ¯ç«¯ç‚¹å’Œé¢„å®šä½œä¸šçš„åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡.åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒBeanå¯ä»¥ä½¿ç”¨åº”ç”¨æœåŠ¡å™¨èµ„æºï¼Œä¾‹å¦‚JTAäº‹åŠ¡ç®¡ç†å™¨å’ŒJNDIç»‘å®šçš„JDBC DataSourceså’ŒJMS ConnectionFactoryå®ä¾‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡Springçš„æ ‡å‡†äº‹åŠ¡ç®¡ç†å’ŒJNDIå’ŒJMXæ”¯æŒå·¥å…·å‘å¹³å°çš„JMXæœåŠ¡å™¨æ³¨å†Œã€‚ åº”ç”¨ç¨‹åºç»„ä»¶è¿˜å¯ä»¥é€šè¿‡Springçš„TaskExecutoræŠ½è±¡ä¸åº”ç”¨ç¨‹åºæœåŠ¡å™¨çš„JCA <code>WorkManager</code>è¿›è¡Œäº¤äº’ã€‚</p><p>æŸ¥çœ‹<code>SpringContextResourceAdapter</code>ç±»çš„javadocï¼Œäº†è§£RARéƒ¨ç½²ä¸­æ¶‰åŠçš„é…ç½®è¯¦ç»†ä¿¡æ¯ã€‚</p><p>è¦å°†Spring <code>ApplicationContext</code>ç®€å•éƒ¨ç½²ä¸ºJava EE RARæ–‡ä»¶ï¼šå°†æ‰€æœ‰åº”ç”¨ç¨‹åºç±»æ‰“åŒ…åˆ°RARæ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶æ˜¯å…·æœ‰ä¸åŒæ–‡ä»¶æ‰©å±•åçš„æ ‡å‡†JARæ–‡ä»¶ã€‚å°†æ‰€æœ‰å¿…éœ€çš„åº“JARæ·»åŠ åˆ°RARå½’æ¡£çš„æ ¹ç›®å½•ä¸­ã€‚ æ·»åŠ ä¸€ä¸ªâ€œMETA-INF /ra.xmlâ€éƒ¨ç½²æè¿°ç¬¦ï¼ˆå¦‚SpringContextResourceAdapters javadocæ‰€ç¤ºï¼‰å’Œç›¸åº”çš„Spring XML beanå®šä¹‰æ–‡ä»¶ï¼ˆé€šå¸¸ä¸ºâ€œMETA-INF/applicationContext.xmlâ€ï¼‰ï¼Œå¹¶æ”¾å¼ƒç”Ÿæˆçš„RARæ–‡ä»¶ åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºæœåŠ¡å™¨çš„éƒ¨ç½²ç›®å½•ã€‚</p><blockquote><p>è¿™ç§RARéƒ¨ç½²å•å…ƒé€šå¸¸æ˜¯ç‹¬ç«‹çš„;å®ƒä»¬ä¸ä¼šå°†ç»„ä»¶æš´éœ²ç»™å¤–éƒ¨ä¸–ç•Œï¼Œç”šè‡³ä¸ä¼šæš´éœ²ç»™åŒä¸€åº”ç”¨ç¨‹åºçš„å…¶ä»–æ¨¡å—ã€‚ä¸åŸºäºRARçš„ApplicationContextçš„äº¤äº’é€šå¸¸é€šè¿‡ä¸å…¶ä»–æ¨¡å—å…±äº«çš„JMSç›®æ ‡è¿›è¡Œã€‚ ä¾‹å¦‚ï¼ŒåŸºäºRARçš„ApplicationContextä¹Ÿå¯ä»¥è°ƒåº¦ä¸€äº›ä½œä¸šï¼Œå¯¹æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–°æ–‡ä»¶ï¼ˆæˆ–è¯¸å¦‚æ­¤ç±»ï¼‰ä½œå‡ºååº”ã€‚ å¦‚æœéœ€è¦å…è®¸ä»å¤–éƒ¨è¿›è¡ŒåŒæ­¥è®¿é—®ï¼Œåˆ™å¯ä»¥å¯¼å‡ºRMIç«¯ç‚¹ï¼Œè¿™å½“ç„¶å¯ä»¥ç”±åŒä¸€å°æœºå™¨ä¸Šçš„å…¶ä»–åº”ç”¨ç¨‹åºæ¨¡å—ä½¿ç”¨ã€‚</p></blockquote><h2 id="beanfactory" tabindex="-1"><a class="header-anchor" href="#beanfactory"><span>BeanFactory</span></a></h2><p>BeanFactoryä¸ºSpringçš„IoCåŠŸèƒ½æä¾›äº†åŸºç¡€ï¼Œä½†å®ƒä»…ç›´æ¥ç”¨äºä¸å…¶ä»–ç¬¬ä¸‰æ–¹æ¡†æ¶çš„é›†æˆï¼Œç°åœ¨å¯¹äºSpringçš„å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´æœ¬è´¨ä¸Šæ˜¯å†å²æ€§çš„ã€‚</p><p>BeanFactoryå’Œç›¸å…³æ¥å£ï¼ˆå¦‚BeanFactoryAwareï¼ŒInitializingBeanï¼ŒDisposableBeanï¼‰åœ¨Springä¸­ä»ç„¶å­˜åœ¨ï¼Œç›®çš„æ˜¯ä¸ºäº†ä¸å¤§é‡ä¸Springé›†æˆçš„ç¬¬ä¸‰æ–¹æ¡†æ¶å‘åå…¼å®¹ã€‚ é€šå¸¸ç¬¬ä¸‰æ–¹ç»„ä»¶ä¸èƒ½ä½¿ç”¨æ›´å¤šçš„ç°ä»£å¯¹ç­‰é¡¹ç›®ï¼Œä¾‹å¦‚@PostConstructæˆ–@PreDestroyï¼Œä»¥é¿å…ä¾èµ–JSR-250ã€‚</p><p>æœ¬èŠ‚æä¾›äº†BeanFactoryå’ŒApplicationContextä¹‹é—´å·®å¼‚çš„é¢å¤–èƒŒæ™¯ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡ç»å…¸çš„å•ä¾‹æŸ¥æ‰¾ç›´æ¥è®¿é—®IoCå®¹å™¨ã€‚</p><h3 id="beanfactory-or-applicationcontext" tabindex="-1"><a class="header-anchor" href="#beanfactory-or-applicationcontext"><span>BeanFactory or ApplicationContext?</span></a></h3><p>é™¤éä½ æœ‰å……åˆ†ç†ç”±ä¸è¿™æ ·åšï¼Œå¦åˆ™ä½¿ç”¨ApplicationContextã€‚</p><p>å› ä¸ºApplicationContextåŒ…å«äº†BeanFactoryçš„æ‰€æœ‰åŠŸèƒ½ï¼Œæ‰€ä»¥é€šå¸¸æ¨èä½¿ç”¨BeanFactoryï¼Œé™¤äº†å°‘æ•°æƒ…å†µï¼Œä¾‹å¦‚åœ¨èµ„æºå—é™çš„è®¾å¤‡ä¸Šè¿è¡Œçš„åµŒå…¥å¼åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™äº›è®¾å¤‡çš„å†…å­˜æ¶ˆè€—å¯èƒ½éå¸¸é‡è¦ï¼Œå°‘æ•°å¤šä½™çš„åƒå­—èŠ‚å¯èƒ½ä¼šäº§ç”Ÿå½±å“.ä½†æ˜¯ï¼Œå¯¹äºå¤§å¤šæ•°å…¸å‹çš„ä¼ä¸šåº”ç”¨ç¨‹åºå’Œç³»ç»Ÿï¼ŒApplicationContextå°±æ˜¯æ‚¨æƒ³è¦ä½¿ç”¨çš„ã€‚ Springå¤§é‡ä½¿ç”¨BeanPostProcessoræ‰©å±•ç‚¹ï¼ˆä»¥å®ç°ä»£ç†ç­‰ï¼‰ã€‚å¦‚æœæ‚¨åªä½¿ç”¨ç®€å•çš„BeanFactoryï¼Œåˆ™ç›¸å½“æ•°é‡çš„æ”¯æŒï¼ˆå¦‚äº‹åŠ¡å’ŒAOPï¼‰ä¸ä¼šç”Ÿæ•ˆï¼Œè‡³å°‘åœ¨æ‚¨æ²¡æœ‰æ‰§è¡ŒæŸäº›é¢å¤–æ­¥éª¤çš„æƒ…å†µä¸‹ä¸ä¼šç”Ÿæ•ˆã€‚ è¿™ç§æƒ…å†µå¯èƒ½ä¼šä»¤äººå›°æƒ‘ï¼Œå› ä¸ºé…ç½®æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚</p><p>ä¸‹è¡¨åˆ—å‡ºäº†BeanFactoryå’ŒApplicationContextæ¥å£å’Œå®ç°æä¾›çš„åŠŸèƒ½ã€‚</p><table><thead><tr><th>Feature</th><th>BeanFactory</th><th>ApplicationContext</th><th></th></tr></thead><tbody><tr><td>Beanå®ä¾‹åŒ–/æ³¨å…¥</td><td>Y</td><td>Y</td><td></td></tr><tr><td>è‡ªåŠ¨æ³¨å†ŒBeanPostProcessor</td><td>N</td><td>Y</td><td></td></tr><tr><td>è‡ªåŠ¨æ³¨å†ŒBeanFactoryPostProcessor</td><td>N</td><td>Y</td><td></td></tr><tr><td>ä¾¿æ·çš„MessageSourceè®¿é—®ï¼ˆé’ˆå¯¹i18nï¼‰</td><td>N</td><td>Y</td><td></td></tr><tr><td>ApplicationEvent å‘å¸ƒ</td><td>N</td><td></td><td></td></tr></tbody></table><p>è¦ä½¿ç”¨BeanFactoryå®ç°æ˜¾å¼æ³¨å†ŒBeanåå¤„ç†å™¨ï¼Œæ‚¨éœ€è¦ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">DefaultListableBeanFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultListableBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// populate the factory with bean definitions</span>

<span class="token comment">// now register any needed BeanPostProcessor instances</span>
<span class="token class-name">MyBeanPostProcessor</span> postProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyBeanPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
factory<span class="token punctuation">.</span><span class="token function">addBeanPostProcessor</span><span class="token punctuation">(</span>postProcessor<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// now start using the factory</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦åœ¨ä½¿ç”¨BeanFactoryå®ç°æ—¶æ˜¾å¼æ³¨å†ŒBeanFactoryPostProcessorï¼Œæ‚¨å¿…é¡»ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">DefaultListableBeanFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultListableBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">XmlBeanDefinitionReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlBeanDefinitionReader</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
reader<span class="token punctuation">.</span><span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token string">&quot;beans.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// bring in some property values from a Properties file</span>
<span class="token class-name">PropertyPlaceholderConfigurer</span> cfg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyPlaceholderConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cfg<span class="token punctuation">.</span><span class="token function">setLocation</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc.properties&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// now actually do the replacement</span>
cfg<span class="token punctuation">.</span><span class="token function">postProcessBeanFactory</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œæ˜¾å¼æ³¨å†Œæ­¥éª¤éƒ½å¾ˆä¸æ–¹ä¾¿ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå„ç§ApplicationContextå®ç°æ¯”ç»å¤§å¤šæ•°Springæ”¯æŒçš„åº”ç”¨ç¨‹åºä¸­çš„çº¯BeanFactoryå®ç°æ›´å—æ¬¢è¿çš„åŸå› ä¹‹ä¸€ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨BeanFactoryPostProcessorå’ŒBeanPostProcessoræ—¶ã€‚ è¿™äº›æœºåˆ¶å®ç°äº†é‡è¦çš„åŠŸèƒ½ï¼Œå¦‚èµ„æºå ä½ç¬¦æ›¿æ¢å’ŒAOPã€‚</p></div><!--[--><!----><!--]--><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a href="https://github.com/banrenshan/banrenshan.github.io/edit/main/src/Spring/spring-å®¹å™¨é«˜çº§.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link vp-meta-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: CP_zhaozhiqiang@163.com">banrenshan</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link nav-link prev" href="/Spring/spring-%E5%AE%B9%E5%99%A8%E5%9F%BA%E7%A1%80.html" aria-label="Spring å®¹å™¨åŸºç¡€"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Spring å®¹å™¨åŸºç¡€</div></a><a class="route-link nav-link next" href="/Spring/spring-%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2.html" aria-label="Spring ç±»å‹è½¬æ¢"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Spring ç±»å‹è½¬æ¢<!----></div></a></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><!----></div><!--]--><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-Brzzz3sI.js" defer></script>
  </body>
</html>
